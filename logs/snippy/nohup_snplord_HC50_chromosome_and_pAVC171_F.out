Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 40
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	2	fasttree
	2	gubbins
	2	snippy_clean
	2	snippy_core
	94	snippy_run
	2	snp_dists
	2	snp_sites
	107

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out
    jobid: 45
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_HA6420AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out
    jobid: 17
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_SA8312AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out
    jobid: 55
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_HB8007AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out
    jobid: 85
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_HA6332AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out
    jobid: 11
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_BA8511AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out
    jobid: 35
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4064AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out
    jobid: 83
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_SA8273AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta

[Thu Sep 10 10:24:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out
    jobid: 13
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_VA0598AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:05] This is snippy 4.4.3
[10:24:05] Written by Torsten Seemann
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] This is snippy 4.4.3
[10:24:05] Detected operating system: linux
[10:24:05] Enabling bundled linux tools.
[10:24:05] Written by Torsten Seemann
[10:24:05] This is snippy 4.4.3
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] Detected operating system: linux
[10:24:05] Written by Torsten Seemann
[10:24:05] Enabling bundled linux tools.
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] Detected operating system: linux
[10:24:05] Enabling bundled linux tools.
[10:24:05] This is snippy 4.4.3
[10:24:05] Written by Torsten Seemann
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] Detected operating system: linux
[10:24:05] This is snippy 4.4.3
[10:24:05] Enabling bundled linux tools.
[10:24:05] Written by Torsten Seemann
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] Detected operating system: linux
[10:24:05] Enabling bundled linux tools.
[10:24:05] This is snippy 4.4.3
[10:24:05] This is snippy 4.4.3
[10:24:05] This is snippy 4.4.3
[10:24:05] Written by Torsten Seemann
[10:24:05] Written by Torsten Seemann
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] Written by Torsten Seemann
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] Detected operating system: linux
[10:24:05] Obtained from https://github.com/tseemann/snippy
[10:24:05] Detected operating system: linux
[10:24:05] Enabling bundled linux tools.
[10:24:05] Detected operating system: linux
[10:24:05] Enabling bundled linux tools.
[10:24:05] Enabling bundled linux tools.
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found gzip - /usr/bin/gzip
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Treating reference as 'fasta' format.
[10:24:05] Will use 8 CPU cores.
[10:24:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta
[10:24:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out
[10:24:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out
[10:24:05] Creating reference folder: reference
[10:24:05] Extracting FASTA and GFF from reference.
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta into pseudo-reads
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta into pseudo-reads
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta into pseudo-reads
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta into pseudo-reads
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta into pseudo-reads
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta into pseudo-reads
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta into pseudo-reads
[10:24:05] Wrote 1 sequences to ref.fa
[10:24:05] Wrote 0 features to ref.gff
[10:24:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta into pseudo-reads
[10:24:09] Wrote 437900 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:09] Wrote 435872 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:09] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:09] Using BAM RG (Read Group) ID: ESC_VA0598AA_AS.out
[10:24:09] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:09] Using BAM RG (Read Group) ID: ESC_SA8273AA_AS.out
[10:24:09] Wrote 440276 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:09] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:09] Using BAM RG (Read Group) ID: ESC_SA8312AA_AS.out
[10:24:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:10] Wrote 440510 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:10] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:10] Using BAM RG (Read Group) ID: ESC_HB8007AA_AS.out
[10:24:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:10] Wrote 440980 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:10] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:10] Using BAM RG (Read Group) ID: ESC_HA6420AA_AS.out
[10:24:10] Wrote 447112 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:10] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:10] Using BAM RG (Read Group) ID: ESC_BA8511AA_AS.out
[10:24:10] Wrote 453578 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:10] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:10] Using BAM RG (Read Group) ID: ESC_NA4064AA_AS.out
[10:24:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:10] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:10] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:10] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:10] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:10] Wrote 443754 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:10] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:10] Using BAM RG (Read Group) ID: ESC_HA6332AA_AS.out
[10:24:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:10] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8273AA_AS.out\tSM:ESC_SA8273AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_VA0598AA_AS.out\tSM:ESC_VA0598AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 320052 sequences (80000174 bp)...
[M::process] read 115820 sequences (28955000 bp)...
[M::process] read 320014 sequences (80000098 bp)...
[10:24:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HB8007AA_AS.out\tSM:ESC_HB8007AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:24:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:24:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_BA8511AA_AS.out\tSM:ESC_BA8511AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320018 sequences (80000164 bp)...
[10:24:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::process] read 320062 sequences (80000166 bp)...
[10:24:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:14] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8312AA_AS.out\tSM:ESC_SA8312AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:14] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6332AA_AS.out\tSM:ESC_HA6332AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:24:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 320326 sequences (80000378 bp)...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:15] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4064AA_AS.out\tSM:ESC_NA4064AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:24:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:24:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:15] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6420AA_AS.out\tSM:ESC_HA6420AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 117886 sequences (29471500 bp)...
[M::process] read 320068 sequences (80000032 bp)...
[M::process] read 320112 sequences (80000494 bp)...
[M::process] read 320142 sequences (80000350 bp)...
[M::process] read 123686 sequences (30918376 bp)...
[M::process] read 120868 sequences (30194564 bp)...
[M::mem_process_seqs] Processed 320052 reads in 20.787 CPU sec, 5.305 real sec
[M::mem_process_seqs] Processed 115820 reads in 7.944 CPU sec, 1.470 real sec
[M::process] read 120492 sequences (30123000 bp)...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::process] read 127050 sequences (31755156 bp)...
[M::process] read 119950 sequences (29987500 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8273AA_AS.out\tSM:ESC_SA8273AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 436464, removed 2681, allowed 230, passed 433783

[main] Real time: 8.658 sec; CPU: 29.409 sec
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 133436 sequences (33317366 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320014 reads in 27.640 CPU sec, 10.413 real sec
[M::mem_process_seqs] Processed 320068 reads in 26.453 CPU sec, 8.788 real sec
[10:24:24] Running: samtools index snps.bam 2>> snps.log
[10:24:25] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:24:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 117886 reads in 7.374 CPU sec, 1.366 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 123686 reads in 8.953 CPU sec, 1.371 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320326 reads in 25.899 CPU sec, 10.737 real sec
[M::mem_process_seqs] Processed 320112 reads in 26.218 CPU sec, 10.371 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320018 reads in 24.588 CPU sec, 12.188 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_VA0598AA_AS.out\tSM:ESC_VA0598AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.260 sec; CPU: 35.882 sec
[samclip] Total SAM records 439116, removed 5468, allowed 585, passed 433648
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 119950 reads in 7.920 CPU sec, 1.834 real sec
[M::mem_process_seqs] Processed 120868 reads in 8.159 CPU sec, 1.701 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6332AA_AS.out\tSM:ESC_HA6332AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.746 sec; CPU: 36.229 sec
[samclip] Total SAM records 445038, removed 6088, allowed 807, passed 438950
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320062 reads in 25.573 CPU sec, 13.749 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 120492 reads in 9.821 CPU sec, 1.862 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[10:24:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 118
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:24:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[10:24:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[10:24:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 200000 records...
[10:24:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:24:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:24:29] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:29] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:29] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:29] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8312AA_AS.out\tSM:ESC_SA8312AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.780 sec; CPU: 34.810 sec
[samclip] Total SAM records 441687, removed 6748, allowed 676, passed 434939
[samclip] Header contained 3 lines
[samclip] Done.
[10:24:29] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 400000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 127050 reads in 10.429 CPU sec, 1.348 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6420AA_AS.out\tSM:ESC_HA6420AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.480 sec; CPU: 35.241 sec
[samclip] Total SAM records 442027, removed 5105, allowed 629, passed 436922
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320142 reads in 25.453 CPU sec, 14.194 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HB8007AA_AS.out\tSM:ESC_HB8007AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 15.987 sec; CPU: 35.344 sec
[samclip] Total SAM records 442081, removed 6511, allowed 674, passed 435570
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[10:24:30] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_BA8511AA_AS.out\tSM:ESC_BA8511AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 16.700 sec; CPU: 36.788 sec
[samclip] Total SAM records 448153, removed 4641, allowed 617, passed 443512
[samclip] Header contained 3 lines
[samclip] Done.
[10:24:30] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:30] Running: samtools index snps.bam 2>> snps.log
[10:24:31] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 133436 reads in 11.893 CPU sec, 1.528 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:32] Running: samtools index snps.bam 2>> snps.log
[10:24:32] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:24:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:24:32] Running: samtools index snps.bam 2>> snps.log
[10:24:32] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:24:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:24:32] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[10:24:33] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:24:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4064AA_AS.out\tSM:ESC_NA4064AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 18.893 sec; CPU: 38.166 sec
[samclip] Total SAM records 455436, removed 7443, allowed 799, passed 447993
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:34] Running: samtools index snps.bam 2>> snps.log
[10:24:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:24:35] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:24:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:24:35] Marked 182 heterozygous sites with 'n'

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 31
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 42

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 42
       total no. variants observed              : 3220
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:24:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:24:35] Creating extra output files: BED GFF CSV TXT HTML
[10:24:35] Identified 118 variants.
[10:24:35] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out
[10:24:35] Result files:
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.aligned.fa
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.bam
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.bam.bai
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.bed
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.consensus.fa
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.consensus.subs.fa
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.csv
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.filt.vcf
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.gff
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.html
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.log
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.raw.vcf
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.subs.vcf
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.tab
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.txt
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.vcf
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.vcf.gz
[10:24:35] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out/snps.vcf.gz.csi
[10:24:35] Walltime used: 30 seconds
[10:24:35] Questionable SNP? Try the --report option to see the alignments.
[10:24:35] Done.
[Thu Sep 10 10:24:35 2020]
Finished job 83.
1 of 107 steps (0.93%) done

[Thu Sep 10 10:24:35 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out
    jobid: 81
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_GB6943AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta
[10:24:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 8
          no. right trimmed                     : 23
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 35

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 35
       total no. variants observed              : 3285
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:24:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:24:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:24:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:24:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:24:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 8
          no. right trimmed                     : 28
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 40

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 40
       total no. variants observed              : 3321
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:24:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:24:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:37] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:38] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:24:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:24:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:24:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:24:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:38] This is snippy 4.4.3
[10:24:38] Written by Torsten Seemann
[10:24:38] Obtained from https://github.com/tseemann/snippy
[10:24:38] Detected operating system: linux
[10:24:38] Enabling bundled linux tools.
[10:24:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 26
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3187
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:24:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:24:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:38] Found gzip - /usr/bin/gzip
[10:24:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:38] Running: samtools index snps.bam 2>> snps.log
[10:24:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:38] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:38] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:24:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:24:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:24:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:24:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:38] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:38] Treating reference as 'fasta' format.
[10:24:38] Will use 8 CPU cores.
[10:24:38] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta
[10:24:38] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out
[10:24:38] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out
[10:24:38] Creating reference folder: reference
[10:24:38] Extracting FASTA and GFF from reference.
[10:24:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:24:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 31
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 40

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 40
       total no. variants observed              : 3444
       total no. reference observed             : 0

Time elapsed: 0.06s

[10:24:38] Wrote 1 sequences to ref.fa
[10:24:38] Wrote 0 features to ref.gff
[10:24:38] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta into pseudo-reads
[10:24:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:24:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:39] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:24:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:24:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:24:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:24:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 31
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 42

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 42
       total no. variants observed              : 3269
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:24:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:24:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:39] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:24:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:24:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:24:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:40] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:24:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 9
          no. right trimmed                     : 35
          no. left and right trimmed            : 7
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 51

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 51
       total no. variants observed              : 3048
       total no. reference observed             : 0

Time elapsed: 0.04s

[10:24:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:24:42] Wrote 433864 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:42] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:42] Using BAM RG (Read Group) ID: ESC_GB6943AA_AS.out
[10:24:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:42] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:42] Marked 305 heterozygous sites with 'n'
[10:24:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:24:42] Creating extra output files: BED GFF CSV TXT HTML
[10:24:42] Identified 3220 variants.
[10:24:42] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out
[10:24:42] Result files:
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.aligned.fa
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.bam
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.bam.bai
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.bed
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.consensus.fa
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.consensus.subs.fa
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.csv
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.filt.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.gff
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.html
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.log
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.raw.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.subs.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.tab
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.txt
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.vcf.gz
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out/snps.vcf.gz.csi
[10:24:42] Walltime used: 37 seconds
[10:24:42] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:24:42] Done.
[10:24:42] Marked 683 heterozygous sites with 'n'
[Thu Sep 10 10:24:42 2020]
Finished job 13.
2 of 107 steps (2%) done

[Thu Sep 10 10:24:42 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out
    jobid: 57
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4052AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta
[10:24:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:24:42] Creating extra output files: BED GFF CSV TXT HTML
[10:24:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:42] Identified 3285 variants.
[10:24:42] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out
[10:24:42] Result files:
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.aligned.fa
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.bam
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.bam.bai
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.bed
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.consensus.fa
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.consensus.subs.fa
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.csv
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.filt.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.gff
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.html
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.log
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.raw.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.subs.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.tab
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.txt
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.vcf
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.vcf.gz
[10:24:42] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out/snps.vcf.gz.csi
[10:24:42] Walltime used: 37 seconds
[10:24:42] Wishing you a life free of homopolymer errors.
[10:24:42] Done.
[Thu Sep 10 10:24:42 2020]
Finished job 85.
3 of 107 steps (3%) done

[Thu Sep 10 10:24:42 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out
    jobid: 51
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_HA6342AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta
[10:24:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:42] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:24:43] Marked 661 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:43] Creating extra output files: BED GFF CSV TXT HTML
[10:24:43] Identified 3321 variants.
[10:24:43] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out
[10:24:43] Result files:
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.aligned.fa
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.bam
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.bam.bai
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.bed
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.consensus.fa
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.consensus.subs.fa
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.csv
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.filt.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.gff
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.html
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.log
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.raw.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.subs.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.tab
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.txt
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.vcf.gz
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out/snps.vcf.gz.csi
[10:24:43] Walltime used: 38 seconds
[10:24:43] May the SNPs be with you.
[10:24:43] Done.
[Thu Sep 10 10:24:43 2020]
Finished job 17.
4 of 107 steps (4%) done

[Thu Sep 10 10:24:43 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out
    jobid: 5
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_HA6418AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:43] This is snippy 4.4.3
[10:24:43] Written by Torsten Seemann
[10:24:43] Obtained from https://github.com/tseemann/snippy
[10:24:43] Detected operating system: linux
[10:24:43] Enabling bundled linux tools.
[10:24:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:43] Found gzip - /usr/bin/gzip
[10:24:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:43] This is snippy 4.4.3
[10:24:43] Written by Torsten Seemann
[10:24:43] Obtained from https://github.com/tseemann/snippy
[10:24:43] Detected operating system: linux
[10:24:43] Enabling bundled linux tools.
[10:24:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:43] Found gzip - /usr/bin/gzip
[10:24:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:43] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:43] Treating reference as 'fasta' format.
[10:24:43] Will use 8 CPU cores.
[10:24:43] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta
[10:24:43] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out
[10:24:43] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out
[10:24:43] Creating reference folder: reference
[10:24:43] Extracting FASTA and GFF from reference.
[10:24:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:43] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:43] Treating reference as 'fasta' format.
[10:24:43] Will use 8 CPU cores.
[10:24:43] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta
[10:24:43] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out
[10:24:43] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out
[10:24:43] Creating reference folder: reference
[10:24:43] Extracting FASTA and GFF from reference.
[10:24:43] Marked 259 heterozygous sites with 'n'
[10:24:43] Wrote 1 sequences to ref.fa
[10:24:43] Wrote 0 features to ref.gff
[10:24:43] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta into pseudo-reads
[10:24:43] Creating extra output files: BED GFF CSV TXT HTML
[10:24:43] Identified 3187 variants.
[10:24:43] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out
[10:24:43] Result files:
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.aligned.fa
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.bam
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.bam.bai
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.bed
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.consensus.fa
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.consensus.subs.fa
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.csv
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.filt.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.gff
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.html
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.log
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.raw.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.subs.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.tab
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.txt
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.vcf
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.vcf.gz
[10:24:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out/snps.vcf.gz.csi
[10:24:43] Walltime used: 38 seconds
[10:24:43] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:24:43] Done.
[Thu Sep 10 10:24:44 2020]
Finished job 45.
5 of 107 steps (5%) done

[Thu Sep 10 10:24:44 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out
    jobid: 19
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_SA8291AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta
[10:24:44] Wrote 1 sequences to ref.fa
[10:24:44] Wrote 0 features to ref.gff
[10:24:44] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta into pseudo-reads
[10:24:44] This is snippy 4.4.3
[10:24:44] Written by Torsten Seemann
[10:24:44] Obtained from https://github.com/tseemann/snippy
[10:24:44] Detected operating system: linux
[10:24:44] Enabling bundled linux tools.
[10:24:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:44] Found gzip - /usr/bin/gzip
[10:24:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:44] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:44] Marked 316 heterozygous sites with 'n'
[10:24:44] Treating reference as 'fasta' format.
[10:24:44] Will use 8 CPU cores.
[10:24:44] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta
[10:24:44] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out
[10:24:44] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out
[10:24:44] Creating reference folder: reference
[10:24:44] Extracting FASTA and GFF from reference.
[10:24:44] Creating extra output files: BED GFF CSV TXT HTML
[10:24:44] Identified 3444 variants.
[10:24:44] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out
[10:24:44] Result files:
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.aligned.fa
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.bam
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.bam.bai
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.bed
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.consensus.fa
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.consensus.subs.fa
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.csv
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.filt.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.gff
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.html
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.log
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.raw.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.subs.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.tab
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.txt
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.vcf.gz
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out/snps.vcf.gz.csi
[10:24:44] Walltime used: 39 seconds
[10:24:44] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:24:44] Done.
[Thu Sep 10 10:24:44 2020]
Finished job 55.
6 of 107 steps (6%) done

[Thu Sep 10 10:24:44 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out
    jobid: 63
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_SA8296AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:44] Wrote 1 sequences to ref.fa
[10:24:44] Wrote 0 features to ref.gff
[10:24:44] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta into pseudo-reads
[10:24:44] This is snippy 4.4.3
[10:24:44] Written by Torsten Seemann
[10:24:44] Obtained from https://github.com/tseemann/snippy
[10:24:44] Detected operating system: linux
[10:24:44] Enabling bundled linux tools.
[10:24:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:44] Found gzip - /usr/bin/gzip
[10:24:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:44] Marked 203 heterozygous sites with 'n'
[10:24:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:44] Running: bwa mem  -Y -M -R '@RG\tID:ESC_GB6943AA_AS.out\tSM:ESC_GB6943AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:44] Creating extra output files: BED GFF CSV TXT HTML
[10:24:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:44] Identified 3269 variants.
[10:24:44] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out
[10:24:44] Result files:
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.aligned.fa
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.bam
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.bam.bai
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.bed
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.consensus.fa
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.consensus.subs.fa
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.csv
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.filt.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.gff
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.html
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.log
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.raw.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.subs.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.tab
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.txt
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.vcf
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.vcf.gz
[10:24:44] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out/snps.vcf.gz.csi
[10:24:44] Walltime used: 39 seconds
[10:24:44] May the SNPs be with you.
[10:24:44] Done.
[Thu Sep 10 10:24:44 2020]
Finished job 11.
7 of 107 steps (7%) done

[Thu Sep 10 10:24:44 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out
    jobid: 7
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_SA8250AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:45] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:45] Treating reference as 'fasta' format.
[10:24:45] Will use 8 CPU cores.
[10:24:45] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta
[10:24:45] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out
[10:24:45] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out
[10:24:45] Creating reference folder: reference
[10:24:45] Extracting FASTA and GFF from reference.
[10:24:45] This is snippy 4.4.3
[10:24:45] Written by Torsten Seemann
[10:24:45] Obtained from https://github.com/tseemann/snippy
[10:24:45] Detected operating system: linux
[10:24:45] Enabling bundled linux tools.
[10:24:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:45] Wrote 1 sequences to ref.fa
[10:24:45] Wrote 0 features to ref.gff
[10:24:45] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta into pseudo-reads
[10:24:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:45] Found gzip - /usr/bin/gzip
[10:24:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320070 sequences (80000140 bp)...
[10:24:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 113794 sequences (28448500 bp)...
[10:24:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:45] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:45] Treating reference as 'fasta' format.
[10:24:45] Will use 8 CPU cores.
[10:24:45] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta
[10:24:45] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out
[10:24:45] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out
[10:24:45] Creating reference folder: reference
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:24:45] Extracting FASTA and GFF from reference.
[10:24:45] Wrote 1 sequences to ref.fa
[10:24:45] Wrote 0 features to ref.gff
[10:24:45] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta into pseudo-reads
[10:24:45] This is snippy 4.4.3
[10:24:45] Written by Torsten Seemann
[10:24:45] Obtained from https://github.com/tseemann/snippy
[10:24:45] Detected operating system: linux
[10:24:45] Enabling bundled linux tools.
[10:24:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:24:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:45] Found gzip - /usr/bin/gzip
[10:24:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:45] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:45] Treating reference as 'fasta' format.
[10:24:45] Will use 8 CPU cores.
[10:24:45] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta
[10:24:45] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out
[10:24:45] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out
[10:24:45] Creating reference folder: reference
[10:24:45] Extracting FASTA and GFF from reference.
[10:24:46] Wrote 1 sequences to ref.fa
[10:24:46] Wrote 0 features to ref.gff
[10:24:46] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta into pseudo-reads
[10:24:47] Wrote 445684 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:47] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:47] Using BAM RG (Read Group) ID: ESC_NA4052AA_AS.out
[10:24:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:47] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:47] Marked 105 heterozygous sites with 'n'
[10:24:47] Wrote 439862 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:47] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:47] Using BAM RG (Read Group) ID: ESC_HA6342AA_AS.out
[10:24:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:47] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:47] Creating extra output files: BED GFF CSV TXT HTML
[10:24:47] Identified 3048 variants.
[10:24:47] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out
[10:24:47] Result files:
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.aligned.fa
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.bam
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.bam.bai
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.bed
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.consensus.fa
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.consensus.subs.fa
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.csv
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.filt.vcf
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.gff
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.html
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.log
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.raw.vcf
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.subs.vcf
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.tab
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.txt
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.vcf
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.vcf.gz
[10:24:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out/snps.vcf.gz.csi
[10:24:47] Walltime used: 42 seconds
[10:24:47] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:24:47] Done.
[Thu Sep 10 10:24:47 2020]
Finished job 35.
8 of 107 steps (7%) done

[Thu Sep 10 10:24:47 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out
    jobid: 77
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4053AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta
[10:24:47] Wrote 437538 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:47] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:47] Using BAM RG (Read Group) ID: ESC_HA6418AA_AS.out
[10:24:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:47] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320070 reads in 23.326 CPU sec, 2.977 real sec
[10:24:48] Wrote 433918 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:48] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:48] Using BAM RG (Read Group) ID: ESC_SA8291AA_AS.out
[10:24:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:48] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[10:24:48] Wrote 433954 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:48] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:48] Using BAM RG (Read Group) ID: ESC_SA8296AA_AS.out
[10:24:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:48] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:49] This is snippy 4.4.3
[10:24:49] Written by Torsten Seemann
[10:24:49] Obtained from https://github.com/tseemann/snippy
[10:24:49] Detected operating system: linux
[10:24:49] Enabling bundled linux tools.
[10:24:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:24:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:24:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:24:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:24:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:24:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:24:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:24:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:24:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[samclip] Processed 300000 records...
[10:24:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:24:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:24:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:24:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:24:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:24:49] Found gzip - /usr/bin/gzip
[10:24:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:24:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:24:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:24:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:24:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:24:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:24:49] Wrote 430510 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:24:49] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:49] Using BAM RG (Read Group) ID: ESC_SA8250AA_AS.out
[10:24:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 113794 reads in 9.776 CPU sec, 1.169 real sec
[10:24:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:24:49] Running: bwa index reference/ref.fa 2>> snps.log
[10:24:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:24:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:24:49] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:24:49] Treating reference as 'fasta' format.
[10:24:49] Will use 8 CPU cores.
[10:24:49] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta
[10:24:49] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out
[10:24:49] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out
[10:24:49] Creating reference folder: reference
[10:24:49] Extracting FASTA and GFF from reference.
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_GB6943AA_AS.out\tSM:ESC_GB6943AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.906 sec; CPU: 33.637 sec
[samclip] Total SAM records 435290, removed 5880, allowed 616, passed 429410
[samclip] Header contained 3 lines
[samclip] Done.
[10:24:49] Wrote 1 sequences to ref.fa
[10:24:49] Wrote 0 features to ref.gff
[10:24:49] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:24:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:50] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4052AA_AS.out\tSM:ESC_NA4052AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:24:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:50] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6342AA_AS.out\tSM:ESC_HA6342AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320082 sequences (80000390 bp)...
[M::process] read 320802 sequences (80000490 bp)...
[M::process] read 119780 sequences (29941832 bp)...
[10:24:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:51] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6418AA_AS.out\tSM:ESC_HA6418AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 320194 sequences (80000246 bp)...
[10:24:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:52] Running: samtools index snps.bam 2>> snps.log
[10:24:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:52] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8291AA_AS.out\tSM:ESC_SA8291AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:52] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[M::process] read 124882 sequences (31175666 bp)...
[10:24:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:24:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:52] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8296AA_AS.out\tSM:ESC_SA8296AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 320158 sequences (80000120 bp)...
[10:24:52] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8250AA_AS.out\tSM:ESC_SA8250AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[10:24:53] Wrote 440556 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[M::process] read 320184 sequences (80000208 bp)...
[10:24:53] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:24:53] Using BAM RG (Read Group) ID: ESC_NA4053AA_AS.out
[10:24:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:24:53] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 117344 sequences (29332360 bp)...
[10:24:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 25
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 35

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 35
       total no. variants observed              : 3242
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:24:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:24:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:24:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:24:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:24:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:24:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:24:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:24:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:24:57] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4053AA_AS.out\tSM:ESC_NA4053AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 113770 sequences (28442500 bp)...
[10:24:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:24:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:24:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:24:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:24:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:24:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:24:57] Running: rm -f fake_reads\.fq 2>> snps.log
[10:24:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320066 sequences (80000282 bp)...
[M::process] read 110510 sequences (27627500 bp)...
[M::mem_process_seqs] Processed 320082 reads in 24.147 CPU sec, 7.184 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 119780 reads in 10.387 CPU sec, 1.369 real sec
[samclip] Processed 200000 records...
[M::process] read 113760 sequences (28440000 bp)...
[samclip] Processed 300000 records...
[M::process] read 120490 sequences (30114358 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6342AA_AS.out\tSM:ESC_HA6342AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.628 sec; CPU: 35.253 sec
[samclip] Total SAM records 440678, removed 4596, allowed 694, passed 436082
[samclip] Header contained 3 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320802 reads in 26.311 CPU sec, 10.220 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320194 reads in 22.984 CPU sec, 9.447 real sec
[M::mem_process_seqs] Processed 124882 reads in 9.683 CPU sec, 1.301 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 117344 reads in 9.142 CPU sec, 1.490 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[10:25:03] Marked 226 heterozygous sites with 'n'
[10:25:03] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 320184 reads in 23.371 CPU sec, 10.154 real sec
[10:25:03] Identified 3242 variants.
[10:25:03] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out
[10:25:03] Result files:
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.aligned.fa
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.bam
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.bam.bai
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.bed
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.consensus.fa
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.consensus.subs.fa
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.csv
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.filt.vcf
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.gff
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.html
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.log
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.raw.vcf
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.subs.vcf
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.tab
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.txt
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.vcf
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.vcf.gz
[10:25:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out/snps.vcf.gz.csi
[10:25:03] Walltime used: 25 seconds
[10:25:03] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:25:03] Done.
[Thu Sep 10 10:25:03 2020]
Finished job 81.
9 of 107 steps (8%) done

[Thu Sep 10 10:25:03 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out
    jobid: 15
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3992AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 320000 reads in 22.416 CPU sec, 10.822 real sec
[10:25:04] Running: samtools index snps.bam 2>> snps.log
[10:25:04] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4052AA_AS.out\tSM:ESC_NA4052AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.809 sec; CPU: 36.919 sec
[samclip] Total SAM records 447452, removed 8412, allowed 783, passed 439040
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:04] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 113770 reads in 10.669 CPU sec, 1.520 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[10:25:05] This is snippy 4.4.3
[10:25:05] Written by Torsten Seemann
[10:25:05] Obtained from https://github.com/tseemann/snippy
[10:25:05] Detected operating system: linux
[10:25:05] Enabling bundled linux tools.
[10:25:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6418AA_AS.out\tSM:ESC_HA6418AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.597 sec; CPU: 32.901 sec
[samclip] Total SAM records 438445, removed 4810, allowed 723, passed 433635
[samclip] Header contained 3 lines
[samclip] Done.
[M::mem_process_seqs] Processed 110510 reads in 7.099 CPU sec, 1.340 real sec
[10:25:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[samclip] Processed 300000 records...
[10:25:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[M::mem_process_seqs] Processed 320158 reads in 24.359 CPU sec, 12.646 real sec
[10:25:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:05] Found gzip - /usr/bin/gzip
[10:25:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[10:25:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 400000 records...
[10:25:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:05] Treating reference as 'fasta' format.
[10:25:05] Will use 8 CPU cores.
[10:25:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta
[10:25:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out
[10:25:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out
[10:25:05] Creating reference folder: reference
[10:25:05] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8296AA_AS.out\tSM:ESC_SA8296AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.156 sec; CPU: 34.818 sec
[samclip] Total SAM records 435075, removed 4739, allowed 610, passed 430336
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:05] Wrote 1 sequences to ref.fa
[10:25:05] Wrote 0 features to ref.gff
[10:25:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8250AA_AS.out\tSM:ESC_SA8250AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.090 sec; CPU: 30.353 sec
[samclip] Total SAM records 431054, removed 2117, allowed 184, passed 428937
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 113760 reads in 8.568 CPU sec, 1.947 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[10:25:07] Running: samtools index snps.bam 2>> snps.log
[10:25:07] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:08] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320066 reads in 26.168 CPU sec, 10.347 real sec
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:08] Running: samtools index snps.bam 2>> snps.log
[10:25:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:25:08] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[samclip] Processed 400000 records...
[10:25:08] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8291AA_AS.out\tSM:ESC_SA8291AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 435078, removed 4778, allowed 550, passed 430300

[main] Real time: 16.681 sec; CPU: 33.790 sec
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 22
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 3128
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:09] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:09] Wrote 432980 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:09] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:09] Using BAM RG (Read Group) ID: ESC_NA3992AA_AS.out
[10:25:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 120490 reads in 9.832 CPU sec, 1.324 real sec
[samclip] Processed 100000 records...
[10:25:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:25:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 200000 records...
[10:25:09] Running: samtools index snps.bam 2>> snps.log
[10:25:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[10:25:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:10] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[samclip] Processed 400000 records...
[10:25:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4053AA_AS.out\tSM:ESC_NA4053AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.642 sec; CPU: 36.770 sec
[samclip] Total SAM records 442140, removed 7696, allowed 1230, passed 434444
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:11] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 35

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 35
       total no. variants observed              : 3308
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:12] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3992AA_AS.out\tSM:ESC_NA3992AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:25:13] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:13] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:13] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:13] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320096 sequences (80000146 bp)...
[10:25:13] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:13] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:25:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 24
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 34

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 34
       total no. variants observed              : 3098
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:25:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:25:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:14] Running: rm -f fake_reads\.fq 2>> snps.log

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 3179
       total no. reference observed             : 0

Time elapsed: 0.06s

[10:25:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:14] Running: samtools index snps.bam 2>> snps.log
[10:25:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:14] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:25:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:25:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 11
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 11

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 11
       total no. variants observed              : 118
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:25:15] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:15] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:16] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 24
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 34

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 34
       total no. variants observed              : 3200
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:17] Marked 382 heterozygous sites with 'n'
[10:25:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:17] Creating extra output files: BED GFF CSV TXT HTML
[10:25:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:17] Identified 3128 variants.
[10:25:17] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out
[10:25:17] Result files:
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.aligned.fa
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.bam
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.bam.bai
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.bed
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.consensus.fa
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.consensus.subs.fa
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.csv
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.filt.vcf
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.gff
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.html
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.log
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.raw.vcf
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.subs.vcf
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.tab
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.txt
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.vcf
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.vcf.gz
[10:25:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out/snps.vcf.gz.csi
[10:25:17] Walltime used: 34 seconds
[10:25:17] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:25:17] Done.
[10:25:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:18] Running: rm -f fake_reads\.fq 2>> snps.log
[Thu Sep 10 10:25:18 2020]
Finished job 51.
10 of 107 steps (9%) done

[Thu Sep 10 10:25:18 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out
    jobid: 65
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3975AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta
[M::process] read 112884 sequences (28217298 bp)...
[10:25:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 30
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 39

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 39
       total no. variants observed              : 3274
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:18] This is snippy 4.4.3
[10:25:18] Written by Torsten Seemann
[10:25:18] Obtained from https://github.com/tseemann/snippy
[10:25:18] Detected operating system: linux
[10:25:18] Enabling bundled linux tools.
[10:25:18] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:18] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:18] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:18] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:18] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:18] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:18] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:18] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:18] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:18] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:18] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:18] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:19] Found gzip - /usr/bin/gzip
[10:25:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:25:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:19] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:19] Treating reference as 'fasta' format.
[10:25:19] Will use 8 CPU cores.
[10:25:19] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta
[10:25:19] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out
[10:25:19] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out
[10:25:19] Creating reference folder: reference
[10:25:19] Extracting FASTA and GFF from reference.
[10:25:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:19] Marked 349 heterozygous sites with 'n'
[10:25:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:19] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:19] Wrote 1 sequences to ref.fa
[10:25:19] Wrote 0 features to ref.gff
[10:25:19] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta into pseudo-reads
[10:25:19] Creating extra output files: BED GFF CSV TXT HTML
[10:25:19] Identified 3308 variants.
[10:25:19] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out
[10:25:19] Result files:
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.aligned.fa
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.bam
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.bam.bai
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.bed
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.consensus.fa
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.consensus.subs.fa
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.csv
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.filt.vcf
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.gff
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.html
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.log
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.raw.vcf
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.subs.vcf
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.tab
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.txt
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.vcf
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.vcf.gz
[10:25:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out/snps.vcf.gz.csi
[10:25:19] Walltime used: 36 seconds
[10:25:19] Questionable SNP? Try the --report option to see the alignments.
[10:25:19] Done.
[Thu Sep 10 10:25:19 2020]
Finished job 57.
11 of 107 steps (10%) done

[Thu Sep 10 10:25:19 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out
    jobid: 59
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4066AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta
[10:25:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:20] Marked 459 heterozygous sites with 'n'
[10:25:20] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 320096 reads in 24.867 CPU sec, 6.710 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:20] Identified 3098 variants.
[10:25:20] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out
[10:25:20] Result files:
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.aligned.fa
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.bam
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.bam.bai
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.bed
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.consensus.fa
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.consensus.subs.fa
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.csv
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.filt.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.gff
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.html
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.log
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.raw.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.subs.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.tab
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.txt
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.vcf.gz
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out/snps.vcf.gz.csi
[10:25:20] Walltime used: 36 seconds
[10:25:20] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:25:20] Done.
[Thu Sep 10 10:25:20 2020]
Finished job 5.
12 of 107 steps (11%) done

[Thu Sep 10 10:25:20 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out
    jobid: 29
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_IA0811AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta
[10:25:20] This is snippy 4.4.3
[10:25:20] Written by Torsten Seemann
[10:25:20] Obtained from https://github.com/tseemann/snippy
[10:25:20] Detected operating system: linux
[10:25:20] Enabling bundled linux tools.
[10:25:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[samclip] Processed 100000 records...
[10:25:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:20] Found gzip - /usr/bin/gzip
[10:25:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:20] Marked 176 heterozygous sites with 'n'
[10:25:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:20] Creating extra output files: BED GFF CSV TXT HTML
[10:25:20] Identified 3179 variants.
[10:25:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:25:20] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out
[10:25:20] Result files:
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.aligned.fa
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.bam
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.bam.bai
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.bed
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.consensus.fa
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.consensus.subs.fa
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.csv
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.filt.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.gff
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.html
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.log
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.raw.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.subs.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.tab
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.txt
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.vcf
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.vcf.gz
[10:25:20] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out/snps.vcf.gz.csi
[10:25:20] Walltime used: 35 seconds
[10:25:20] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:25:20] Done.
[Thu Sep 10 10:25:20 2020]
Finished job 63.
13 of 107 steps (12%) done

[Thu Sep 10 10:25:20 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out
    jobid: 87
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4056AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta
[10:25:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:20] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:20] Treating reference as 'fasta' format.
[10:25:20] Will use 8 CPU cores.
[10:25:20] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta
[10:25:20] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out
[10:25:20] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out
[10:25:20] Creating reference folder: reference
[10:25:20] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:20] Wrote 1 sequences to ref.fa
[10:25:20] Wrote 0 features to ref.gff
[10:25:20] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[10:25:21] This is snippy 4.4.3
[10:25:21] Written by Torsten Seemann
[10:25:21] Obtained from https://github.com/tseemann/snippy
[10:25:21] Detected operating system: linux
[10:25:21] Enabling bundled linux tools.
[10:25:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:21] Found gzip - /usr/bin/gzip
[10:25:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 112884 reads in 9.034 CPU sec, 1.066 real sec
[10:25:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:21] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:21] Treating reference as 'fasta' format.
[10:25:21] Will use 8 CPU cores.
[10:25:21] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta
[10:25:21] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out
[10:25:21] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out
[10:25:21] Creating reference folder: reference
[10:25:21] Extracting FASTA and GFF from reference.
[10:25:21] Marked 50 heterozygous sites with 'n'
[10:25:21] This is snippy 4.4.3
[10:25:21] Written by Torsten Seemann
[10:25:21] Obtained from https://github.com/tseemann/snippy
[10:25:21] Detected operating system: linux
[10:25:21] Enabling bundled linux tools.
[10:25:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[samclip] Processed 400000 records...
[10:25:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:21] Creating extra output files: BED GFF CSV TXT HTML
[10:25:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:21] Identified 118 variants.
[10:25:21] Found gzip - /usr/bin/gzip
[10:25:21] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out
[10:25:21] Result files:
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.aligned.fa
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.bam
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.bam.bai
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.bed
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.consensus.fa
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.consensus.subs.fa
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.csv
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.filt.vcf
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.gff
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.html
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.log
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.raw.vcf
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.subs.vcf
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.tab
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.txt
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.vcf
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.vcf.gz
[10:25:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out/snps.vcf.gz.csi
[10:25:21] Walltime used: 36 seconds
[10:25:21] Wishing you a life free of homopolymer errors.
[10:25:21] Done.
[10:25:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[Thu Sep 10 10:25:21 2020]
Finished job 7.
14 of 107 steps (13%) done
[10:25:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3

[Thu Sep 10 10:25:21 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out
    jobid: 39
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3982AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3992AA_AS.out\tSM:ESC_NA3992AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 8.523 sec; CPU: 34.462 sec
[samclip] Total SAM records 434265, removed 5594, allowed 720, passed 428671
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:21] Wrote 1 sequences to ref.fa
[10:25:21] Wrote 0 features to ref.gff
[10:25:21] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:25:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:21] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:21] Treating reference as 'fasta' format.
[10:25:21] Will use 8 CPU cores.
[10:25:21] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta
[10:25:21] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out
[10:25:21] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out
[10:25:21] Creating reference folder: reference
[10:25:21] Extracting FASTA and GFF from reference.
[10:25:21] Wrote 1 sequences to ref.fa
[10:25:21] Wrote 0 features to ref.gff
[10:25:21] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:22] This is snippy 4.4.3
[10:25:22] Written by Torsten Seemann
[10:25:22] Obtained from https://github.com/tseemann/snippy
[10:25:22] Detected operating system: linux
[10:25:22] Enabling bundled linux tools.
[10:25:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:22] Found gzip - /usr/bin/gzip
[10:25:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:22] Marked 211 heterozygous sites with 'n'
[10:25:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:22] Wrote 437160 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:22] Creating extra output files: BED GFF CSV TXT HTML
[10:25:22] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:22] Using BAM RG (Read Group) ID: ESC_NA3975AA_AS.out
[10:25:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:25:22] Identified 3200 variants.
[10:25:22] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out
[10:25:22] Result files:
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.aligned.fa
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.bam
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.bam.bai
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.bed
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.consensus.fa
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.consensus.subs.fa
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.csv
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.filt.vcf
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.gff
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.html
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.log
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.raw.vcf
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.subs.vcf
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.tab
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.txt
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.vcf
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.vcf.gz
[10:25:22] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out/snps.vcf.gz.csi
[10:25:22] Walltime used: 38 seconds
[10:25:22] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:25:22] Done.
[10:25:22] Running: bwa index reference/ref.fa 2>> snps.log
[Thu Sep 10 10:25:22 2020]
Finished job 19.
15 of 107 steps (14%) done

[Thu Sep 10 10:25:22 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out
    jobid: 9
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_HA6413AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta
[10:25:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:22] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:22] Treating reference as 'fasta' format.
[10:25:22] Will use 8 CPU cores.
[10:25:22] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta
[10:25:22] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out
[10:25:22] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out
[10:25:22] Creating reference folder: reference
[10:25:22] Extracting FASTA and GFF from reference.
[10:25:23] Wrote 1 sequences to ref.fa
[10:25:23] Wrote 0 features to ref.gff
[10:25:23] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:23] This is snippy 4.4.3
[10:25:23] Written by Torsten Seemann
[10:25:23] Obtained from https://github.com/tseemann/snippy
[10:25:23] Detected operating system: linux
[10:25:23] Enabling bundled linux tools.
[10:25:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:23] Found gzip - /usr/bin/gzip
[10:25:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:25:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:23] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:23] Running: samtools index snps.bam 2>> snps.log
[10:25:23] Treating reference as 'fasta' format.
[10:25:23] Will use 8 CPU cores.
[10:25:23] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta
[10:25:23] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out
[10:25:23] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out
[10:25:23] Creating reference folder: reference
[10:25:23] Extracting FASTA and GFF from reference.
[10:25:24] Marked 365 heterozygous sites with 'n'
[10:25:24] Creating extra output files: BED GFF CSV TXT HTML
[10:25:24] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:24] Identified 3274 variants.
[10:25:24] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out
[10:25:24] Result files:
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.aligned.fa
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.bam
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.bam.bai
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.bed
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.consensus.fa
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.consensus.subs.fa
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.csv
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.filt.vcf
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.gff
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.html
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.log
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.raw.vcf
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.subs.vcf
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.tab
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.txt
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.vcf
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.vcf.gz
[10:25:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out/snps.vcf.gz.csi
[10:25:24] Walltime used: 35 seconds
[10:25:24] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:25:24] Done.
[10:25:24] Wrote 433918 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:24] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:24] Using BAM RG (Read Group) ID: ESC_NA4066AA_AS.out
[10:25:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[Thu Sep 10 10:25:24 2020]
Finished job 77.
16 of 107 steps (15%) done
[10:25:24] Wrote 1 sequences to ref.fa
[10:25:24] Wrote 0 features to ref.gff
[10:25:24] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta into pseudo-reads
[10:25:24] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

[Thu Sep 10 10:25:24 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out
    jobid: 43
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4071AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta
[10:25:24] Running: bwa index reference/ref.fa 2>> snps.log
[10:25:24] Wrote 433482 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:24] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:24] Using BAM RG (Read Group) ID: ESC_IA0811AA_AS.out
[10:25:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:25:25] Running: bwa index reference/ref.fa 2>> snps.log
[10:25:25] Wrote 436180 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:25] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:25] Using BAM RG (Read Group) ID: ESC_NA4056AA_AS.out
[10:25:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:25:25] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:25] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3975AA_AS.out\tSM:ESC_NA3975AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:25:26] This is snippy 4.4.3
[10:25:26] Written by Torsten Seemann
[10:25:26] Obtained from https://github.com/tseemann/snippy
[10:25:26] Detected operating system: linux
[10:25:26] Enabling bundled linux tools.
[M::process] read 320444 sequences (80000032 bp)...
[10:25:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:26] Wrote 430500 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:26] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:26] Using BAM RG (Read Group) ID: ESC_NA3982AA_AS.out
[10:25:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:25:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:26] Found gzip - /usr/bin/gzip
[10:25:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:26] Running: bwa index reference/ref.fa 2>> snps.log
[10:25:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 116716 sequences (29128610 bp)...
[10:25:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:25:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:26] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:26] Treating reference as 'fasta' format.
[10:25:26] Will use 8 CPU cores.
[10:25:26] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta
[10:25:26] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out
[10:25:26] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out
[10:25:26] Creating reference folder: reference
[10:25:26] Extracting FASTA and GFF from reference.
[10:25:27] Wrote 1 sequences to ref.fa
[10:25:27] Wrote 0 features to ref.gff
[10:25:27] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta into pseudo-reads
[10:25:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:27] Wrote 431622 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:27] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:27] Using BAM RG (Read Group) ID: ESC_HA6413AA_AS.out
[10:25:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:25:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:27] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4066AA_AS.out\tSM:ESC_NA4066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:25:27] Running: bwa index reference/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:25:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 26
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3180
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320108 sequences (80000032 bp)...
[10:25:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:28] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:29] Running: bwa mem  -Y -M -R '@RG\tID:ESC_IA0811AA_AS.out\tSM:ESC_IA0811AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 113810 sequences (28449800 bp)...
[M::process] read 320332 sequences (80000374 bp)...
[10:25:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::mem_process_seqs] Processed 320444 reads in 25.459 CPU sec, 3.555 real sec
[10:25:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:29] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4056AA_AS.out\tSM:ESC_NA4056AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[10:25:30] Wrote 428844 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:30] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:30] Using BAM RG (Read Group) ID: ESC_NA4071AA_AS.out
[10:25:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::process] read 321522 sequences (80000022 bp)...
[10:25:30] Running: bwa index reference/ref.fa 2>> snps.log
[10:25:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:30] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3982AA_AS.out\tSM:ESC_NA3982AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 116716 reads in 8.152 CPU sec, 1.013 real sec
[M::process] read 320078 sequences (80000386 bp)...
[samclip] Processed 300000 records...
[10:25:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:31] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6413AA_AS.out\tSM:ESC_HA6413AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 320068 sequences (80000436 bp)...
[samclip] Processed 400000 records...
[M::process] read 113150 sequences (28263022 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3975AA_AS.out\tSM:ESC_NA3975AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.571 sec; CPU: 34.292 sec
[samclip] Total SAM records 438562, removed 5471, allowed 678, passed 433091
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 111554 sequences (27888200 bp)...
[M::process] read 114658 sequences (28559392 bp)...
[10:25:33] Marked 221 heterozygous sites with 'n'
[10:25:34] Creating extra output files: BED GFF CSV TXT HTML
[10:25:34] Identified 3180 variants.
[10:25:34] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out
[10:25:34] Result files:
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.aligned.fa
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.bam
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.bam.bai
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.bed
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.consensus.fa
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.consensus.subs.fa
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.csv
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.filt.vcf
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.gff
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.html
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.log
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.raw.vcf
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.subs.vcf
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.tab
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.txt
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.vcf
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.vcf.gz
[10:25:34] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out/snps.vcf.gz.csi
[10:25:34] Walltime used: 29 seconds
[10:25:34] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:25:34] Done.
[Thu Sep 10 10:25:34 2020]
Finished job 15.
17 of 107 steps (16%) done

[Thu Sep 10 10:25:34 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out
    jobid: 89
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4061AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:34] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4071AA_AS.out\tSM:ESC_NA4071AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320108 reads in 25.491 CPU sec, 6.711 real sec
[M::process] read 320024 sequences (80000308 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:35] This is snippy 4.4.3
[10:25:35] Written by Torsten Seemann
[10:25:35] Obtained from https://github.com/tseemann/snippy
[10:25:35] Detected operating system: linux
[10:25:35] Enabling bundled linux tools.
[10:25:35] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:35] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:35] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:35] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:35] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:35] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:35] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:35] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:35] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:35] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:35] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:35] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:35] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:35] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:35] Found gzip - /usr/bin/gzip
[10:25:35] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:35] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:35] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:35] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:35] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:35] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:35] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:25:35] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[10:25:35] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:35] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:35] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:35] Treating reference as 'fasta' format.
[10:25:35] Will use 8 CPU cores.
[10:25:35] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta
[10:25:35] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out
[10:25:35] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out
[10:25:35] Creating reference folder: reference
[10:25:35] Extracting FASTA and GFF from reference.
[10:25:35] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 113810 reads in 8.319 CPU sec, 1.103 real sec
[10:25:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:36] Wrote 1 sequences to ref.fa
[10:25:36] Wrote 0 features to ref.gff
[10:25:36] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[M::process] read 110422 sequences (27601220 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4066AA_AS.out\tSM:ESC_NA4066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 9.970 sec; CPU: 34.603 sec
[samclip] Total SAM records 435149, removed 5809, allowed 752, passed 429340
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 321522 reads in 25.640 CPU sec, 7.919 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:39] Wrote 432188 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:25:39] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:39] Using BAM RG (Read Group) ID: ESC_NA4061AA_AS.out
[10:25:39] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 114658 reads in 7.275 CPU sec, 1.235 real sec
[10:25:39] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[10:25:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 26
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3178
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320332 reads in 24.791 CPU sec, 10.200 real sec
[samclip] Processed 200000 records...
[10:25:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320068 reads in 23.967 CPU sec, 8.365 real sec
[samclip] Processed 300000 records...
[10:25:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:40] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:40] Running: samtools index snps.bam 2>> snps.log
[10:25:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[10:25:40] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 113150 reads in 8.762 CPU sec, 1.165 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4056AA_AS.out\tSM:ESC_NA4056AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.403 sec; CPU: 33.764 sec
[samclip] Total SAM records 437261, removed 4696, allowed 683, passed 432565
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 111554 reads in 8.577 CPU sec, 1.184 real sec
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_IA0811AA_AS.out\tSM:ESC_IA0811AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.267 sec; CPU: 34.369 sec
[samclip] Total SAM records 434422, removed 5005, allowed 704, passed 429417
[samclip] Header contained 3 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320078 reads in 25.073 CPU sec, 11.288 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 400000 records...
[10:25:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:43] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4061AA_AS.out\tSM:ESC_NA4061AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6413AA_AS.out\tSM:ESC_HA6413AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.538 sec; CPU: 33.276 sec
[samclip] Total SAM records 432633, removed 4904, allowed 705, passed 427729
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320850 sequences (80000178 bp)...
[M::mem_process_seqs] Processed 110422 reads in 8.939 CPU sec, 1.608 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:44] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[10:25:44] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:44] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 111338 sequences (27679820 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 300000 records...

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 26
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3133
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:25:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3982AA_AS.out\tSM:ESC_NA3982AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.760 sec; CPU: 34.910 sec
[samclip] Total SAM records 431958, removed 5431, allowed 574, passed 426527
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:45] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:45] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:45] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:45] Marked 204 heterozygous sites with 'n'
[10:25:46] Creating extra output files: BED GFF CSV TXT HTML
[10:25:46] Identified 3178 variants.
[10:25:46] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out
[10:25:46] Result files:
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.aligned.fa
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.bam
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.bam.bai
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.bed
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.consensus.fa
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.consensus.subs.fa
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.csv
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.filt.vcf
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.gff
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.html
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.log
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.raw.vcf
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.subs.vcf
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.tab
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.txt
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.vcf
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.vcf.gz
[10:25:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out/snps.vcf.gz.csi
[10:25:46] Walltime used: 28 seconds
[10:25:46] Questionable SNP? Try the --report option to see the alignments.
[10:25:46] Done.
[Thu Sep 10 10:25:46 2020]
Finished job 65.
18 of 107 steps (17%) done

[Thu Sep 10 10:25:46 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out
    jobid: 67
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3973AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta
[10:25:46] Running: samtools index snps.bam 2>> snps.log
[10:25:46] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:25:48] This is snippy 4.4.3
[10:25:48] Written by Torsten Seemann
[10:25:48] Obtained from https://github.com/tseemann/snippy
[10:25:48] Detected operating system: linux
[10:25:48] Enabling bundled linux tools.
[10:25:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::process] read 108820 sequences (27194200 bp)...
[10:25:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 28
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 38

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 38
       total no. variants observed              : 3175
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:49] Found gzip - /usr/bin/gzip
[10:25:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:49] Running: samtools index snps.bam 2>> snps.log
[10:25:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:49] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:25:49] Checking version: java -version is >= 1.8 - ok, have 1.8
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:25:49] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:49] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 17
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 3129
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:49] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:49] Treating reference as 'fasta' format.
[10:25:49] Will use 8 CPU cores.
[10:25:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:49] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta
[10:25:49] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out
[10:25:49] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out
[10:25:49] Creating reference folder: reference
[10:25:49] Extracting FASTA and GFF from reference.
[10:25:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:50] Wrote 1 sequences to ref.fa
[10:25:50] Wrote 0 features to ref.gff
[10:25:50] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta into pseudo-reads
[10:25:50] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:50] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:50] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:50] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:50] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 23
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 34

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 34
       total no. variants observed              : 3123
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:50] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:25:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:25:51] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:51] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:25:51] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:51] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:25:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:51] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:51] Marked 132 heterozygous sites with 'n'
[10:25:51] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:25:51] Creating extra output files: BED GFF CSV TXT HTML
[10:25:51] Identified 3133 variants.
[M::mem_process_seqs] Processed 320024 reads in 26.145 CPU sec, 16.623 real sec
[10:25:51] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out
[10:25:51] Result files:
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.aligned.fa
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.bam
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.bam.bai
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.bed
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.consensus.fa
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.consensus.subs.fa
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.csv
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.filt.vcf
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.gff
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.html
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.log
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.raw.vcf
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.subs.vcf
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.tab
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.txt
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.vcf
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.vcf.gz
[10:25:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out/snps.vcf.gz.csi
[10:25:51] Walltime used: 31 seconds
[10:25:51] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:25:51] Done.
[Thu Sep 10 10:25:51 2020]
Finished job 59.
19 of 107 steps (18%) done

[Thu Sep 10 10:25:51 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out
    jobid: 37
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3971AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 108820 reads in 8.750 CPU sec, 1.266 real sec
[samclip] Processed 100000 records...
[10:25:53] This is snippy 4.4.3
[10:25:53] Written by Torsten Seemann
[10:25:53] Obtained from https://github.com/tseemann/snippy
[10:25:53] Detected operating system: linux
[10:25:53] Enabling bundled linux tools.
[10:25:53] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:53] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:53] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:53] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:53] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:53] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:53] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:53] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:53] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:53] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:53] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:53] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:53] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:53] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:53] Found gzip - /usr/bin/gzip
[10:25:53] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:53] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:53] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[10:25:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:25:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:53] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:53] Treating reference as 'fasta' format.
[10:25:53] Will use 8 CPU cores.
[10:25:53] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta
[10:25:53] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out
[10:25:53] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out
[10:25:53] Creating reference folder: reference
[10:25:53] Extracting FASTA and GFF from reference.
[10:25:53] Wrote 429240 fake 250bp reads (20x, stride 25bp) to fake_reads.fq

stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 25
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3191
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:25:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:25:53] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:53] Using BAM RG (Read Group) ID: ESC_NA3973AA_AS.out
[10:25:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:25:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[10:25:53] Running: bwa index reference/ref.fa 2>> snps.log
[10:25:53] Wrote 1 sequences to ref.fa
[10:25:53] Wrote 0 features to ref.gff
[10:25:53] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320850 reads in 25.304 CPU sec, 9.991 real sec
[10:25:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 400000 records...
[10:25:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:25:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:25:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4071AA_AS.out\tSM:ESC_NA4071AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 19.400 sec; CPU: 35.643 sec
[samclip] Total SAM records 430137, removed 5715, allowed 715, passed 424422
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:25:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[10:25:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:25:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:25:54] Running: rm -f fake_reads\.fq 2>> snps.log
[10:25:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 111338 reads in 9.199 CPU sec, 1.110 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[10:25:55] Marked 211 heterozygous sites with 'n'
[10:25:55] Creating extra output files: BED GFF CSV TXT HTML
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4061AA_AS.out\tSM:ESC_NA4061AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.142 sec; CPU: 35.088 sec
[samclip] Total SAM records 433351, removed 5172, allowed 757, passed 428179
[samclip] Header contained 3 lines
[samclip] Done.
[10:25:55] Identified 3175 variants.
[10:25:55] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out
[10:25:55] Result files:
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.aligned.fa
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.bam
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.bam.bai
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.bed
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.consensus.fa
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.consensus.subs.fa
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.csv
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.filt.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.gff
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.html
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.log
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.raw.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.subs.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.tab
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.txt
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.vcf.gz
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out/snps.vcf.gz.csi
[10:25:55] Walltime used: 34 seconds
[10:25:55] May the SNPs be with you.
[10:25:55] Done.
[Thu Sep 10 10:25:55 2020]
Finished job 87.
20 of 107 steps (19%) done

[Thu Sep 10 10:25:55 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out
    jobid: 31
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4070AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:55] Marked 368 heterozygous sites with 'n'
[10:25:55] Creating extra output files: BED GFF CSV TXT HTML
[10:25:55] Identified 3129 variants.
[10:25:55] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out
[10:25:55] Result files:
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.aligned.fa
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.bam
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.bam.bai
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.bed
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.consensus.fa
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.consensus.subs.fa
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.csv
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.filt.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.gff
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.html
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.log
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.raw.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.subs.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.tab
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.txt
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.vcf
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.vcf.gz
[10:25:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out/snps.vcf.gz.csi
[10:25:55] Walltime used: 34 seconds
[10:25:55] Questionable SNP? Try the --report option to see the alignments.
[10:25:55] Done.
[Thu Sep 10 10:25:55 2020]
Finished job 29.
21 of 107 steps (20%) done

[Thu Sep 10 10:25:55 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out
    jobid: 93
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3980AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:56] Marked 423 heterozygous sites with 'n'
[10:25:56] Creating extra output files: BED GFF CSV TXT HTML
[10:25:56] Identified 3123 variants.
[10:25:56] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out
[10:25:56] Result files:
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.aligned.fa
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.bam
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.bam.bai
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.bed
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.consensus.fa
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.consensus.subs.fa
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.csv
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.filt.vcf
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.gff
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.html
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.log
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.raw.vcf
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.subs.vcf
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.tab
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.txt
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.vcf
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.vcf.gz
[10:25:56] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out/snps.vcf.gz.csi
[10:25:56] Walltime used: 33 seconds
[10:25:56] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:25:56] Done.
[Thu Sep 10 10:25:56 2020]
Finished job 9.
22 of 107 steps (21%) done

[Thu Sep 10 10:25:56 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out
    jobid: 21
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4048AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:25:56] Running: samtools index snps.bam 2>> snps.log
[10:25:56] This is snippy 4.4.3
[10:25:56] Written by Torsten Seemann
[10:25:56] Obtained from https://github.com/tseemann/snippy
[10:25:56] Detected operating system: linux
[10:25:56] Enabling bundled linux tools.
[10:25:56] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:56] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:56] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:56] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:56] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:56] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:56] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:56] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:56] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:56] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:56] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:56] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:56] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:56] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:56] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:25:56] Found gzip - /usr/bin/gzip
[10:25:56] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:56] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:56] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:25:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:25:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:25:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:57] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3973AA_AS.out\tSM:ESC_NA3973AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:25:57] Wrote 432156 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:25:57] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:25:57] Using BAM RG (Read Group) ID: ESC_NA3971AA_AS.out
[10:25:57] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:25:57] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:57] Running: bwa index reference/ref.fa 2>> snps.log
[10:25:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:57] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:57] Treating reference as 'fasta' format.
[10:25:57] Will use 8 CPU cores.
[10:25:57] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta
[10:25:57] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out
[10:25:57] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out
[10:25:57] Creating reference folder: reference
[10:25:57] Extracting FASTA and GFF from reference.
[10:25:57] This is snippy 4.4.3
[10:25:57] Written by Torsten Seemann
[10:25:57] Obtained from https://github.com/tseemann/snippy
[10:25:57] Detected operating system: linux
[10:25:57] Enabling bundled linux tools.
[10:25:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:57] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:57] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:57] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:57] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:57] Found gzip - /usr/bin/gzip
[10:25:57] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:57] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:57] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320086 sequences (80000126 bp)...
[10:25:57] Wrote 1 sequences to ref.fa
[10:25:57] Wrote 0 features to ref.gff
[10:25:57] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta into pseudo-reads
[10:25:57] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:25:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:57] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:57] Treating reference as 'fasta' format.
[10:25:57] Will use 8 CPU cores.
[10:25:57] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta
[10:25:57] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out
[10:25:57] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out
[10:25:57] Creating reference folder: reference
[10:25:57] Extracting FASTA and GFF from reference.
[10:25:57] Running: samtools index snps.bam 2>> snps.log
[10:25:57] This is snippy 4.4.3
[10:25:57] Written by Torsten Seemann
[10:25:57] Obtained from https://github.com/tseemann/snippy
[10:25:57] Detected operating system: linux
[10:25:57] Enabling bundled linux tools.
[10:25:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:25:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:25:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:25:57] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:25:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:25:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:25:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:25:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:25:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:25:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:25:57] Wrote 1 sequences to ref.fa
[10:25:57] Wrote 0 features to ref.gff
[10:25:57] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta into pseudo-reads
[10:25:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:25:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:25:58] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:25:58] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:25:58] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:25:58] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:25:58] Found gzip - /usr/bin/gzip
[10:25:58] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:25:58] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:25:58] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:25:58] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:25:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:25:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:25:58] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:25:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:25:58] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:25:58] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:25:58] Treating reference as 'fasta' format.
[10:25:58] Will use 8 CPU cores.
[10:25:58] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta
[10:25:58] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out
[10:25:58] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out
[10:25:58] Creating reference folder: reference
[10:25:58] Extracting FASTA and GFF from reference.
[10:25:58] Wrote 1 sequences to ref.fa
[10:25:58] Wrote 0 features to ref.gff
[10:25:58] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta into pseudo-reads
[10:25:59] Marked 171 heterozygous sites with 'n'
[10:25:59] Creating extra output files: BED GFF CSV TXT HTML
[10:25:59] Identified 3191 variants.
[10:25:59] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out
[10:25:59] Result files:
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.aligned.fa
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.bam
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.bam.bai
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.bed
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.consensus.fa
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.consensus.subs.fa
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.csv
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.filt.vcf
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.gff
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.html
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.log
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.raw.vcf
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.subs.vcf
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.tab
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.txt
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.vcf
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.vcf.gz
[10:25:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out/snps.vcf.gz.csi
[10:25:59] Walltime used: 37 seconds
[10:25:59] May the SNPs be with you.
[10:25:59] Done.
[Thu Sep 10 10:25:59 2020]
Finished job 39.
23 of 107 steps (21%) done

[Thu Sep 10 10:25:59 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out
    jobid: 53
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_GA5350AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:00] This is snippy 4.4.3
[10:26:00] Written by Torsten Seemann
[10:26:00] Obtained from https://github.com/tseemann/snippy
[10:26:00] Detected operating system: linux
[10:26:00] Enabling bundled linux tools.
[10:26:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:00] Found gzip - /usr/bin/gzip
[10:26:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:26:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:00] Wrote 430226 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:00] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:00] Using BAM RG (Read Group) ID: ESC_NA4070AA_AS.out
[10:26:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:00] Running: samtools faidx reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 32
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 43

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 43
       total no. variants observed              : 3506
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:01] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::process] read 109154 sequences (27275304 bp)...
[10:26:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:01] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:01] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3971AA_AS.out\tSM:ESC_NA3971AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:26:01] Treating reference as 'fasta' format.
[10:26:01] Will use 8 CPU cores.
[10:26:01] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta
[10:26:01] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out
[10:26:01] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out
[10:26:01] Creating reference folder: reference
[10:26:01] Extracting FASTA and GFF from reference.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:26:01] Wrote 426252 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:01] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:01] Using BAM RG (Read Group) ID: ESC_NA3980AA_AS.out
[10:26:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:01] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:01] Wrote 1 sequences to ref.fa
[10:26:01] Wrote 0 features to ref.gff
[10:26:01] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta into pseudo-reads
[10:26:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 320040 sequences (80000178 bp)...
[10:26:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:01] Wrote 428210 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:01] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:01] Using BAM RG (Read Group) ID: ESC_NA4048AA_AS.out
[10:26:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:01] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 25
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3173
       total no. reference observed             : 0

Time elapsed: 0.04s

[10:26:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::process] read 112116 sequences (28010038 bp)...
[10:26:02] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:02] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320086 reads in 25.469 CPU sec, 6.201 real sec
[10:26:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[10:26:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:04] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4070AA_AS.out\tSM:ESC_NA4070AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::process] read 320416 sequences (80000270 bp)...
[10:26:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:04] Wrote 429232 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:04] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:04] Using BAM RG (Read Group) ID: ESC_GA5350AA_AS.out
[10:26:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:04] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::mem_process_seqs] Processed 109154 reads in 8.690 CPU sec, 1.114 real sec
[10:26:04] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3980AA_AS.out\tSM:ESC_NA3980AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320074 sequences (80000204 bp)...
[samclip] Processed 400000 records...
[M::process] read 106178 sequences (26544200 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3973AA_AS.out\tSM:ESC_NA3973AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 8.386 sec; CPU: 34.826 sec
[samclip] Total SAM records 430517, removed 5090, allowed 738, passed 425427
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:05] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4048AA_AS.out\tSM:ESC_NA4048AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 109810 sequences (27399172 bp)...
[M::process] read 320026 sequences (80000076 bp)...
[M::mem_process_seqs] Processed 320040 reads in 24.998 CPU sec, 5.182 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:07] Marked 427 heterozygous sites with 'n'
[10:26:07] Creating extra output files: BED GFF CSV TXT HTML
[10:26:07] Identified 3506 variants.
[10:26:07] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out
[10:26:07] Result files:
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.aligned.fa
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.bam
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.bam.bai
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.bed
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.consensus.fa
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.consensus.subs.fa
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.csv
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.filt.vcf
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.gff
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.html
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.log
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.raw.vcf
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.subs.vcf
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.tab
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.txt
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.vcf
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.vcf.gz
[10:26:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out/snps.vcf.gz.csi
[10:26:07] Walltime used: 41 seconds
[10:26:07] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:26:07] Done.
[Thu Sep 10 10:26:07 2020]
Finished job 43.
24 of 107 steps (22%) done

[Thu Sep 10 10:26:07 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out
    jobid: 25
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4063AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta
[samclip] Processed 100000 records...
[10:26:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:07] Running: bwa mem  -Y -M -R '@RG\tID:ESC_GA5350AA_AS.out\tSM:ESC_GA5350AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:26:07] Marked 182 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 112116 reads in 8.903 CPU sec, 1.155 real sec
[10:26:08] Creating extra output files: BED GFF CSV TXT HTML
[10:26:08] Identified 3173 variants.
[10:26:08] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out
[10:26:08] Result files:
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.aligned.fa
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.bam
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.bam.bai
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.bed
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.consensus.fa
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.consensus.subs.fa
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.csv
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.filt.vcf
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.gff
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.html
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.log
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.raw.vcf
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.subs.vcf
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.tab
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.txt
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.vcf
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.vcf.gz
[10:26:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out/snps.vcf.gz.csi
[10:26:08] Walltime used: 33 seconds
[10:26:08] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:26:08] Done.
[Thu Sep 10 10:26:08 2020]
Finished job 89.
25 of 107 steps (23%) done

[Thu Sep 10 10:26:08 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out
    jobid: 73
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4067AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta
[samclip] Processed 200000 records...
[M::process] read 320048 sequences (80000068 bp)...
[M::process] read 108184 sequences (27028996 bp)...
[10:26:08] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 300000 records...
[10:26:08] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:08] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 400000 records...
[10:26:09] This is snippy 4.4.3
[10:26:09] Written by Torsten Seemann
[10:26:09] Obtained from https://github.com/tseemann/snippy
[10:26:09] Detected operating system: linux
[10:26:09] Enabling bundled linux tools.
[10:26:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3971AA_AS.out\tSM:ESC_NA3971AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 8.321 sec; CPU: 34.602 sec
[samclip] Total SAM records 433230, removed 4753, allowed 677, passed 428477
[samclip] Header contained 3 lines
[samclip] Done.
[10:26:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:09] Found gzip - /usr/bin/gzip
[10:26:09] This is snippy 4.4.3
[10:26:09] Written by Torsten Seemann
[10:26:09] Obtained from https://github.com/tseemann/snippy
[10:26:09] Detected operating system: linux
[10:26:09] Enabling bundled linux tools.
[10:26:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:09] Found gzip - /usr/bin/gzip
[10:26:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 109184 sequences (27288658 bp)...
[10:26:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:10] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:10] Treating reference as 'fasta' format.
[10:26:10] Will use 8 CPU cores.
[10:26:10] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta
[10:26:10] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out
[10:26:10] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out
[10:26:10] Creating reference folder: reference
[10:26:10] Extracting FASTA and GFF from reference.
[10:26:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:10] Wrote 1 sequences to ref.fa
[10:26:10] Wrote 0 features to ref.gff
[10:26:10] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta into pseudo-reads
[10:26:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:10] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:10] Treating reference as 'fasta' format.
[10:26:10] Will use 8 CPU cores.
[10:26:10] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta
[10:26:10] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out
[10:26:10] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out
[10:26:10] Creating reference folder: reference
[10:26:10] Extracting FASTA and GFF from reference.
[10:26:11] Wrote 1 sequences to ref.fa
[10:26:11] Wrote 0 features to ref.gff
[10:26:11] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320416 reads in 25.771 CPU sec, 8.009 real sec
[10:26:12] Running: samtools index snps.bam 2>> snps.log
[10:26:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 24
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 35

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 35
       total no. variants observed              : 3319
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:12] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:13] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:13] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:13] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:13] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 109810 reads in 8.138 CPU sec, 1.130 real sec
[10:26:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:13] Wrote 424980 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:13] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:13] Using BAM RG (Read Group) ID: ESC_NA4063AA_AS.out
[10:26:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:13] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:13] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[10:26:14] Wrote 423074 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:14] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:14] Using BAM RG (Read Group) ID: ESC_NA4067AA_AS.out
[10:26:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:14] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320074 reads in 25.847 CPU sec, 9.549 real sec
[M::mem_process_seqs] Processed 320026 reads in 24.623 CPU sec, 8.516 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4070AA_AS.out\tSM:ESC_NA4070AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.327 sec; CPU: 34.626 sec
[samclip] Total SAM records 431423, removed 4909, allowed 647, passed 426514
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 108184 reads in 7.391 CPU sec, 1.211 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 106178 reads in 7.543 CPU sec, 1.492 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[10:26:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 8
          no. right trimmed                     : 31
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 43

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 43
       total no. variants observed              : 3307
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320048 reads in 24.784 CPU sec, 8.640 real sec
[10:26:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[10:26:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:26:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[samclip] Processed 100000 records...
[10:26:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4048AA_AS.out\tSM:ESC_NA4048AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.253 sec; CPU: 32.794 sec
[samclip] Total SAM records 429716, removed 6521, allowed 808, passed 423195
[samclip] Header contained 3 lines
[samclip] Done.
[10:26:17] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4067AA_AS.out\tSM:ESC_NA4067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:26:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:26:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:17] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 200000 records...
[10:26:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[samclip] Processed 400000 records...
[10:26:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:17] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4063AA_AS.out\tSM:ESC_NA4063AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 320052 sequences (80000474 bp)...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3980AA_AS.out\tSM:ESC_NA3980AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.977 sec; CPU: 34.245 sec
[samclip] Total SAM records 427340, removed 5643, allowed 945, passed 421697
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 109184 reads in 9.316 CPU sec, 1.146 real sec
[samclip] Processed 300000 records...
[M::process] read 320078 sequences (80000346 bp)...
[10:26:18] Running: samtools index snps.bam 2>> snps.log
[M::process] read 104902 sequences (26214428 bp)...
[10:26:18] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[samclip] Processed 400000 records...
[10:26:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_GA5350AA_AS.out\tSM:ESC_GA5350AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.790 sec; CPU: 34.640 sec
[samclip] Total SAM records 430179, removed 5098, allowed 763, passed 425081
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:19] Marked 229 heterozygous sites with 'n'
[10:26:19] Creating extra output files: BED GFF CSV TXT HTML
[10:26:19] Identified 3319 variants.
[10:26:19] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out
[10:26:19] Result files:
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.aligned.fa
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.bam
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.bam.bai
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.bed
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.consensus.fa
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.consensus.subs.fa
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.csv
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.filt.vcf
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.gff
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.html
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.log
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.raw.vcf
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.subs.vcf
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.tab
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.txt
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.vcf
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.vcf.gz
[10:26:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out/snps.vcf.gz.csi
[10:26:19] Walltime used: 31 seconds
[10:26:19] Wishing you a life free of homopolymer errors.
[10:26:19] Done.
[Thu Sep 10 10:26:19 2020]
Finished job 67.
26 of 107 steps (24%) done

[Thu Sep 10 10:26:19 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out
    jobid: 75
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4068AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta
[10:26:20] Running: samtools index snps.bam 2>> snps.log
[10:26:20] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:21] Running: samtools index snps.bam 2>> snps.log
[10:26:21] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:21] This is snippy 4.4.3
[10:26:21] Written by Torsten Seemann
[10:26:21] Obtained from https://github.com/tseemann/snippy
[10:26:21] Detected operating system: linux
[10:26:21] Enabling bundled linux tools.
[10:26:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:21] Found gzip - /usr/bin/gzip
[10:26:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:22] Running: samtools index snps.bam 2>> snps.log
[10:26:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:22] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 27
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 37

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 37
       total no. variants observed              : 3188
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:23] Marked 182 heterozygous sites with 'n'
[10:26:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:23] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:23] Treating reference as 'fasta' format.
[10:26:23] Will use 8 CPU cores.
[10:26:23] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta
[10:26:23] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out
[10:26:23] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out
[10:26:23] Creating reference folder: reference
[10:26:23] Extracting FASTA and GFF from reference.
[10:26:23] Creating extra output files: BED GFF CSV TXT HTML
[10:26:23] Identified 3307 variants.
[10:26:23] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out
[10:26:23] Result files:
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.aligned.fa
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.bam
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.bam.bai
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.bed
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.consensus.fa
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.consensus.subs.fa
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.csv
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.filt.vcf
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.gff
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.html
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.log
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.raw.vcf
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.subs.vcf
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.tab
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.txt
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.vcf
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.vcf.gz
[10:26:23] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out/snps.vcf.gz.csi
[10:26:23] Walltime used: 30 seconds
[10:26:23] Wishing you a life free of homopolymer errors.
[10:26:23] Done.
[Thu Sep 10 10:26:23 2020]
Finished job 37.
27 of 107 steps (25%) done

[Thu Sep 10 10:26:23 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out
    jobid: 1
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4004AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta
[10:26:23] Wrote 1 sequences to ref.fa
[10:26:23] Wrote 0 features to ref.gff
[10:26:23] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta into pseudo-reads
[10:26:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:26:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:24] Running: rm -f fake_reads\.fq 2>> snps.log

stats: biallelic
          no. left trimmed                      : 8
          no. right trimmed                     : 37
          no. left and right trimmed            : 6
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 51

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 51
       total no. variants observed              : 3365
       total no. reference observed             : 0

Time elapsed: 0.06s

[10:26:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:25] This is snippy 4.4.3
[10:26:25] Written by Torsten Seemann
[10:26:25] Obtained from https://github.com/tseemann/snippy
[10:26:25] Detected operating system: linux
[10:26:25] Enabling bundled linux tools.
[10:26:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 24
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 34

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 34
       total no. variants observed              : 3242
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:25] Found gzip - /usr/bin/gzip
[10:26:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:25] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:25] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:25] Treating reference as 'fasta' format.
[10:26:25] Will use 8 CPU cores.
[10:26:25] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta
[10:26:25] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out
[10:26:25] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out
[10:26:25] Creating reference folder: reference
[10:26:25] Extracting FASTA and GFF from reference.
[10:26:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:26] Wrote 1 sequences to ref.fa
[10:26:26] Wrote 0 features to ref.gff
[10:26:26] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta into pseudo-reads
[10:26:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:26] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 103022 sequences (25738346 bp)...
[10:26:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 320078 reads in 23.392 CPU sec, 8.289 real sec

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 19
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 3017
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:26] Wrote 422066 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:26] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:26] Using BAM RG (Read Group) ID: ESC_NA4068AA_AS.out
[10:26:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:26] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[10:26:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:27] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:27] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 104902 reads in 7.864 CPU sec, 1.007 real sec
[10:26:27] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[10:26:27] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:27] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320052 reads in 23.597 CPU sec, 9.936 real sec
[10:26:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4063AA_AS.out\tSM:ESC_NA4063AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.667 sec; CPU: 31.966 sec
[samclip] Total SAM records 426371, removed 5744, allowed 752, passed 420627
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 103022 reads in 8.775 CPU sec, 1.064 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4067AA_AS.out\tSM:ESC_NA4067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.827 sec; CPU: 32.948 sec
[samclip] Total SAM records 424254, removed 4754, allowed 621, passed 419500
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:29] Wrote 423584 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:29] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:29] Using BAM RG (Read Group) ID: ESC_NA4004AA_AS.out
[10:26:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:29] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:29] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4068AA_AS.out\tSM:ESC_NA4068AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:26:29] Marked 254 heterozygous sites with 'n'
[10:26:29] Creating extra output files: BED GFF CSV TXT HTML
[10:26:29] Identified 3188 variants.
[10:26:29] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out
[10:26:29] Result files:
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.aligned.fa
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.bam
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.bam.bai
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.bed
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.consensus.fa
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.consensus.subs.fa
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.csv
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.filt.vcf
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.gff
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.html
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.log
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.raw.vcf
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.subs.vcf
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.tab
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.txt
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.vcf
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.vcf.gz
[10:26:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out/snps.vcf.gz.csi
[10:26:29] Walltime used: 33 seconds
[10:26:29] Questionable SNP? Try the --report option to see the alignments.
[10:26:29] Done.
[Thu Sep 10 10:26:29 2020]
Finished job 31.
28 of 107 steps (26%) done

[Thu Sep 10 10:26:29 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out
    jobid: 71
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4045AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta
[M::process] read 320084 sequences (80000346 bp)...
[M::process] read 101982 sequences (25478552 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:30] Marked 260 heterozygous sites with 'n'
[10:26:30] Creating extra output files: BED GFF CSV TXT HTML
[10:26:30] Identified 3365 variants.
[10:26:30] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out
[10:26:30] Result files:
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.aligned.fa
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.bam
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.bam.bai
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.bed
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.consensus.fa
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.consensus.subs.fa
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.csv
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.filt.vcf
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.gff
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.html
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.log
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.raw.vcf
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.subs.vcf
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.tab
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.txt
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.vcf
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.vcf.gz
[10:26:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out/snps.vcf.gz.csi
[10:26:30] Walltime used: 33 seconds
[10:26:30] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:26:30] Done.
[Thu Sep 10 10:26:30 2020]
Finished job 21.
29 of 107 steps (27%) done

[Thu Sep 10 10:26:30 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out
    jobid: 23
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4055AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta
[10:26:30] Running: samtools index snps.bam 2>> snps.log
[10:26:30] This is snippy 4.4.3
[10:26:30] Written by Torsten Seemann
[10:26:30] Obtained from https://github.com/tseemann/snippy
[10:26:30] Detected operating system: linux
[10:26:30] Enabling bundled linux tools.
[10:26:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:30] Found gzip - /usr/bin/gzip
[10:26:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:30] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:31] Marked 215 heterozygous sites with 'n'
[10:26:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:31] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:31] Treating reference as 'fasta' format.
[10:26:31] Will use 8 CPU cores.
[10:26:31] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta
[10:26:31] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out
[10:26:31] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out
[10:26:31] Creating reference folder: reference
[10:26:31] Extracting FASTA and GFF from reference.
[10:26:31] Creating extra output files: BED GFF CSV TXT HTML
[10:26:31] Identified 3242 variants.
[10:26:31] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out
[10:26:31] Result files:
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.aligned.fa
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.bam
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.bam.bai
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.bed
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.consensus.fa
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.consensus.subs.fa
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.csv
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.filt.vcf
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.gff
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.html
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.log
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.raw.vcf
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.subs.vcf
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.tab
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.txt
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.vcf
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.vcf.gz
[10:26:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out/snps.vcf.gz.csi
[10:26:31] Walltime used: 34 seconds
[10:26:31] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:26:31] Done.
[Thu Sep 10 10:26:31 2020]
Finished job 93.
30 of 107 steps (28%) done

[Thu Sep 10 10:26:31 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out
    jobid: 91
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4072AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta
[10:26:31] Wrote 1 sequences to ref.fa
[10:26:31] Wrote 0 features to ref.gff
[10:26:31] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:31] Running: samtools index snps.bam 2>> snps.log
[10:26:31] This is snippy 4.4.3
[10:26:31] Written by Torsten Seemann
[10:26:31] Obtained from https://github.com/tseemann/snippy
[10:26:31] Detected operating system: linux
[10:26:31] Enabling bundled linux tools.
[10:26:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:31] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:31] Found gzip - /usr/bin/gzip
[10:26:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:31] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:32] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:32] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:32] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:32] Treating reference as 'fasta' format.
[10:26:32] Will use 8 CPU cores.
[10:26:32] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta
[10:26:32] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out
[10:26:32] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out
[10:26:32] Creating reference folder: reference
[10:26:32] Extracting FASTA and GFF from reference.
[10:26:32] This is snippy 4.4.3
[10:26:32] Written by Torsten Seemann
[10:26:32] Obtained from https://github.com/tseemann/snippy
[10:26:32] Detected operating system: linux
[10:26:32] Enabling bundled linux tools.
[10:26:32] Marked 278 heterozygous sites with 'n'
[10:26:32] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:32] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:32] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:32] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:32] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:32] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:32] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:32] Creating extra output files: BED GFF CSV TXT HTML
[10:26:32] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:32] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:32] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:32] Wrote 1 sequences to ref.fa
[10:26:32] Wrote 0 features to ref.gff
[10:26:32] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta into pseudo-reads
[10:26:32] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:32] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:32] Identified 3017 variants.
[10:26:32] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out
[10:26:32] Result files:
[10:26:32] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.aligned.fa
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.bam
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.bam.bai
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.bed
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.consensus.fa
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.consensus.subs.fa
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.csv
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.filt.vcf
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.gff
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.html
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.log
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.raw.vcf
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.subs.vcf
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.tab
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.txt
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.vcf
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.vcf.gz
[10:26:32] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out/snps.vcf.gz.csi
[10:26:32] Walltime used: 32 seconds
[10:26:32] Wishing you a life free of homopolymer errors.
[10:26:32] Done.
[10:26:32] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4004AA_AS.out\tSM:ESC_NA4004AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:26:32] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:32] Found gzip - /usr/bin/gzip
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[Thu Sep 10 10:26:32 2020]
Finished job 53.
31 of 107 steps (29%) done

[Thu Sep 10 10:26:32 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out
    jobid: 47
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4069AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta
[10:26:32] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:32] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:26:32] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:32] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:32] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:32] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:32] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:32] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:32] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:32] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:32] Treating reference as 'fasta' format.
[10:26:32] Will use 8 CPU cores.
[10:26:32] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta
[10:26:32] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out
[10:26:32] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out
[10:26:32] Creating reference folder: reference
[10:26:32] Extracting FASTA and GFF from reference.
[M::process] read 320096 sequences (80000260 bp)...
[10:26:33] Wrote 1 sequences to ref.fa
[10:26:33] Wrote 0 features to ref.gff
[10:26:33] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:33] This is snippy 4.4.3
[10:26:33] Written by Torsten Seemann
[10:26:33] Obtained from https://github.com/tseemann/snippy
[10:26:33] Detected operating system: linux
[10:26:33] Enabling bundled linux tools.
[10:26:33] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:33] Found gzip - /usr/bin/gzip
[10:26:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:34] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:34] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:34] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:34] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:34] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:34] Wrote 424214 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:34] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:34] Using BAM RG (Read Group) ID: ESC_NA4045AA_AS.out
[10:26:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:34] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:34] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:26:34] Treating reference as 'fasta' format.
[10:26:34] Will use 8 CPU cores.
[10:26:34] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta
[10:26:34] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out
[10:26:34] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out
[10:26:34] Creating reference folder: reference
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:34] Extracting FASTA and GFF from reference.

stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 26
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 38

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 38
       total no. variants observed              : 3190
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:34] Wrote 1 sequences to ref.fa
[10:26:34] Wrote 0 features to ref.gff
[10:26:34] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta into pseudo-reads
[10:26:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 103488 sequences (25864382 bp)...
[10:26:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:35] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:35] Wrote 423406 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:35] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:35] Using BAM RG (Read Group) ID: ESC_NA4055AA_AS.out
[10:26:35] Running: samtools faidx reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 23
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 33

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 33
       total no. variants observed              : 3191
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:35] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:35] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320084 reads in 25.034 CPU sec, 6.085 real sec
[10:26:36] Wrote 422708 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:36] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:36] Using BAM RG (Read Group) ID: ESC_NA4072AA_AS.out
[10:26:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:36] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:36] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 101982 reads in 7.179 CPU sec, 0.916 real sec
[M::mem_process_seqs] Processed 320096 reads in 21.620 CPU sec, 4.379 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4068AA_AS.out\tSM:ESC_NA4068AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 8.390 sec; CPU: 33.032 sec
[samclip] Total SAM records 423196, removed 4658, allowed 585, passed 418538
[samclip] Header contained 3 lines
[samclip] Done.
[10:26:38] Wrote 423802 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:38] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:38] Using BAM RG (Read Group) ID: ESC_NA4069AA_AS.out
[10:26:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:38] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:38] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:38] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:38] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:38] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4045AA_AS.out\tSM:ESC_NA4045AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 103488 reads in 8.927 CPU sec, 1.066 real sec
[samclip] Processed 400000 records...
[M::process] read 320028 sequences (80000132 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4004AA_AS.out\tSM:ESC_NA4004AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.246 sec; CPU: 31.130 sec
[samclip] Total SAM records 424798, removed 4885, allowed 518, passed 419913
[samclip] Header contained 3 lines
[samclip] Done.
[M::process] read 104186 sequences (26036904 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:39] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:39] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:39] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:39] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:39] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4055AA_AS.out\tSM:ESC_NA4055AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320254 sequences (80000248 bp)...
[10:26:40] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:40] Marked 203 heterozygous sites with 'n'
[10:26:40] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:40] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:40] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:26:40] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4072AA_AS.out\tSM:ESC_NA4072AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:26:40] Creating extra output files: BED GFF CSV TXT HTML
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:26:40] Identified 3190 variants.
[10:26:40] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out
[10:26:40] Result files:
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.aligned.fa
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.bam
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.bam.bai
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.bed
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.consensus.fa
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.consensus.subs.fa
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.csv
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.filt.vcf
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.gff
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.html
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.log
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.raw.vcf
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.subs.vcf
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.tab
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.txt
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.vcf
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.vcf.gz
[10:26:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out/snps.vcf.gz.csi
[10:26:40] Walltime used: 31 seconds
[10:26:40] Wishing you a life free of homopolymer errors.
[10:26:40] Done.
[Thu Sep 10 10:26:40 2020]
Finished job 25.
32 of 107 steps (30%) done

[Thu Sep 10 10:26:40 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out
    jobid: 27
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3974AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta
[10:26:40] Running: samtools index snps.bam 2>> snps.log
[10:26:40] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320052 sequences (80000002 bp)...
[10:26:41] Running: samtools index snps.bam 2>> snps.log
[10:26:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:41] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4069AA_AS.out\tSM:ESC_NA4069AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:26:41] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[10:26:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:26:41] Marked 221 heterozygous sites with 'n'
[10:26:41] Creating extra output files: BED GFF CSV TXT HTML
[10:26:41] Identified 3191 variants.
[10:26:41] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out
[10:26:41] Result files:
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.aligned.fa
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.bam
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.bam.bai
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.bed
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.consensus.fa
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.consensus.subs.fa
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.csv
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.filt.vcf
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.gff
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.html
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.log
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.raw.vcf
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.subs.vcf
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.tab
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.txt
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.vcf
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.vcf.gz
[10:26:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out/snps.vcf.gz.csi
[10:26:41] Walltime used: 32 seconds
[10:26:41] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:26:41] Done.
[Thu Sep 10 10:26:41 2020]
Finished job 73.
33 of 107 steps (31%) done

[Thu Sep 10 10:26:41 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out
    jobid: 49
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_HA6411AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta
[M::process] read 320084 sequences (80000282 bp)...
[10:26:41] This is snippy 4.4.3
[10:26:41] Written by Torsten Seemann
[10:26:41] Obtained from https://github.com/tseemann/snippy
[10:26:41] Detected operating system: linux
[10:26:41] Enabling bundled linux tools.
[10:26:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:42] Found gzip - /usr/bin/gzip
[10:26:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:44] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:44] Treating reference as 'fasta' format.
[10:26:44] Will use 8 CPU cores.
[10:26:44] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta
[10:26:44] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out
[10:26:44] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out
[10:26:44] Creating reference folder: reference
[10:26:44] Extracting FASTA and GFF from reference.
[10:26:44] Wrote 1 sequences to ref.fa
[10:26:44] Wrote 0 features to ref.gff
[10:26:44] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta into pseudo-reads
[10:26:44] This is snippy 4.4.3
[10:26:44] Written by Torsten Seemann
[10:26:44] Obtained from https://github.com/tseemann/snippy
[10:26:44] Detected operating system: linux
[10:26:44] Enabling bundled linux tools.
[10:26:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:44] Found gzip - /usr/bin/gzip
[10:26:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:26:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:44] Checking version: java -version is >= 1.8 - ok, have 1.8

stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 25
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3189
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[M::mem_process_seqs] Processed 320028 reads in 25.035 CPU sec, 6.303 real sec
[10:26:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:44] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:44] Treating reference as 'fasta' format.
[10:26:44] Will use 8 CPU cores.
[10:26:44] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta
[10:26:44] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out
[10:26:44] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out
[10:26:44] Creating reference folder: reference
[10:26:44] Extracting FASTA and GFF from reference.
[10:26:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:45] Wrote 1 sequences to ref.fa
[10:26:45] Wrote 0 features to ref.gff
[10:26:45] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta into pseudo-reads
[10:26:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 102656 sequences (25661008 bp)...
[10:26:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 7
          no. right trimmed                     : 26
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 37

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 37
       total no. variants observed              : 3163
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:45] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 100000 records...
[10:26:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 104186 reads in 7.486 CPU sec, 0.948 real sec
[M::process] read 103152 sequences (25771738 bp)...
[10:26:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:46] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:46] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[10:26:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:46] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[M::process] read 103718 sequences (25916210 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4045AA_AS.out\tSM:ESC_NA4045AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 9.158 sec; CPU: 33.250 sec
[samclip] Total SAM records 425365, removed 5026, allowed 937, passed 420339
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:47] Wrote 422150 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:47] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:47] Using BAM RG (Read Group) ID: ESC_NA3974AA_AS.out
[10:26:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:47] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320052 reads in 21.884 CPU sec, 7.242 real sec
[10:26:48] Wrote 421888 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:48] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:48] Using BAM RG (Read Group) ID: ESC_HA6411AA_AS.out
[10:26:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:48] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 102656 reads in 8.487 CPU sec, 1.104 real sec
[M::mem_process_seqs] Processed 320254 reads in 25.721 CPU sec, 8.900 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 103152 reads in 6.811 CPU sec, 0.837 real sec
[samclip] Processed 400000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4072AA_AS.out\tSM:ESC_NA4072AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 9.790 sec; CPU: 31.198 sec
[samclip] Total SAM records 423889, removed 4886, allowed 695, passed 419003
[samclip] Header contained 3 lines
[samclip] Done.
[10:26:50] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320084 reads in 24.623 CPU sec, 8.665 real sec
[10:26:50] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[samclip] Processed 300000 records...
[10:26:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[10:26:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:51] Marked 188 heterozygous sites with 'n'
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4055AA_AS.out\tSM:ESC_NA4055AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.192 sec; CPU: 33.170 sec
[samclip] Total SAM records 424743, removed 5207, allowed 826, passed 419536
[samclip] Header contained 3 lines
[samclip] Done.
[10:26:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:26:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:51] Creating extra output files: BED GFF CSV TXT HTML
[10:26:51] Identified 3189 variants.
[10:26:51] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out
[10:26:51] Result files:
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.aligned.fa
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.bam
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.bam.bai
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.bed
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.consensus.fa
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.consensus.subs.fa
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.csv
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.filt.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.gff
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.html
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.log
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.raw.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.subs.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.tab
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.txt
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.vcf.gz
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out/snps.vcf.gz.csi
[10:26:51] Walltime used: 30 seconds
[10:26:51] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:26:51] Done.
[10:26:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:51] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3974AA_AS.out\tSM:ESC_NA3974AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[Thu Sep 10 10:26:51 2020]
Finished job 75.
34 of 107 steps (32%) done

[Thu Sep 10 10:26:51 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out
    jobid: 61
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4003AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 103718 reads in 8.039 CPU sec, 1.049 real sec
[10:26:51] Marked 198 heterozygous sites with 'n'
[10:26:51] Creating extra output files: BED GFF CSV TXT HTML
[10:26:51] Identified 3163 variants.
[10:26:51] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out
[10:26:51] Result files:
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.aligned.fa
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.bam
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.bam.bai
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.bed
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.consensus.fa
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.consensus.subs.fa
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.csv
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.filt.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.gff
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.html
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.log
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.raw.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.subs.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.tab
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.txt
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.vcf
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.vcf.gz
[10:26:51] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out/snps.vcf.gz.csi
[10:26:51] Walltime used: 26 seconds
[10:26:51] May the SNPs be with you.
[10:26:51] Done.
[M::process] read 320034 sequences (80000468 bp)...
[Thu Sep 10 10:26:51 2020]
Finished job 1.
35 of 107 steps (33%) done

[Thu Sep 10 10:26:51 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out
    jobid: 3
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4000AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[10:26:52] This is snippy 4.4.3
[10:26:52] Written by Torsten Seemann
[10:26:52] Obtained from https://github.com/tseemann/snippy
[10:26:52] Detected operating system: linux
[10:26:52] Enabling bundled linux tools.
[10:26:52] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:52] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:52] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:52] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:52] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:52] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:52] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:52] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:52] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:52] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:52] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:52] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:52] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:52] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:52] Found gzip - /usr/bin/gzip
[10:26:52] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:52] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:52] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:52] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:52] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:52] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 400000 records...
[10:26:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:26:52] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:52] Running: ln -sf reference/ref.fa . 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:26:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:26:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:52] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6411AA_AS.out\tSM:ESC_HA6411AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4069AA_AS.out\tSM:ESC_NA4069AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.194 sec; CPU: 33.394 sec
[samclip] Total SAM records 424980, removed 4749, allowed 548, passed 420231
[samclip] Header contained 3 lines
[samclip] Done.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:52] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:52] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:52] Treating reference as 'fasta' format.
[10:26:52] Will use 8 CPU cores.
[10:26:52] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta
[10:26:52] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out
[10:26:52] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out
[10:26:52] Creating reference folder: reference
[10:26:52] Extracting FASTA and GFF from reference.
[10:26:52] This is snippy 4.4.3
[10:26:52] Written by Torsten Seemann
[10:26:52] Obtained from https://github.com/tseemann/snippy
[10:26:52] Detected operating system: linux
[10:26:52] Enabling bundled linux tools.
[10:26:52] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:26:52] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:26:52] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:26:52] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:26:52] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:26:52] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:26:52] Wrote 1 sequences to ref.fa
[10:26:52] Wrote 0 features to ref.gff
[10:26:52] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta into pseudo-reads
[10:26:52] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:26:52] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:26:52] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:26:52] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:26:52] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:26:52] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:26:52] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:26:52] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:26:52] Found gzip - /usr/bin/gzip
[10:26:52] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:26:52] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:26:52] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:26:52] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:26:52] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:26:52] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320104 sequences (80000456 bp)...
[10:26:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:26:53] Running: samtools index snps.bam 2>> snps.log
[10:26:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:26:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:26:53] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:26:53] Treating reference as 'fasta' format.
[10:26:53] Will use 8 CPU cores.
[10:26:53] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta
[10:26:53] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out
[10:26:53] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out
[10:26:53] Creating reference folder: reference
[10:26:53] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:53] Extracting FASTA and GFF from reference.
[10:26:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:53] Wrote 1 sequences to ref.fa
[10:26:53] Wrote 0 features to ref.gff
[10:26:53] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta into pseudo-reads
[10:26:53] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:26:54] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 25
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 35

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 35
       total no. variants observed              : 3170
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:55] Running: samtools index snps.bam 2>> snps.log
[10:26:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:55] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:26:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:26:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:56] Wrote 423204 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:56] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:56] Using BAM RG (Read Group) ID: ESC_NA4003AA_AS.out
[10:26:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:56] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:56] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:56] Wrote 424712 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:26:56] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:26:56] Using BAM RG (Read Group) ID: ESC_NA4000AA_AS.out
[10:26:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:26:56] Running: bwa index reference/ref.fa 2>> snps.log
[10:26:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 25
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 33

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 33
       total no. variants observed              : 3171
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:26:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 28
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3176
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:26:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:26:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:26:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:58] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:26:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:26:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:26:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:26:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:26:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:26:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:26:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:26:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:26:59] Running: rm -f fake_reads\.fq 2>> snps.log
[10:26:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 101784 sequences (25424068 bp)...
[M::process] read 102116 sequences (25522104 bp)...
[10:27:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 35

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 35
       total no. variants observed              : 3146
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:27:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:27:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:00] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4003AA_AS.out\tSM:ESC_NA4003AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:27:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::mem_process_seqs] Processed 320104 reads in 24.555 CPU sec, 7.940 real sec
[10:27:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:00] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4000AA_AS.out\tSM:ESC_NA4000AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:27:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:01] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320040 sequences (80000112 bp)...
[10:27:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320090 sequences (80000324 bp)...
[M::mem_process_seqs] Processed 320034 reads in 24.037 CPU sec, 9.810 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 101784 reads in 7.173 CPU sec, 0.940 real sec
[10:27:02] Marked 182 heterozygous sites with 'n'
[10:27:02] Creating extra output files: BED GFF CSV TXT HTML
[10:27:02] Identified 3170 variants.
[10:27:02] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out
[10:27:02] Result files:
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.aligned.fa
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.bam
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.bam.bai
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.bed
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.consensus.fa
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.consensus.subs.fa
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.csv
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.filt.vcf
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.gff
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.html
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.log
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.raw.vcf
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.subs.vcf
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.tab
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.txt
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.vcf
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.vcf.gz
[10:27:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out/snps.vcf.gz.csi
[10:27:02] Walltime used: 32 seconds
[10:27:02] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:27:02] Done.
[Thu Sep 10 10:27:02 2020]
Finished job 71.
36 of 107 steps (34%) done

[Thu Sep 10 10:27:02 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out
    jobid: 79
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4005AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 102116 reads in 8.809 CPU sec, 1.144 real sec
[M::process] read 103164 sequences (25788600 bp)...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 104622 sequences (26140594 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6411AA_AS.out\tSM:ESC_HA6411AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.779 sec; CPU: 32.565 sec
[samclip] Total SAM records 422788, removed 4068, allowed 614, passed 418720
[samclip] Header contained 3 lines
[samclip] Done.
[10:27:03] Marked 209 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:03] Creating extra output files: BED GFF CSV TXT HTML
[10:27:03] Identified 3171 variants.
[10:27:03] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out
[10:27:03] Result files:
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.aligned.fa
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.bam
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.bam.bai
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.bed
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.consensus.fa
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.consensus.subs.fa
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.csv
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.filt.vcf
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.gff
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.html
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.log
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.raw.vcf
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.subs.vcf
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.tab
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.txt
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.vcf
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.vcf.gz
[10:27:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out/snps.vcf.gz.csi
[10:27:03] Walltime used: 31 seconds
[10:27:03] Questionable SNP? Try the --report option to see the alignments.
[10:27:03] Done.
[10:27:03] This is snippy 4.4.3
[10:27:03] Written by Torsten Seemann
[10:27:03] Obtained from https://github.com/tseemann/snippy
[10:27:03] Detected operating system: linux
[10:27:03] Enabling bundled linux tools.
[Thu Sep 10 10:27:03 2020]
Finished job 91.
37 of 107 steps (35%) done

[Thu Sep 10 10:27:03 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out
    jobid: 69
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA3999AA_AS
    threads: 5
[10:27:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta
[10:27:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[samclip] Processed 300000 records...
[10:27:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:03] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:03] Found gzip - /usr/bin/gzip
[10:27:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3974AA_AS.out\tSM:ESC_NA3974AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.074 sec; CPU: 33.602 sec
[samclip] Total SAM records 423392, removed 4877, allowed 572, passed 418515
[samclip] Header contained 3 lines
[samclip] Done.
[10:27:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:04] Marked 213 heterozygous sites with 'n'
[10:27:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:04] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:04] Treating reference as 'fasta' format.
[10:27:04] Will use 8 CPU cores.
[10:27:04] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta
[10:27:04] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out
[10:27:04] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out
[10:27:04] Creating reference folder: reference
[10:27:04] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:27:04] Creating extra output files: BED GFF CSV TXT HTML
[10:27:04] Identified 3176 variants.
[10:27:04] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out
[10:27:04] Result files:
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.aligned.fa
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.bam
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.bam.bai
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.bed
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.consensus.fa
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.consensus.subs.fa
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.csv
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.filt.vcf
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.gff
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.html
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.log
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.raw.vcf
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.subs.vcf
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.tab
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.txt
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.vcf
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.vcf.gz
[10:27:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out/snps.vcf.gz.csi
[10:27:04] Walltime used: 33 seconds
[10:27:04] May the SNPs be with you.
[10:27:04] Done.
[Thu Sep 10 10:27:04 2020]
Finished job 23.
38 of 107 steps (36%) done

[Thu Sep 10 10:27:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out
    jobid: 33
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4046AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta
[10:27:04] Wrote 1 sequences to ref.fa
[10:27:04] Wrote 0 features to ref.gff
[10:27:04] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta into pseudo-reads
[10:27:05] This is snippy 4.4.3
[10:27:05] Written by Torsten Seemann
[10:27:05] Obtained from https://github.com/tseemann/snippy
[10:27:05] Detected operating system: linux
[10:27:05] Enabling bundled linux tools.
[10:27:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:05] Found gzip - /usr/bin/gzip
[10:27:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:27:05] Treating reference as 'fasta' format.
[10:27:05] Will use 8 CPU cores.
[10:27:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta
[10:27:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out
[10:27:05] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out
[10:27:05] Creating reference folder: reference
[10:27:05] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:27:05] Wrote 1 sequences to ref.fa
[10:27:05] Wrote 0 features to ref.gff
[10:27:05] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta into pseudo-reads
[10:27:05] This is snippy 4.4.3
[10:27:05] Written by Torsten Seemann
[10:27:05] Obtained from https://github.com/tseemann/snippy
[10:27:05] Detected operating system: linux
[10:27:05] Enabling bundled linux tools.
[10:27:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[M::mem_process_seqs] Processed 320040 reads in 22.427 CPU sec, 4.657 real sec
[10:27:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:05] Found gzip - /usr/bin/gzip
[10:27:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:06] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:27:06] Treating reference as 'fasta' format.
[10:27:06] Will use 8 CPU cores.
[10:27:06] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta
[10:27:06] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out
[10:27:06] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out
[10:27:06] Creating reference folder: reference
[10:27:06] Extracting FASTA and GFF from reference.
[10:27:06] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[10:27:06] Wrote 1 sequences to ref.fa
[10:27:06] Wrote 0 features to ref.gff
[10:27:06] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320090 reads in 24.818 CPU sec, 5.002 real sec
[10:27:06] Marked 194 heterozygous sites with 'n'
[10:27:06] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:27:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:06] Creating extra output files: BED GFF CSV TXT HTML
[10:27:06] Identified 3146 variants.
[10:27:06] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out
[10:27:06] Result files:
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.aligned.fa
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.bam
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.bam.bai
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.bed
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.consensus.fa
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.consensus.subs.fa
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.csv
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.filt.vcf
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.gff
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.html
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.log
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.raw.vcf
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.subs.vcf
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.tab
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.txt
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.vcf
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.vcf.gz
[10:27:06] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out/snps.vcf.gz.csi
[10:27:06] Walltime used: 33 seconds
[10:27:06] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:27:06] Done.
[Thu Sep 10 10:27:06 2020]
Finished job 47.
39 of 107 steps (36%) done

[Thu Sep 10 10:27:06 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out
    jobid: 41
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome, sample=ESC_NA4035AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta
[M::mem_process_seqs] Processed 103164 reads in 8.284 CPU sec, 1.065 real sec
[samclip] Processed 200000 records...
[10:27:07] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 104622 reads in 6.882 CPU sec, 0.955 real sec
[10:27:07] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:27:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4003AA_AS.out\tSM:ESC_NA4003AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 7.403 sec; CPU: 31.519 sec
[samclip] Total SAM records 424377, removed 4852, allowed 727, passed 419525
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 300000 records...
[10:27:08] Wrote 425244 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:08] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:27:08] Using BAM RG (Read Group) ID: ESC_NA4005AA_AS.out
[10:27:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:08] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4000AA_AS.out\tSM:ESC_NA4000AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 7.823 sec; CPU: 32.537 sec
[samclip] Total SAM records 426045, removed 5064, allowed 635, passed 420981
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:09] Wrote 428090 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:09] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:27:09] Using BAM RG (Read Group) ID: ESC_NA3999AA_AS.out
[10:27:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:09] This is snippy 4.4.3
[10:27:09] Written by Torsten Seemann
[10:27:09] Obtained from https://github.com/tseemann/snippy
[10:27:09] Detected operating system: linux
[10:27:09] Enabling bundled linux tools.
[10:27:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:09] Found gzip - /usr/bin/gzip
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:09] Wrote 419186 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:09] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:27:09] Using BAM RG (Read Group) ID: ESC_NA4046AA_AS.out
[10:27:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:10] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
[10:27:10] Treating reference as 'fasta' format.
[10:27:10] Will use 8 CPU cores.
[10:27:10] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta
[10:27:10] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out
[10:27:10] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out
[10:27:10] Creating reference folder: reference
[10:27:10] Extracting FASTA and GFF from reference.
[10:27:10] Wrote 1 sequences to ref.fa
[10:27:10] Wrote 0 features to ref.gff
[10:27:10] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 8
          no. right trimmed                     : 24
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3177
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:27:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:27:10] Running: samtools index snps.bam 2>> snps.log
[10:27:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:11] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:27:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:11] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:27:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 25
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 33

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 33
       total no. variants observed              : 3185
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:27:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:11] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:11] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:27:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:11] Running: samtools index snps.bam 2>> snps.log
[10:27:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:11] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:27:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:12] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:12] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:12] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4005AA_AS.out\tSM:ESC_NA4005AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:27:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::process] read 320002 sequences (80000200 bp)...
[10:27:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4046AA_AS.out\tSM:ESC_NA4046AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:13] Wrote 417532 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:13] Freebayes will process 15 chunks of 353328 bp, 8 chunks at a time.
[10:27:13] Using BAM RG (Read Group) ID: ESC_NA4035AA_AS.out
[10:27:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::process] read 320042 sequences (80000116 bp)...
[10:27:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3999AA_AS.out\tSM:ESC_NA3999AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:27:14] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 320548 sequences (80000280 bp)...
[10:27:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 25
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 35

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 35
       total no. variants observed              : 3167
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:27:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:27:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 99144 sequences (24770656 bp)...
[10:27:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:27:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 24
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 34

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 34
       total no. variants observed              : 3177
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:27:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:27:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:15] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:16] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:16] Marked 202 heterozygous sites with 'n'
[10:27:16] Creating extra output files: BED GFF CSV TXT HTML
[10:27:16] Identified 3177 variants.
[10:27:16] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out
[10:27:16] Result files:
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.aligned.fa
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.bam
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.bam.bai
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.bed
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.consensus.fa
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.consensus.subs.fa
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.csv
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.filt.vcf
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.gff
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.html
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.log
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.raw.vcf
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.subs.vcf
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.tab
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.txt
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.vcf
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.vcf.gz
[10:27:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out/snps.vcf.gz.csi
[10:27:16] Walltime used: 32 seconds
[10:27:16] May the SNPs be with you.
[10:27:16] Done.
[Thu Sep 10 10:27:16 2020]
Finished job 49.
40 of 107 steps (37%) done

[Thu Sep 10 10:27:16 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out
    jobid: 36
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4064AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta
[M::process] read 105242 sequences (26306596 bp)...
[10:27:17] Marked 212 heterozygous sites with 'n'
[10:27:17] Creating extra output files: BED GFF CSV TXT HTML
[10:27:17] Identified 3185 variants.
[10:27:17] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out
[10:27:17] Result files:
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.aligned.fa
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.bam
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.bam.bai
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.bed
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.consensus.fa
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.consensus.subs.fa
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.csv
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.filt.vcf
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.gff
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.html
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.log
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.raw.vcf
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.subs.vcf
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.tab
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.txt
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.vcf
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.vcf.gz
[10:27:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out/snps.vcf.gz.csi
[10:27:17] Walltime used: 36 seconds
[10:27:17] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:27:17] Done.
[Thu Sep 10 10:27:17 2020]
Finished job 27.
41 of 107 steps (38%) done

[Thu Sep 10 10:27:17 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out
    jobid: 12
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_BA8511AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 107542 sequences (26830384 bp)...
[10:27:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:18] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4035AA_AS.out\tSM:ESC_NA4035AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:27:18] This is snippy 4.4.3
[10:27:18] Written by Torsten Seemann
[10:27:18] Obtained from https://github.com/tseemann/snippy
[10:27:18] Detected operating system: linux
[10:27:18] Enabling bundled linux tools.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:27:18] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:18] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:18] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:18] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:18] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:18] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:18] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:18] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:18] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:18] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:18] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:18] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:18] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:18] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:18] Found gzip - /usr/bin/gzip
[10:27:18] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:18] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:18] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:18] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:18] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:18] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 320042 reads in 23.804 CPU sec, 4.714 real sec
[10:27:18] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320056 sequences (80000098 bp)...
[10:27:18] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:18] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:18] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:18] Treating reference as 'fasta' format.
[10:27:18] Will use 8 CPU cores.
[10:27:18] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta
[10:27:18] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out
[10:27:18] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out
[10:27:18] Creating reference folder: reference
[10:27:18] Extracting FASTA and GFF from reference.
[10:27:18] Wrote 1 sequences to ref.fa
[10:27:18] Wrote 0 features to ref.gff
[10:27:18] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4064AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[10:27:19] This is snippy 4.4.3
[10:27:19] Written by Torsten Seemann
[10:27:19] Obtained from https://github.com/tseemann/snippy
[10:27:19] Detected operating system: linux
[10:27:19] Enabling bundled linux tools.
[10:27:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:19] Found gzip - /usr/bin/gzip
[10:27:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::mem_process_seqs] Processed 99144 reads in 7.247 CPU sec, 0.952 real sec
[10:27:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[10:27:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:19] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:19] Treating reference as 'fasta' format.
[10:27:19] Will use 8 CPU cores.
[10:27:19] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta
[10:27:19] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out
[10:27:19] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out
[10:27:19] Creating reference folder: reference
[10:27:19] Extracting FASTA and GFF from reference.
[10:27:19] Wrote 1 sequences to ref.fa
[10:27:19] Wrote 0 features to ref.gff
[10:27:19] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_BA8511AA_AS.fasta into pseudo-reads
[M::process] read 97476 sequences (24363148 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 320002 reads in 23.457 CPU sec, 7.530 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4046AA_AS.out\tSM:ESC_NA4046AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 7.423 sec; CPU: 31.880 sec
[samclip] Total SAM records 420626, removed 4917, allowed 658, passed 415709
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:21] Marked 213 heterozygous sites with 'n'
[10:27:21] Creating extra output files: BED GFF CSV TXT HTML
[10:27:21] Identified 3167 variants.
[10:27:21] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out
[10:27:21] Result files:
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.aligned.fa
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.bam
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.bam.bai
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.bed
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.consensus.fa
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.consensus.subs.fa
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.csv
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.filt.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.gff
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.html
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.log
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.raw.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.subs.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.tab
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.txt
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.vcf.gz
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out/snps.vcf.gz.csi
[10:27:21] Walltime used: 29 seconds
[10:27:21] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:27:21] Done.
[M::mem_process_seqs] Processed 320548 reads in 23.614 CPU sec, 6.444 real sec
[Thu Sep 10 10:27:21 2020]
Finished job 61.
42 of 107 steps (39%) done

[Thu Sep 10 10:27:21 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out
    jobid: 14
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_VA0598AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta
[10:27:21] Marked 207 heterozygous sites with 'n'
[10:27:21] Creating extra output files: BED GFF CSV TXT HTML
[samclip] Processed 100000 records...
[10:27:21] Identified 3177 variants.
[10:27:21] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out
[10:27:21] Result files:
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.aligned.fa
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.bam
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.bam.bai
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.bed
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.consensus.fa
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.consensus.subs.fa
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.csv
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.filt.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.gff
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.html
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.log
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.raw.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.subs.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.tab
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.txt
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.vcf
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.vcf.gz
[10:27:21] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out/snps.vcf.gz.csi
[10:27:21] Walltime used: 29 seconds
[10:27:21] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:27:21] Done.
[M::mem_process_seqs] Processed 105242 reads in 9.158 CPU sec, 1.191 real sec
[Thu Sep 10 10:27:21 2020]
Finished job 3.
43 of 107 steps (40%) done

[Thu Sep 10 10:27:21 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out
    jobid: 86
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_HA6332AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[10:27:22] Wrote 453578 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:22] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:22] Using BAM RG (Read Group) ID: ESC_NA4064AA_AS.out
[10:27:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:22] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 107542 reads in 8.571 CPU sec, 1.201 real sec
[samclip] Processed 100000 records...
[10:27:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:22] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4064AA_AS.out\tSM:ESC_NA4064AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320142 sequences (80000350 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 400000 records...
[10:27:22] This is snippy 4.4.3
[10:27:22] Written by Torsten Seemann
[10:27:22] Obtained from https://github.com/tseemann/snippy
[10:27:22] Detected operating system: linux
[10:27:22] Enabling bundled linux tools.
[10:27:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[samclip] Processed 300000 records...
[M::process] read 133436 sequences (33317366 bp)...
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 426378, removed 4872, allowed 813, passed 421506
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4005AA_AS.out\tSM:ESC_NA4005AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Header contained 3 lines
[samclip] Done.

[main] Real time: 10.366 sec; CPU: 33.393 sec
[10:27:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:23] Found gzip - /usr/bin/gzip
[10:27:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:23] Wrote 447112 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:23] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:23] Using BAM RG (Read Group) ID: ESC_BA8511AA_AS.out
[10:27:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:23] This is snippy 4.4.3
[10:27:23] Written by Torsten Seemann
[10:27:23] Obtained from https://github.com/tseemann/snippy
[10:27:23] Detected operating system: linux
[10:27:23] Enabling bundled linux tools.
[10:27:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:23] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:23] Running: samtools index snps.bam 2>> snps.log
[10:27:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[samclip] Processed 400000 records...
[10:27:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:23] Found gzip - /usr/bin/gzip
[10:27:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:23] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:23] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:23] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:23] Running: bwa mem  -Y -M -R '@RG\tID:ESC_BA8511AA_AS.out\tSM:ESC_BA8511AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3999AA_AS.out\tSM:ESC_NA3999AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 9.609 sec; CPU: 33.025 sec
[samclip] Total SAM records 429310, removed 4948, allowed 532, passed 424362
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:23] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:27:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:23] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:23] Treating reference as 'fasta' format.
[10:27:23] Will use 8 CPU cores.
[10:27:23] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta
[10:27:23] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out
[10:27:23] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out
[10:27:23] Creating reference folder: reference
[10:27:23] Extracting FASTA and GFF from reference.
[10:27:23] Wrote 1 sequences to ref.fa
[10:27:23] Wrote 0 features to ref.gff
[10:27:23] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_VA0598AA_AS.fasta into pseudo-reads
[10:27:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:23] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:23] Treating reference as 'fasta' format.
[10:27:23] Will use 8 CPU cores.
[10:27:23] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta
[10:27:23] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out
[10:27:23] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out
[10:27:23] Creating reference folder: reference
[10:27:23] Extracting FASTA and GFF from reference.
[10:27:23] Wrote 1 sequences to ref.fa
[10:27:23] Wrote 0 features to ref.gff
[10:27:23] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6332AA_AS.fasta into pseudo-reads
[M::process] read 320062 sequences (80000166 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320056 reads in 24.017 CPU sec, 6.693 real sec
[10:27:25] Running: samtools index snps.bam 2>> snps.log
[10:27:26] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:27] Wrote 437900 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:27] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:27] Using BAM RG (Read Group) ID: ESC_VA0598AA_AS.out
[10:27:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:27] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:27] Wrote 443754 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:27] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:27] Using BAM RG (Read Group) ID: ESC_HA6332AA_AS.out
[10:27:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:28] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:28] Running: samtools index snps.bam 2>> snps.log
[10:27:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:27:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:27:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:28] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:27:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:28] Running: bwa mem  -Y -M -R '@RG\tID:ESC_VA0598AA_AS.out\tSM:ESC_VA0598AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:27:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:28] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6332AA_AS.out\tSM:ESC_HA6332AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 97476 reads in 7.367 CPU sec, 3.070 real sec
[M::bwa_idx_load_from_disk] read 0 ALT contigs

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 24
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 34

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 34
       total no. variants observed              : 3181
       total no. reference observed             : 0

Time elapsed: 0.05s

[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[M::process] read 320068 sequences (80000032 bp)...
[M::process] read 320014 sequences (80000098 bp)...
[M::process] read 123686 sequences (30918376 bp)...
[10:27:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 200000 records...
[10:27:30] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[10:27:30] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:31] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:27:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 28
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 36

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 36
       total no. variants observed              : 3130
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:27:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 400000 records...
[10:27:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4035AA_AS.out\tSM:ESC_NA4035AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.305 sec; CPU: 32.270 sec
[samclip] Total SAM records 418290, removed 3459, allowed 609, passed 414831
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 117886 sequences (29471500 bp)...
[10:27:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:32] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320142 reads in 49.150 CPU sec, 9.727 real sec
[10:27:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 22
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 3091
       total no. reference observed             : 0

Time elapsed: 0.05s

[10:27:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[10:27:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::mem_process_seqs] Processed 133436 reads in 14.027 CPU sec, 2.547 real sec
[10:27:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[samclip] Processed 200000 records...
[10:27:35] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:35] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[M::process] read 127050 sequences (31755156 bp)...
[10:27:36] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[10:27:36] Running: fasta_generate_regions.py reference/ref.fa.fai 353328 > reference/ref.txt 2>> snps.log
[10:27:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4064AA_AS.out\tSM:ESC_NA4064AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.129 sec; CPU: 63.962 sec
[samclip] Total SAM records 453898, removed 5388, allowed 406, passed 448510
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:37] Marked 132 heterozygous sites with 'n'
[10:27:37] Creating extra output files: BED GFF CSV TXT HTML
[10:27:37] Identified 3181 variants.
[10:27:37] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out
[10:27:37] Result files:
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.aligned.fa
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.bam
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.bam.bai
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.bed
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.consensus.fa
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.consensus.subs.fa
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.csv
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.filt.vcf
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.gff
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.html
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.log
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.raw.vcf
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.subs.vcf
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.tab
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.txt
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.vcf
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.vcf.gz
[10:27:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out/snps.vcf.gz.csi
[10:27:37] Walltime used: 32 seconds
[10:27:37] May the SNPs be with you.
[10:27:37] Done.
[Thu Sep 10 10:27:37 2020]
Finished job 33.
44 of 107 steps (41%) done

[Thu Sep 10 10:27:37 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out
    jobid: 18
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_SA8312AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320068 reads in 49.305 CPU sec, 9.642 real sec
[M::mem_process_seqs] Processed 320014 reads in 40.010 CPU sec, 9.789 real sec
[10:27:39] Marked 200 heterozygous sites with 'n'
[10:27:39] This is snippy 4.4.3
[10:27:39] Written by Torsten Seemann
[10:27:39] Obtained from https://github.com/tseemann/snippy
[10:27:39] Detected operating system: linux
[10:27:39] Enabling bundled linux tools.
[10:27:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:39] Creating extra output files: BED GFF CSV TXT HTML
[10:27:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:39] Identified 3130 variants.
[10:27:39] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out
[10:27:39] Result files:
[10:27:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.aligned.fa
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.bam
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.bam.bai
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.bed
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.consensus.fa
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.consensus.subs.fa
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.csv
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.filt.vcf
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.gff
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.html
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.log
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.raw.vcf
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.subs.vcf
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.tab
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.txt
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.vcf
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.vcf.gz
[10:27:39] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out/snps.vcf.gz.csi
[10:27:39] Walltime used: 36 seconds
[10:27:39] Wishing you a life free of homopolymer errors.
[10:27:39] Done.
[Thu Sep 10 10:27:39 2020]
Finished job 79.
45 of 107 steps (42%) done

[Thu Sep 10 10:27:39 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out
    jobid: 56
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_HB8007AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta
[10:27:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[samclip] Processed 100000 records...
[10:27:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:39] Running: samtools index snps.bam 2>> snps.log
[10:27:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:39] Found gzip - /usr/bin/gzip
[10:27:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 100000 records...
[10:27:39] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:27:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:40] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:40] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:40] Treating reference as 'fasta' format.
[10:27:40] Will use 8 CPU cores.
[10:27:40] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta
[10:27:40] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out
[10:27:40] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out
[10:27:40] Creating reference folder: reference
[10:27:40] Extracting FASTA and GFF from reference.
[10:27:40] Wrote 1 sequences to ref.fa
[10:27:40] Wrote 0 features to ref.gff
[10:27:40] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8312AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:27:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:27:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 17
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 1002
       total no. reference observed             : 0

Time elapsed: 0.01s

[10:27:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log

stats: biallelic
          no. left trimmed                      : 6
          no. right trimmed                     : 18
          no. left and right trimmed            : 4
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 3102
       total no. reference observed             : 0

Time elapsed: 0.05s

[samclip] Processed 200000 records...
[10:27:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 117886 reads in 12.451 CPU sec, 2.112 real sec
[10:27:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:41] This is snippy 4.4.3
[10:27:41] Written by Torsten Seemann
[10:27:41] Obtained from https://github.com/tseemann/snippy
[10:27:41] Detected operating system: linux
[10:27:41] Enabling bundled linux tools.
[10:27:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[M::mem_process_seqs] Processed 123686 reads in 15.250 CPU sec, 2.404 real sec
[samclip] Processed 300000 records...
[10:27:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:41] Found gzip - /usr/bin/gzip
[10:27:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:41] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[10:27:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 400000 records...
[10:27:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:41] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:41] Treating reference as 'fasta' format.
[10:27:41] Will use 8 CPU cores.
[10:27:41] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta
[10:27:41] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out
[10:27:41] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out
[10:27:41] Creating reference folder: reference
[10:27:41] Extracting FASTA and GFF from reference.
[10:27:41] Wrote 1 sequences to ref.fa
[10:27:41] Wrote 0 features to ref.gff
[10:27:41] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HB8007AA_AS.fasta into pseudo-reads
[10:27:41] Marked 180 heterozygous sites with 'n'
[10:27:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:27:41] Creating extra output files: BED GFF CSV TXT HTML
[10:27:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6332AA_AS.out\tSM:ESC_HA6332AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.873 sec; CPU: 65.106 sec
[samclip] Total SAM records 444071, removed 3263, allowed 321, passed 440808
[samclip] Header contained 3 lines
[samclip] Done.
[10:27:41] Identified 3091 variants.
[10:27:41] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out
[10:27:41] Result files:
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.aligned.fa
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.bam
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.bam.bai
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.bed
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.consensus.fa
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.consensus.subs.fa
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.csv
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.filt.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.gff
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.html
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.log
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.raw.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.subs.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.tab
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.txt
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.vcf.gz
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out/snps.vcf.gz.csi
[10:27:41] Walltime used: 36 seconds
[10:27:41] Wishing you a life free of homopolymer errors.
[10:27:41] Done.
[10:27:41] Marked 396 heterozygous sites with 'n'
[10:27:41] Creating extra output files: BED GFF CSV TXT HTML
[10:27:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[Thu Sep 10 10:27:41 2020]
Finished job 69.
46 of 107 steps (43%) done

[Thu Sep 10 10:27:41 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out
    jobid: 46
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_HA6420AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta
[10:27:41] Identified 1002 variants.
[10:27:41] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out
[10:27:41] Result files:
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.aligned.fa
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.bam
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.bam.bai
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.bed
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.consensus.fa
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.consensus.subs.fa
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.csv
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.filt.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.gff
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.html
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.log
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.raw.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.subs.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.tab
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.txt
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.vcf
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.vcf.gz
[10:27:41] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out/snps.vcf.gz.csi
[10:27:41] Walltime used: 23 seconds
[10:27:41] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:27:41] Done.
[10:27:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[Thu Sep 10 10:27:41 2020]
Finished job 36.
47 of 107 steps (44%) done

[Thu Sep 10 10:27:41 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out
    jobid: 84
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_SA8273AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_VA0598AA_AS.out\tSM:ESC_VA0598AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.071 sec; CPU: 53.115 sec
[samclip] Total SAM records 438093, removed 1679, allowed 147, passed 436414
[samclip] Header contained 3 lines
[samclip] Done.
[10:27:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:41] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320062 reads in 39.694 CPU sec, 17.594 real sec
[10:27:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[10:27:42] This is snippy 4.4.3
[10:27:42] Written by Torsten Seemann
[10:27:42] Obtained from https://github.com/tseemann/snippy
[10:27:42] Detected operating system: linux
[10:27:42] Enabling bundled linux tools.
[10:27:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:42] Found gzip - /usr/bin/gzip
[10:27:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:42] This is snippy 4.4.3
[10:27:42] Written by Torsten Seemann
[10:27:42] Obtained from https://github.com/tseemann/snippy
[10:27:42] Detected operating system: linux
[10:27:42] Enabling bundled linux tools.
[10:27:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:42] Found gzip - /usr/bin/gzip
[10:27:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:42] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:42] Treating reference as 'fasta' format.
[10:27:42] Will use 8 CPU cores.
[10:27:42] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta
[10:27:42] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out
[10:27:42] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out
[10:27:42] Creating reference folder: reference
[10:27:42] Extracting FASTA and GFF from reference.
[10:27:42] Wrote 1 sequences to ref.fa
[10:27:42] Wrote 0 features to ref.gff
[10:27:42] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6420AA_AS.fasta into pseudo-reads
[10:27:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:42] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:42] Treating reference as 'fasta' format.
[10:27:42] Will use 8 CPU cores.
[10:27:42] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta
[10:27:42] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out
[10:27:42] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out
[10:27:42] Creating reference folder: reference
[10:27:42] Extracting FASTA and GFF from reference.
[10:27:42] Wrote 1 sequences to ref.fa
[10:27:42] Wrote 0 features to ref.gff
[10:27:42] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8273AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 127050 reads in 14.941 CPU sec, 1.834 real sec
[10:27:43] Running: samtools index snps.bam 2>> snps.log
[10:27:43] Wrote 440276 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:43] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:43] Using BAM RG (Read Group) ID: ESC_SA8312AA_AS.out
[10:27:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:43] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:43] Running: samtools index snps.bam 2>> snps.log
[10:27:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:27:43] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8312AA_AS.out\tSM:ESC_SA8312AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:27:43] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:43] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:43] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:27:43] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_BA8511AA_AS.out\tSM:ESC_BA8511AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 20.115 sec; CPU: 55.134 sec
[samclip] Total SAM records 447264, removed 1972, allowed 111, passed 445292
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320326 sequences (80000378 bp)...
[10:27:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:27:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 16
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 1015
       total no. reference observed             : 0

Time elapsed: 0.01s

[10:27:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 119950 sequences (29987500 bp)...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 319
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:27:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:27:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:27:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:44] Wrote 440510 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:44] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:44] Using BAM RG (Read Group) ID: ESC_HB8007AA_AS.out
[10:27:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:44] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:44] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:44] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:44] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HB8007AA_AS.out\tSM:ESC_HB8007AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:45] Marked 135 heterozygous sites with 'n'
[10:27:45] Creating extra output files: BED GFF CSV TXT HTML
[10:27:45] Marked 466 heterozygous sites with 'n'
[10:27:45] Identified 1015 variants.
[10:27:45] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out
[10:27:45] Result files:
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.aligned.fa
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.bam
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.bam.bai
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.bed
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.consensus.fa
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.consensus.subs.fa
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.csv
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.filt.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.gff
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.html
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.log
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.raw.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.subs.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.tab
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.txt
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.vcf.gz
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out/snps.vcf.gz.csi
[10:27:45] Walltime used: 22 seconds
[10:27:45] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:27:45] Done.
[10:27:45] Creating extra output files: BED GFF CSV TXT HTML
[10:27:45] Identified 319 variants.
[10:27:45] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out
[10:27:45] Result files:
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.aligned.fa
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.bam
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.bam.bai
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.bed
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.consensus.fa
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.consensus.subs.fa
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.csv
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.filt.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.gff
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.html
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.log
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.raw.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.subs.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.tab
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.txt
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.vcf
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.vcf.gz
[10:27:45] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out/snps.vcf.gz.csi
[10:27:45] Walltime used: 23 seconds
[10:27:45] Wishing you a life free of homopolymer errors.
[10:27:45] Done.
[Thu Sep 10 10:27:45 2020]
Finished job 86.
48 of 107 steps (45%) done

[Thu Sep 10 10:27:45 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out
    jobid: 82
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_GB6943AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta
[Thu Sep 10 10:27:45 2020]
Finished job 14.
49 of 107 steps (46%) done

[Thu Sep 10 10:27:45 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out
    jobid: 58
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4052AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta
[M::process] read 320018 sequences (80000164 bp)...
[M::process] read 120492 sequences (30123000 bp)...
[10:27:46] Running: samtools index snps.bam 2>> snps.log
[10:27:46] Wrote 440980 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:46] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:46] Using BAM RG (Read Group) ID: ESC_HA6420AA_AS.out
[10:27:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:46] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:27:46] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:27:46] Marked 183 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:27:46] Wrote 435872 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:46] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:46] Using BAM RG (Read Group) ID: ESC_SA8273AA_AS.out
[10:27:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:46] Creating extra output files: BED GFF CSV TXT HTML
[10:27:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:46] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:46] Identified 3102 variants.
[10:27:46] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out
[10:27:46] Result files:
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.aligned.fa
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.bam
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.bam.bai
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.bed
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.consensus.fa
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.consensus.subs.fa
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.csv
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.filt.vcf
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.gff
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.html
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.log
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.raw.vcf
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.subs.vcf
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.tab
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.txt
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.vcf
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.vcf.gz
[10:27:46] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out/snps.vcf.gz.csi
[10:27:46] Walltime used: 37 seconds
[10:27:46] Questionable SNP? Try the --report option to see the alignments.
[10:27:46] Done.
[10:27:46] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6420AA_AS.out\tSM:ESC_HA6420AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[Thu Sep 10 10:27:46 2020]
Finished job 41.
50 of 107 steps (47%) done
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai

[Thu Sep 10 10:27:46 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out
    jobid: 52
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_HA6342AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta
[10:27:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:46] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8273AA_AS.out\tSM:ESC_SA8273AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:27:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 313
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:27:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:27:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320112 sequences (80000494 bp)...
[10:27:47] This is snippy 4.4.3
[10:27:47] Written by Torsten Seemann
[10:27:47] Obtained from https://github.com/tseemann/snippy
[10:27:47] Detected operating system: linux
[10:27:47] Enabling bundled linux tools.
[10:27:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:47] This is snippy 4.4.3
[10:27:47] Written by Torsten Seemann
[10:27:47] Obtained from https://github.com/tseemann/snippy
[10:27:47] Detected operating system: linux
[10:27:47] Enabling bundled linux tools.
[10:27:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:47] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:47] Found gzip - /usr/bin/gzip
[10:27:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:47] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:27:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:47] Found gzip - /usr/bin/gzip
[10:27:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:47] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:47] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 320052 sequences (80000174 bp)...
[10:27:47] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:27:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:27:47] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:27:47] Running: rm -f fake_reads\.fq 2>> snps.log
[10:27:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:47] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:27:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:47] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:47] Treating reference as 'fasta' format.
[10:27:47] Will use 8 CPU cores.
[10:27:47] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta
[10:27:47] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out
[10:27:47] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out
[10:27:47] Creating reference folder: reference
[10:27:47] Extracting FASTA and GFF from reference.
[10:27:47] Wrote 1 sequences to ref.fa
[10:27:47] Wrote 0 features to ref.gff
[10:27:47] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GB6943AA_AS.fasta into pseudo-reads
[10:27:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:27:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:48] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:48] Treating reference as 'fasta' format.
[10:27:48] Will use 8 CPU cores.
[10:27:48] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta
[10:27:48] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out
[10:27:48] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out
[10:27:48] Creating reference folder: reference
[10:27:48] Extracting FASTA and GFF from reference.
[10:27:48] Wrote 1 sequences to ref.fa
[10:27:48] Wrote 0 features to ref.gff
[10:27:48] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4052AA_AS.fasta into pseudo-reads
[10:27:48] Marked 197 heterozygous sites with 'n'
[10:27:48] Creating extra output files: BED GFF CSV TXT HTML
[10:27:48] Identified 313 variants.
[10:27:48] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out
[10:27:48] Result files:
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.aligned.fa
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.bam
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.bam.bai
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.bed
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.consensus.fa
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.consensus.subs.fa
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.csv
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.filt.vcf
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.gff
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.html
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.log
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.raw.vcf
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.subs.vcf
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.tab
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.txt
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.vcf
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.vcf.gz
[10:27:48] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out/snps.vcf.gz.csi
[10:27:48] Walltime used: 29 seconds
[10:27:48] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:27:48] Done.
[Thu Sep 10 10:27:48 2020]
Finished job 12.
51 of 107 steps (48%) done

[Thu Sep 10 10:27:48 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out
    jobid: 6
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_HA6418AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta
[10:27:49] This is snippy 4.4.3
[10:27:49] Written by Torsten Seemann
[10:27:49] Obtained from https://github.com/tseemann/snippy
[10:27:49] Detected operating system: linux
[10:27:49] Enabling bundled linux tools.
[10:27:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:49] Found gzip - /usr/bin/gzip
[10:27:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:27:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:27:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:27:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:27:49] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:27:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:49] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:49] Treating reference as 'fasta' format.
[10:27:49] Will use 8 CPU cores.
[10:27:49] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta
[10:27:49] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out
[10:27:49] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out
[10:27:49] Creating reference folder: reference
[10:27:49] Extracting FASTA and GFF from reference.
[10:27:49] Wrote 1 sequences to ref.fa
[10:27:49] Wrote 0 features to ref.gff
[10:27:49] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6342AA_AS.fasta into pseudo-reads
[M::process] read 115820 sequences (28955000 bp)...
[M::process] read 120868 sequences (30194564 bp)...
[M::mem_process_seqs] Processed 320326 reads in 40.842 CPU sec, 7.458 real sec
[10:27:51] This is snippy 4.4.3
[10:27:51] Written by Torsten Seemann
[10:27:51] Obtained from https://github.com/tseemann/snippy
[10:27:51] Detected operating system: linux
[10:27:51] Enabling bundled linux tools.
[10:27:51] Wrote 433864 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:51] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:51] Using BAM RG (Read Group) ID: ESC_GB6943AA_AS.out
[10:27:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:27:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:27:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:27:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:27:51] Wrote 445684 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:51] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:51] Using BAM RG (Read Group) ID: ESC_NA4052AA_AS.out
[10:27:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:27:51] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:51] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:27:52] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:27:52] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:27:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:52] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:27:52] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:27:52] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:27:52] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:27:52] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:27:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:27:52] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:27:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:52] Found gzip - /usr/bin/gzip
[10:27:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:52] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:27:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:52] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:27:52] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[samclip] Processed 100000 records...
[10:27:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:52] Running: bwa mem  -Y -M -R '@RG\tID:ESC_GB6943AA_AS.out\tSM:ESC_GB6943AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:27:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::mem_process_seqs] Processed 119950 reads in 13.662 CPU sec, 1.830 real sec
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:27:53] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4052AA_AS.out\tSM:ESC_NA4052AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:27:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 200000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:27:53] Wrote 439862 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:53] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:53] Using BAM RG (Read Group) ID: ESC_HA6342AA_AS.out
[10:27:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:53] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:27:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:27:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:27:53] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6342AA_AS.out\tSM:ESC_HA6342AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 320070 sequences (80000140 bp)...
[10:27:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:27:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:27:53] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:27:53] Treating reference as 'fasta' format.
[10:27:53] Will use 8 CPU cores.
[10:27:53] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta
[10:27:53] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out
[10:27:53] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out
[10:27:53] Creating reference folder: reference
[10:27:53] Extracting FASTA and GFF from reference.
[10:27:53] Wrote 1 sequences to ref.fa
[10:27:53] Wrote 0 features to ref.gff
[10:27:53] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6418AA_AS.fasta into pseudo-reads
[M::process] read 320802 sequences (80000490 bp)...
[M::process] read 113794 sequences (28448500 bp)...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 320018 reads in 47.306 CPU sec, 8.891 real sec
[M::process] read 320082 sequences (80000390 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8312AA_AS.out\tSM:ESC_SA8312AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.793 sec; CPU: 55.232 sec
[samclip] Total SAM records 440750, removed 3560, allowed 192, passed 437190
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320112 reads in 32.271 CPU sec, 8.565 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 120492 reads in 12.494 CPU sec, 2.048 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320052 reads in 36.502 CPU sec, 9.134 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[10:27:57] Wrote 437538 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:27:57] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:27:57] Using BAM RG (Read Group) ID: ESC_HA6418AA_AS.out
[10:27:57] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:27:57] Running: bwa index reference/ref.fa 2>> snps.log
[10:27:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 120868 reads in 17.312 CPU sec, 2.575 real sec
[10:27:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:27:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:27:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] Processed 200000 records...
[10:27:58] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6418AA_AS.out\tSM:ESC_HA6418AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HB8007AA_AS.out\tSM:ESC_HB8007AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.480 sec; CPU: 60.445 sec
[samclip] Total SAM records 440714, removed 2109, allowed 216, passed 438605
[samclip] Header contained 3 lines
[samclip] Done.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[10:27:58] Running: samtools index snps.bam 2>> snps.log
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[10:27:58] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 115820 reads in 13.378 CPU sec, 2.152 real sec
[10:27:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320194 sequences (80000246 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6420AA_AS.out\tSM:ESC_HA6420AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.565 sec; CPU: 50.358 sec
[samclip] Total SAM records 441174, removed 1963, allowed 196, passed 439211
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 119780 sequences (29941832 bp)...
[samclip] Processed 400000 records...
[10:27:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 17
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 994
       total no. reference observed             : 0

Time elapsed: 0.01s

[10:27:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 117344 sequences (29332360 bp)...
[10:27:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8273AA_AS.out\tSM:ESC_SA8273AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 436091, removed 3477, allowed 116, passed 432614

[main] Real time: 12.802 sec; CPU: 50.579 sec
[samclip] Header contained 3 lines
[samclip] Done.
[10:27:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:27:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:27:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:27:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:27:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:00] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:00] Marked 138 heterozygous sites with 'n'
[10:28:00] Creating extra output files: BED GFF CSV TXT HTML
[10:28:00] Identified 994 variants.
[10:28:00] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out
[10:28:00] Result files:
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.aligned.fa
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.bam
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.bam.bai
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.bed
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.consensus.fa
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.consensus.subs.fa
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.csv
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.filt.vcf
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.gff
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.html
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.log
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.raw.vcf
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.subs.vcf
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.tab
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.txt
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.vcf
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.vcf.gz
[10:28:00] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out/snps.vcf.gz.csi
[10:28:00] Walltime used: 21 seconds
[10:28:00] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:28:00] Done.
[Thu Sep 10 10:28:00 2020]
Finished job 18.
52 of 107 steps (49%) done

[Thu Sep 10 10:28:00 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out
    jobid: 20
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_SA8291AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta
[M::mem_process_seqs] Processed 320070 reads in 38.084 CPU sec, 7.227 real sec
[10:28:01] Running: samtools index snps.bam 2>> snps.log
[10:28:01] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:01] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:02] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[10:28:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:28:02] This is snippy 4.4.3
[10:28:02] Written by Torsten Seemann
[10:28:02] Obtained from https://github.com/tseemann/snippy
[10:28:02] Detected operating system: linux
[10:28:02] Enabling bundled linux tools.
[10:28:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 119
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[M::mem_process_seqs] Processed 113794 reads in 12.465 CPU sec, 2.051 real sec
[10:28:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:03] Found gzip - /usr/bin/gzip
[10:28:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:28:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:28:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 323
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[M::process] read 124882 sequences (31175666 bp)...
[10:28:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:03] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[10:28:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:03] Running: samtools index snps.bam 2>> snps.log
[10:28:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:03] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:03] Treating reference as 'fasta' format.
[10:28:03] Will use 8 CPU cores.
[10:28:03] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta
[10:28:03] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out
[10:28:03] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out
[10:28:03] Creating reference folder: reference
[10:28:03] Extracting FASTA and GFF from reference.
[10:28:03] Wrote 1 sequences to ref.fa
[10:28:03] Wrote 0 features to ref.gff
[10:28:03] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8291AA_AS.fasta into pseudo-reads
[10:28:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:03] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:03] Marked 1228 heterozygous sites with 'n'
[10:28:03] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:03] Creating extra output files: BED GFF CSV TXT HTML
[10:28:03] Identified 119 variants.
[10:28:03] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out
[10:28:03] Result files:
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.aligned.fa
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.bam
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.bam.bai
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.bed
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.consensus.fa
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.consensus.subs.fa
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.csv
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.filt.vcf
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.gff
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.html
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.log
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.raw.vcf
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.subs.vcf
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.tab
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.txt
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.vcf
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.vcf.gz
[10:28:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out/snps.vcf.gz.csi
[10:28:03] Walltime used: 22 seconds
[10:28:03] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:28:03] Done.
[Thu Sep 10 10:28:03 2020]
Finished job 56.
53 of 107 steps (50%) done

[Thu Sep 10 10:28:03 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out
    jobid: 64
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_SA8296AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta
[10:28:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 400000 records...
[10:28:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_GB6943AA_AS.out\tSM:ESC_GB6943AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.059 sec; CPU: 51.313 sec
[samclip] Total SAM records 434028, removed 1424, allowed 99, passed 432604
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:04] Marked 407 heterozygous sites with 'n'
[10:28:04] Creating extra output files: BED GFF CSV TXT HTML
[10:28:04] Identified 323 variants.
[10:28:04] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out
[10:28:04] Result files:
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.aligned.fa
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.bam
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.bam.bai
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.bed
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.consensus.fa
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.consensus.subs.fa
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.csv
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.filt.vcf
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.gff
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.html
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.log
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.raw.vcf
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.subs.vcf
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.tab
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.txt
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.vcf
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.vcf.gz
[10:28:04] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out/snps.vcf.gz.csi
[10:28:04] Walltime used: 22 seconds
[10:28:04] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:28:04] Done.
[Thu Sep 10 10:28:04 2020]
Finished job 46.
54 of 107 steps (50%) done

[Thu Sep 10 10:28:04 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out
    jobid: 8
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_SA8250AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta
[10:28:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 30
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320082 reads in 38.445 CPU sec, 10.370 real sec
[10:28:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:05] Running: rm -f fake_reads\.fq 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:05] Marked 580 heterozygous sites with 'n'
[10:28:05] Creating extra output files: BED GFF CSV TXT HTML
[10:28:05] Identified 30 variants.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:05] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out
[10:28:05] Result files:
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.aligned.fa
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.bam
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.bam.bai
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.bed
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.consensus.fa
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.consensus.subs.fa
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.csv
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.filt.vcf
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.gff
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.html
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.log
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.raw.vcf
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.subs.vcf
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.tab
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.txt
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.vcf
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.vcf.gz
[10:28:05] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out/snps.vcf.gz.csi
[10:28:05] Walltime used: 23 seconds
[10:28:05] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:28:05] Done.
[Thu Sep 10 10:28:05 2020]
Finished job 84.
55 of 107 steps (51%) done

[Thu Sep 10 10:28:05 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out
    jobid: 78
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4053AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta
[10:28:05] This is snippy 4.4.3
[10:28:05] Written by Torsten Seemann
[10:28:05] Obtained from https://github.com/tseemann/snippy
[10:28:05] Detected operating system: linux
[10:28:05] Enabling bundled linux tools.
[10:28:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:05] This is snippy 4.4.3
[10:28:05] Written by Torsten Seemann
[10:28:05] Obtained from https://github.com/tseemann/snippy
[10:28:05] Detected operating system: linux
[10:28:05] Enabling bundled linux tools.
[10:28:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[samclip] Processed 200000 records...
[10:28:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:05] Found gzip - /usr/bin/gzip
[10:28:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:06] Found gzip - /usr/bin/gzip
[10:28:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 119780 reads in 13.111 CPU sec, 1.628 real sec
[10:28:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320194 reads in 36.215 CPU sec, 7.423 real sec
[10:28:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[10:28:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:06] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:06] Treating reference as 'fasta' format.
[10:28:06] Will use 8 CPU cores.
[10:28:06] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta
[10:28:06] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out
[10:28:06] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out
[10:28:06] Creating reference folder: reference
[10:28:06] Extracting FASTA and GFF from reference.
[10:28:06] Wrote 1 sequences to ref.fa
[10:28:06] Wrote 0 features to ref.gff
[10:28:06] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8296AA_AS.fasta into pseudo-reads
[10:28:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:06] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:06] Treating reference as 'fasta' format.
[10:28:06] Will use 8 CPU cores.
[10:28:06] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta
[10:28:06] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out
[10:28:06] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out
[10:28:06] Creating reference folder: reference
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:06] Extracting FASTA and GFF from reference.
[10:28:06] Running: samtools index snps.bam 2>> snps.log
[10:28:06] Wrote 1 sequences to ref.fa
[10:28:06] Wrote 0 features to ref.gff
[10:28:06] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_SA8250AA_AS.fasta into pseudo-reads
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6342AA_AS.out\tSM:ESC_HA6342AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.058 sec; CPU: 52.194 sec
[samclip] Total SAM records 440019, removed 2473, allowed 162, passed 437546
[samclip] Header contained 3 lines
[samclip] Done.
[10:28:06] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[10:28:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:07] Wrote 433918 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:07] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:07] Using BAM RG (Read Group) ID: ESC_SA8291AA_AS.out
[10:28:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:07] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:07] This is snippy 4.4.3
[10:28:07] Written by Torsten Seemann
[10:28:07] Obtained from https://github.com/tseemann/snippy
[10:28:07] Detected operating system: linux
[10:28:07] Enabling bundled linux tools.
[10:28:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:07] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8291AA_AS.out\tSM:ESC_SA8291AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:28:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:07] Found gzip - /usr/bin/gzip
[10:28:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:07] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 300000 records...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 307
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:07] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:07] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:07] Treating reference as 'fasta' format.
[10:28:07] Will use 8 CPU cores.
[10:28:07] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta
[10:28:07] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out
[10:28:07] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out
[10:28:07] Creating reference folder: reference
[10:28:07] Extracting FASTA and GFF from reference.
[10:28:07] Wrote 1 sequences to ref.fa
[10:28:07] Wrote 0 features to ref.gff
[10:28:07] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4053AA_AS.fasta into pseudo-reads
[10:28:07] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:07] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::process] read 320158 sequences (80000120 bp)...
[10:28:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320802 reads in 38.893 CPU sec, 13.850 real sec
[10:28:07] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:07] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 117344 reads in 13.422 CPU sec, 1.669 real sec
[10:28:07] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:07] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:07] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 113760 sequences (28440000 bp)...
[10:28:08] Marked 190 heterozygous sites with 'n'
[10:28:08] Creating extra output files: BED GFF CSV TXT HTML
[10:28:08] Identified 307 variants.
[10:28:08] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out
[10:28:08] Result files:
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.aligned.fa
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.bam
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.bam.bai
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.bed
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.consensus.fa
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.consensus.subs.fa
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.csv
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.filt.vcf
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.gff
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.html
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.log
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.raw.vcf
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.subs.vcf
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.tab
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.txt
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.vcf
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.vcf.gz
[10:28:08] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out/snps.vcf.gz.csi
[10:28:08] Walltime used: 21 seconds
[10:28:08] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:28:08] Done.
[samclip] Processed 400000 records...
[Thu Sep 10 10:28:08 2020]
Finished job 82.
56 of 107 steps (52%) done

[Thu Sep 10 10:28:08 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out
    jobid: 16
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3992AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6418AA_AS.out\tSM:ESC_HA6418AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.233 sec; CPU: 50.197 sec
[samclip] Total SAM records 437703, removed 2119, allowed 179, passed 435584
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:09] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[10:28:09] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 124882 reads in 15.004 CPU sec, 1.937 real sec
[samclip] Processed 200000 records...
[10:28:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:09] Wrote 433954 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:09] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:09] Using BAM RG (Read Group) ID: ESC_SA8296AA_AS.out
[10:28:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:09] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:28:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:10] Wrote 430510 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:10] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:10] Using BAM RG (Read Group) ID: ESC_SA8250AA_AS.out
[10:28:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:10] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:10] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8296AA_AS.out\tSM:ESC_SA8296AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:10] Running: bwa mem  -Y -M -R '@RG\tID:ESC_SA8250AA_AS.out\tSM:ESC_SA8250AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 400000 records...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4052AA_AS.out\tSM:ESC_NA4052AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 17.024 sec; CPU: 54.645 sec
[samclip] Total SAM records 445837, removed 1766, allowed 141, passed 444071
[samclip] Header contained 3 lines
[samclip] Done.
[10:28:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::process] read 320184 sequences (80000208 bp)...
[10:28:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:10] This is snippy 4.4.3
[10:28:10] Written by Torsten Seemann
[10:28:10] Obtained from https://github.com/tseemann/snippy
[10:28:10] Detected operating system: linux
[10:28:10] Enabling bundled linux tools.
[10:28:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 113770 sequences (28442500 bp)...
[10:28:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:11] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:11] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:11] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:11] Wrote 440556 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:11] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:11] Using BAM RG (Read Group) ID: ESC_NA4053AA_AS.out
[10:28:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:11] Found gzip - /usr/bin/gzip
[10:28:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:11] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:11] Running: samtools index snps.bam 2>> snps.log
[10:28:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:11] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:11] Marked 467 heterozygous sites with 'n'
[10:28:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:11] Creating extra output files: BED GFF CSV TXT HTML
[10:28:11] Identified 20 variants.
[10:28:11] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out
[10:28:11] Result files:
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.aligned.fa
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.bam
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.bam.bai
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.bed
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.consensus.fa
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.consensus.subs.fa
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.csv
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.filt.vcf
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.gff
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.html
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.log
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.raw.vcf
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.subs.vcf
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.tab
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.txt
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.vcf
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.vcf.gz
[10:28:11] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out/snps.vcf.gz.csi
[10:28:11] Walltime used: 22 seconds
[10:28:11] Questionable SNP? Try the --report option to see the alignments.
[10:28:11] Done.
[10:28:11] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4053AA_AS.out\tSM:ESC_NA4053AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:28:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[Thu Sep 10 10:28:11 2020]
Finished job 52.
57 of 107 steps (53%) done
[M::bwa_idx_load_from_disk] read 0 ALT contigs

[Thu Sep 10 10:28:11 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out
    jobid: 66
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3975AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320066 sequences (80000282 bp)...
[10:28:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 23
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:12] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:12] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:12] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:12] Treating reference as 'fasta' format.
[10:28:12] Will use 8 CPU cores.
[10:28:12] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta
[10:28:12] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out
[10:28:12] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out
[10:28:12] Creating reference folder: reference
[10:28:12] Extracting FASTA and GFF from reference.
[10:28:12] Wrote 1 sequences to ref.fa
[10:28:12] Wrote 0 features to ref.gff
[10:28:12] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3992AA_AS.fasta into pseudo-reads
[10:28:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:13] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:13] Running: bcftools index -f snps.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:13] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:13] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:13] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 120490 sequences (30114358 bp)...
[10:28:13] Running: samtools index snps.bam 2>> snps.log
[10:28:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:13] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:14] This is snippy 4.4.3
[10:28:14] Written by Torsten Seemann
[10:28:14] Obtained from https://github.com/tseemann/snippy
[10:28:14] Detected operating system: linux
[10:28:14] Enabling bundled linux tools.
[10:28:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:14] Found gzip - /usr/bin/gzip
[10:28:14] Marked 504 heterozygous sites with 'n'
[10:28:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:14] Creating extra output files: BED GFF CSV TXT HTML
[10:28:14] Identified 23 variants.
[10:28:14] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out
[10:28:14] Result files:
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.aligned.fa
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.bam
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.bam.bai
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.bed
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.consensus.fa
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.consensus.subs.fa
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.csv
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.filt.vcf
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.gff
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.html
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.log
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.raw.vcf
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.subs.vcf
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.tab
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.txt
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.vcf
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.vcf.gz
[10:28:14] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out/snps.vcf.gz.csi
[10:28:14] Walltime used: 23 seconds
[10:28:14] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:28:14] Done.
[10:28:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[Thu Sep 10 10:28:14 2020]
Finished job 6.
58 of 107 steps (54%) done

[Thu Sep 10 10:28:14 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out
    jobid: 60
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4066AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta
[10:28:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 328
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:15] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:15] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:15] Treating reference as 'fasta' format.
[10:28:15] Will use 8 CPU cores.
[10:28:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:15] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta
[10:28:15] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out
[10:28:15] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out
[10:28:15] Creating reference folder: reference
[10:28:15] Extracting FASTA and GFF from reference.
[10:28:15] Wrote 1 sequences to ref.fa
[10:28:15] Wrote 0 features to ref.gff
[10:28:15] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3975AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320158 reads in 44.164 CPU sec, 7.912 real sec
[10:28:15] Marked 216 heterozygous sites with 'n'
[10:28:15] Creating extra output files: BED GFF CSV TXT HTML
[10:28:15] Identified 328 variants.
[10:28:16] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out
[10:28:16] Result files:
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.aligned.fa
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.bam
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.bam.bai
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.bed
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.consensus.fa
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.consensus.subs.fa
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.csv
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.filt.vcf
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.gff
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.html
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.log
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.raw.vcf
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.subs.vcf
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.tab
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.txt
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.vcf
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.vcf.gz
[10:28:16] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out/snps.vcf.gz.csi
[10:28:16] Walltime used: 29 seconds
[10:28:16] Questionable SNP? Try the --report option to see the alignments.
[10:28:16] Done.
[Thu Sep 10 10:28:16 2020]
Finished job 58.
59 of 107 steps (55%) done

[Thu Sep 10 10:28:16 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out
    jobid: 30
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_IA0811AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta
[10:28:16] Wrote 432980 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:16] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:16] Using BAM RG (Read Group) ID: ESC_NA3992AA_AS.out
[10:28:16] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:16] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:16] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:16] This is snippy 4.4.3
[10:28:16] Written by Torsten Seemann
[10:28:16] Obtained from https://github.com/tseemann/snippy
[10:28:16] Detected operating system: linux
[10:28:16] Enabling bundled linux tools.
[10:28:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[samclip] Processed 100000 records...
[10:28:16] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:16] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:16] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:16] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3992AA_AS.out\tSM:ESC_NA3992AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:28:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:16] Found gzip - /usr/bin/gzip
[10:28:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:17] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320096 sequences (80000146 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:17] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:17] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:17] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:17] Treating reference as 'fasta' format.
[10:28:17] Will use 8 CPU cores.
[10:28:17] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta
[10:28:17] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out
[10:28:17] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out
[10:28:17] Creating reference folder: reference
[10:28:17] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
[10:28:17] Wrote 1 sequences to ref.fa
[10:28:17] Wrote 0 features to ref.gff
[10:28:17] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4066AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 113760 reads in 14.644 CPU sec, 2.041 real sec
[10:28:17] This is snippy 4.4.3
[10:28:17] Written by Torsten Seemann
[10:28:17] Obtained from https://github.com/tseemann/snippy
[10:28:17] Detected operating system: linux
[10:28:17] Enabling bundled linux tools.
[10:28:17] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:17] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:17] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:17] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:17] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:17] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:17] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:17] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:17] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:17] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:17] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:17] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:17] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:17] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[samclip] Processed 300000 records...
[10:28:17] Found gzip - /usr/bin/gzip
[10:28:17] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:17] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:17] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:17] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:17] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[M::process] read 112884 sequences (28217298 bp)...
[10:28:17] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 400000 records...
[10:28:18] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8291AA_AS.out\tSM:ESC_SA8291AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.131 sec; CPU: 59.401 sec
[M::mem_process_seqs] Processed 320184 reads in 46.236 CPU sec, 7.945 real sec
[samclip] Total SAM records 434058, removed 1577, allowed 101, passed 432481
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:18] Wrote 437160 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:18] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:18] Using BAM RG (Read Group) ID: ESC_NA3975AA_AS.out
[10:28:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:19] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:19] Treating reference as 'fasta' format.
[10:28:19] Will use 8 CPU cores.
[10:28:19] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta
[10:28:19] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out
[10:28:19] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out
[10:28:19] Creating reference folder: reference
[10:28:19] Extracting FASTA and GFF from reference.
[10:28:19] Wrote 1 sequences to ref.fa
[10:28:19] Wrote 0 features to ref.gff
[10:28:19] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_IA0811AA_AS.fasta into pseudo-reads
[10:28:19] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[10:28:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:19] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3975AA_AS.out\tSM:ESC_NA3975AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::process] read 320444 sequences (80000032 bp)...
[M::mem_process_seqs] Processed 113770 reads in 13.424 CPU sec, 2.032 real sec
[M::process] read 116716 sequences (29128610 bp)...
[10:28:20] Wrote 433918 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:20] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:20] Using BAM RG (Read Group) ID: ESC_NA4066AA_AS.out
[10:28:20] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:20] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:28:20] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:20] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:20] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:20] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:20] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4066AA_AS.out\tSM:ESC_NA4066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320066 reads in 48.056 CPU sec, 8.911 real sec
[samclip] Processed 400000 records...
[M::process] read 320108 sequences (80000032 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8296AA_AS.out\tSM:ESC_SA8296AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.388 sec; CPU: 60.186 sec
[samclip] Total SAM records 434094, removed 1546, allowed 130, passed 432548
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:21] Running: samtools index snps.bam 2>> snps.log
[10:28:22] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[10:28:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:22] Wrote 433482 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:22] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:22] Using BAM RG (Read Group) ID: ESC_IA0811AA_AS.out
[10:28:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:22] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[10:28:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:22] Running: bwa mem  -Y -M -R '@RG\tID:ESC_IA0811AA_AS.out\tSM:ESC_IA0811AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 313
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::mem_process_seqs] Processed 120490 reads in 13.112 CPU sec, 1.955 real sec
[10:28:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 110510 sequences (27627500 bp)...
[samclip] Processed 300000 records...
[10:28:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320332 sequences (80000374 bp)...
[10:28:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:23] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 400000 records...
[10:28:24] Marked 138 heterozygous sites with 'n'
[10:28:24] Creating extra output files: BED GFF CSV TXT HTML
[10:28:24] Identified 313 variants.
[10:28:24] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out
[10:28:24] Result files:
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.aligned.fa
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.bam
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.bam.bai
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.bed
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.consensus.fa
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.consensus.subs.fa
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.csv
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.filt.vcf
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.gff
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.html
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.log
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.raw.vcf
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.subs.vcf
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.tab
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.txt
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.vcf
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.vcf.gz
[10:28:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out/snps.vcf.gz.csi
[10:28:24] Walltime used: 22 seconds
[10:28:24] May the SNPs be with you.
[10:28:24] Done.
[Thu Sep 10 10:28:24 2020]
Finished job 20.
60 of 107 steps (56%) done

[Thu Sep 10 10:28:24 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out
    jobid: 88
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4056AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4053AA_AS.out\tSM:ESC_NA4053AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.567 sec; CPU: 61.854 sec
[samclip] Total SAM records 440694, removed 1590, allowed 131, passed 439104
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320096 reads in 35.417 CPU sec, 7.407 real sec
[samclip] Processed 100000 records...
[10:28:25] Running: samtools index snps.bam 2>> snps.log
[10:28:25] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 112884 reads in 10.474 CPU sec, 1.513 real sec
[samclip] Processed 200000 records...
[M::process] read 113150 sequences (28263022 bp)...
[10:28:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 300000 records...
[10:28:26] This is snippy 4.4.3
[10:28:26] Written by Torsten Seemann
[10:28:26] Obtained from https://github.com/tseemann/snippy
[10:28:26] Detected operating system: linux
[10:28:26] Enabling bundled linux tools.
[10:28:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 308
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:26] Found gzip - /usr/bin/gzip
[10:28:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 400000 records...
[10:28:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3992AA_AS.out\tSM:ESC_NA3992AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 433118, removed 1445, allowed 112, passed 431673

[main] Real time: 10.135 sec; CPU: 46.571 sec
[samclip] Header contained 3 lines
[samclip] Done.
[10:28:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:26] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:26] Treating reference as 'fasta' format.
[10:28:26] Will use 8 CPU cores.
[10:28:26] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta
[10:28:26] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out
[10:28:26] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out
[10:28:26] Creating reference folder: reference
[10:28:26] Extracting FASTA and GFF from reference.
[10:28:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:26] Wrote 1 sequences to ref.fa
[10:28:26] Wrote 0 features to ref.gff
[10:28:26] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4056AA_AS.fasta into pseudo-reads
[10:28:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:26] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:27] Running: samtools index snps.bam 2>> snps.log
[M::process] read 113810 sequences (28449800 bp)...
[10:28:27] Marked 93 heterozygous sites with 'n'
[10:28:27] Creating extra output files: BED GFF CSV TXT HTML
[10:28:27] Identified 308 variants.
[10:28:27] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:27] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out
[10:28:27] Result files:
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.aligned.fa
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.bam
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.bam.bai
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.bed
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.consensus.fa
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.consensus.subs.fa
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.csv
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.filt.vcf
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.gff
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.html
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.log
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.raw.vcf
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.subs.vcf
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.tab
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.txt
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.vcf
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.vcf.gz
[10:28:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out/snps.vcf.gz.csi
[10:28:27] Walltime used: 22 seconds
[10:28:27] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:28:27] Done.
[10:28:27] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[Thu Sep 10 10:28:27 2020]
Finished job 64.
61 of 107 steps (57%) done

[Thu Sep 10 10:28:27 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out
    jobid: 40
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3982AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta
[M::mem_process_seqs] Processed 320444 reads in 33.821 CPU sec, 7.604 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 41.320 CPU sec, 17.908 real sec
[10:28:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 323
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[10:28:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:29] Running: samtools index snps.bam 2>> snps.log
[10:28:29] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:30] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 116716 reads in 13.076 CPU sec, 2.302 real sec
[10:28:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 200000 records...
[10:28:30] Wrote 436180 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:30] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:30] Using BAM RG (Read Group) ID: ESC_NA4056AA_AS.out
[10:28:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:30] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:28:30] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:30] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:30] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:30] Marked 227 heterozygous sites with 'n'
[10:28:30] Creating extra output files: BED GFF CSV TXT HTML
[10:28:30] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4056AA_AS.out\tSM:ESC_NA4056AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[10:28:30] Identified 323 variants.
[10:28:30] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out
[10:28:30] Result files:
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.aligned.fa
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.bam
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.bam.bai
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.bed
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.consensus.fa
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.consensus.subs.fa
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.csv
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.filt.vcf
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.gff
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.html
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.log
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.raw.vcf
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.subs.vcf
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.tab
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.txt
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.vcf
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.vcf.gz
[10:28:30] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out/snps.vcf.gz.csi
[10:28:30] Walltime used: 23 seconds
[10:28:30] May the SNPs be with you.
[10:28:30] Done.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[Thu Sep 10 10:28:30 2020]
Finished job 78.
62 of 107 steps (58%) done

[Thu Sep 10 10:28:30 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out
    jobid: 10
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_HA6413AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:30] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 317
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:30] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3975AA_AS.out\tSM:ESC_NA3975AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.040 sec; CPU: 47.582 sec
[samclip] Total SAM records 437323, removed 1394, allowed 168, passed 435929
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:31] This is snippy 4.4.3
[10:28:31] Written by Torsten Seemann
[10:28:31] Obtained from https://github.com/tseemann/snippy
[10:28:31] Detected operating system: linux
[10:28:31] Enabling bundled linux tools.
[10:28:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[M::mem_process_seqs] Processed 110510 reads in 15.076 CPU sec, 2.627 real sec
[10:28:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:31] Found gzip - /usr/bin/gzip
[10:28:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:31] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[M::process] read 321522 sequences (80000022 bp)...
[10:28:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:28:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:31] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_SA8250AA_AS.out\tSM:ESC_SA8250AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 21.276 sec; CPU: 56.978 sec
[samclip] Total SAM records 430682, removed 2726, allowed 146, passed 427956
[samclip] Header contained 3 lines
[samclip] Done.
[M::process] read 114658 sequences (28559392 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:31] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:31] Treating reference as 'fasta' format.
[10:28:31] Will use 8 CPU cores.
[10:28:31] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta
[10:28:31] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out
[10:28:31] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out
[10:28:31] Creating reference folder: reference
[10:28:31] Extracting FASTA and GFF from reference.
[10:28:31] Wrote 1 sequences to ref.fa
[10:28:31] Wrote 0 features to ref.gff
[10:28:31] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3982AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:31] Marked 170 heterozygous sites with 'n'
[10:28:31] Creating extra output files: BED GFF CSV TXT HTML
[10:28:31] Identified 317 variants.
[10:28:31] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out
[10:28:31] Result files:
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.aligned.fa
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.bam
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.bam.bai
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.bed
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.consensus.fa
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.consensus.subs.fa
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.csv
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.filt.vcf
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.gff
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.html
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.log
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.raw.vcf
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.subs.vcf
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.tab
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.txt
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.vcf
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.vcf.gz
[10:28:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out/snps.vcf.gz.csi
[10:28:31] Walltime used: 21 seconds
[10:28:31] Questionable SNP? Try the --report option to see the alignments.
[10:28:31] Done.
[Thu Sep 10 10:28:31 2020]
Finished job 16.
63 of 107 steps (59%) done

[Thu Sep 10 10:28:31 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out
    jobid: 44
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4071AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta
[M::mem_process_seqs] Processed 320332 reads in 37.439 CPU sec, 8.595 real sec
[10:28:32] This is snippy 4.4.3
[10:28:32] Written by Torsten Seemann
[10:28:32] Obtained from https://github.com/tseemann/snippy
[10:28:32] Detected operating system: linux
[10:28:32] Enabling bundled linux tools.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:32] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:32] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:32] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:32] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:32] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:32] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:32] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:32] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:32] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:32] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:32] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:32] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:32] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:32] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:32] Found gzip - /usr/bin/gzip
[10:28:32] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:32] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:32] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:32] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:32] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:32] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:32] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[10:28:32] This is snippy 4.4.3
[10:28:32] Written by Torsten Seemann
[10:28:32] Obtained from https://github.com/tseemann/snippy
[10:28:32] Detected operating system: linux
[10:28:32] Enabling bundled linux tools.
[10:28:32] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:33] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:33] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:33] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:33] Treating reference as 'fasta' format.
[10:28:33] Will use 8 CPU cores.
[10:28:33] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta
[10:28:33] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out
[10:28:33] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out
[10:28:33] Creating reference folder: reference
[10:28:33] Extracting FASTA and GFF from reference.
[10:28:33] Wrote 1 sequences to ref.fa
[10:28:33] Wrote 0 features to ref.gff
[10:28:33] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6413AA_AS.fasta into pseudo-reads
[10:28:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:33] Found gzip - /usr/bin/gzip
[10:28:33] Running: samtools index snps.bam 2>> snps.log
[10:28:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:33] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:33] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:33] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320108 reads in 34.859 CPU sec, 12.276 real sec
[samclip] Processed 200000 records...
[10:28:33] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 113150 reads in 14.667 CPU sec, 1.973 real sec
[10:28:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:34] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[samclip] Processed 300000 records...
[10:28:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:34] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:34] Treating reference as 'fasta' format.
[10:28:34] Will use 8 CPU cores.
[10:28:34] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta
[10:28:34] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out
[10:28:34] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out
[10:28:34] Creating reference folder: reference
[10:28:34] Extracting FASTA and GFF from reference.
[10:28:34] Wrote 1 sequences to ref.fa
[10:28:34] Wrote 0 features to ref.gff
[10:28:34] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4071AA_AS.fasta into pseudo-reads
[10:28:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[10:28:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_IA0811AA_AS.out\tSM:ESC_IA0811AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.890 sec; CPU: 52.715 sec
[samclip] Total SAM records 433560, removed 1667, allowed 138, passed 431893
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 319
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:35] Wrote 430500 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:35] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:35] Using BAM RG (Read Group) ID: ESC_NA3982AA_AS.out
[10:28:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:35] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 28
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:35] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3982AA_AS.out\tSM:ESC_NA3982AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:28:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[10:28:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:35] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 320078 sequences (80000386 bp)...
[10:28:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 113810 reads in 19.340 CPU sec, 2.532 real sec
[10:28:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 110422 sequences (27601220 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[10:28:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:36] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:36] Marked 178 heterozygous sites with 'n'
[10:28:36] Creating extra output files: BED GFF CSV TXT HTML
[10:28:36] Identified 319 variants.
[10:28:36] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out
[10:28:36] Result files:
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.aligned.fa
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.bam
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.bam.bai
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.bed
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.consensus.fa
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.consensus.subs.fa
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.csv
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.filt.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.gff
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.html
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.log
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.raw.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.subs.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.tab
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.txt
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.vcf.gz
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out/snps.vcf.gz.csi
[10:28:36] Walltime used: 22 seconds
[10:28:36] Wishing you a life free of homopolymer errors.
[10:28:36] Done.
[Thu Sep 10 10:28:36 2020]
Finished job 66.
64 of 107 steps (60%) done

[Thu Sep 10 10:28:36 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out
    jobid: 90
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4061AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta
[10:28:36] Wrote 431622 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:36] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:36] Using BAM RG (Read Group) ID: ESC_HA6413AA_AS.out
[10:28:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:36] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:36] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6413AA_AS.out\tSM:ESC_HA6413AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 400000 records...
[10:28:36] Marked 333 heterozygous sites with 'n'
[10:28:36] Creating extra output files: BED GFF CSV TXT HTML
[10:28:36] Identified 28 variants.
[10:28:36] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out
[10:28:36] Result files:
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.aligned.fa
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.bam
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.bam.bai
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.bed
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.consensus.fa
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.consensus.subs.fa
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.csv
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.filt.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.gff
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.html
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.log
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.raw.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.subs.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.tab
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.txt
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.vcf
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.vcf.gz
[10:28:36] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out/snps.vcf.gz.csi
[10:28:36] Walltime used: 31 seconds
[10:28:36] Questionable SNP? Try the --report option to see the alignments.
[10:28:36] Done.
[Thu Sep 10 10:28:36 2020]
Finished job 8.
65 of 107 steps (61%) done

[Thu Sep 10 10:28:36 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out
    jobid: 68
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3973AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4066AA_AS.out\tSM:ESC_NA4066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 16.028 sec; CPU: 54.885 sec
[samclip] Total SAM records 434269, removed 2366, allowed 253, passed 431903
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320068 sequences (80000436 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:37] Running: samtools index snps.bam 2>> snps.log
[10:28:37] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:37] Wrote 428844 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:37] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:37] Using BAM RG (Read Group) ID: ESC_NA4071AA_AS.out
[10:28:37] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:37] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:37] This is snippy 4.4.3
[10:28:37] Written by Torsten Seemann
[10:28:37] Obtained from https://github.com/tseemann/snippy
[10:28:37] Detected operating system: linux
[10:28:37] Enabling bundled linux tools.
[10:28:37] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:37] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:37] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:37] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:37] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:37] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:37] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:37] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:37] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:37] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:37] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:37] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:37] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:37] Found gzip - /usr/bin/gzip
[10:28:37] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:37] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:37] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:37] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:38] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4071AA_AS.out\tSM:ESC_NA4071AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:28:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:28:38] This is snippy 4.4.3
[10:28:38] Written by Torsten Seemann
[10:28:38] Obtained from https://github.com/tseemann/snippy
[10:28:38] Detected operating system: linux
[10:28:38] Enabling bundled linux tools.
[10:28:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 25
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:38] Found gzip - /usr/bin/gzip
[10:28:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:38] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:38] Treating reference as 'fasta' format.
[10:28:38] Will use 8 CPU cores.
[10:28:38] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta
[10:28:38] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out
[10:28:38] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out
[10:28:38] Creating reference folder: reference
[10:28:38] Extracting FASTA and GFF from reference.
[10:28:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320024 sequences (80000308 bp)...
[10:28:38] Wrote 1 sequences to ref.fa
[10:28:38] Wrote 0 features to ref.gff
[10:28:38] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4061AA_AS.fasta into pseudo-reads
[M::process] read 111554 sequences (27888200 bp)...
[10:28:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:38] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:38] Treating reference as 'fasta' format.
[10:28:38] Will use 8 CPU cores.
[10:28:38] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta
[10:28:38] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out
[10:28:38] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out
[10:28:38] Creating reference folder: reference
[10:28:38] Extracting FASTA and GFF from reference.
[10:28:38] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:38] Wrote 1 sequences to ref.fa
[10:28:38] Wrote 0 features to ref.gff
[10:28:38] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3973AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 321522 reads in 44.375 CPU sec, 7.685 real sec
[10:28:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:39] Running: samtools index snps.bam 2>> snps.log
[10:28:39] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:39] Marked 219 heterozygous sites with 'n'
[10:28:40] Creating extra output files: BED GFF CSV TXT HTML
[10:28:40] Identified 25 variants.
[10:28:40] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out
[10:28:40] Result files:
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.aligned.fa
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.bam
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.bam.bai
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.bed
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.consensus.fa
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.consensus.subs.fa
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.csv
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.filt.vcf
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.gff
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.html
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.log
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.raw.vcf
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.subs.vcf
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.tab
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.txt
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.vcf
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.vcf.gz
[10:28:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out/snps.vcf.gz.csi
[10:28:40] Walltime used: 23 seconds
[10:28:40] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:28:40] Done.
[samclip] Processed 100000 records...
[Thu Sep 10 10:28:40 2020]
Finished job 30.
66 of 107 steps (62%) done

[Thu Sep 10 10:28:40 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out
    jobid: 38
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3971AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta
[10:28:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 114658 reads in 12.918 CPU sec, 2.471 real sec

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 334
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[10:28:41] Wrote 432188 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:41] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:41] Using BAM RG (Read Group) ID: ESC_NA4061AA_AS.out
[10:28:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:42] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:28:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:42] Wrote 429240 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:42] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:42] Using BAM RG (Read Group) ID: ESC_NA3973AA_AS.out
[10:28:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 400000 records...
[10:28:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::process] read 108820 sequences (27194200 bp)...
[10:28:42] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:42] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4061AA_AS.out\tSM:ESC_NA4061AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:28:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4056AA_AS.out\tSM:ESC_NA4056AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.832 sec; CPU: 58.106 sec
[samclip] Total SAM records 436323, removed 1412, allowed 182, passed 434911
[samclip] Header contained 3 lines
[samclip] Done.
[10:28:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:42] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:42] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3973AA_AS.out\tSM:ESC_NA3973AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:28:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320850 sequences (80000178 bp)...
[10:28:43] Marked 533 heterozygous sites with 'n'
[10:28:43] Creating extra output files: BED GFF CSV TXT HTML
[10:28:43] Identified 334 variants.
[10:28:43] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out
[10:28:43] Result files:
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.aligned.fa
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.bam
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.bam.bai
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.bed
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.consensus.fa
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.consensus.subs.fa
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.csv
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.filt.vcf
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.gff
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.html
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.log
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.raw.vcf
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.subs.vcf
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.tab
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.txt
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.vcf
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.vcf.gz
[10:28:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out/snps.vcf.gz.csi
[10:28:43] Walltime used: 27 seconds
[10:28:43] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:28:43] Done.
[Thu Sep 10 10:28:43 2020]
Finished job 60.
67 of 107 steps (63%) done

[Thu Sep 10 10:28:43 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out
    jobid: 32
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4070AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta
[10:28:43] This is snippy 4.4.3
[10:28:43] Written by Torsten Seemann
[10:28:43] Obtained from https://github.com/tseemann/snippy
[10:28:43] Detected operating system: linux
[10:28:43] Enabling bundled linux tools.
[10:28:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[M::process] read 320086 sequences (80000126 bp)...
[10:28:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:43] Found gzip - /usr/bin/gzip
[10:28:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320078 reads in 50.663 CPU sec, 7.805 real sec
[10:28:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:44] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:44] Treating reference as 'fasta' format.
[10:28:44] Will use 8 CPU cores.
[10:28:44] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta
[10:28:44] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out
[10:28:44] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out
[10:28:44] Creating reference folder: reference
[10:28:44] Extracting FASTA and GFF from reference.
[10:28:44] Wrote 1 sequences to ref.fa
[10:28:44] Wrote 0 features to ref.gff
[10:28:44] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3971AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320068 reads in 38.670 CPU sec, 7.557 real sec
[10:28:44] Running: samtools index snps.bam 2>> snps.log
[10:28:45] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 110422 reads in 12.857 CPU sec, 2.017 real sec
[10:28:45] This is snippy 4.4.3
[10:28:45] Written by Torsten Seemann
[10:28:45] Obtained from https://github.com/tseemann/snippy
[10:28:45] Detected operating system: linux
[10:28:45] Enabling bundled linux tools.
[10:28:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[samclip] Processed 100000 records...
[10:28:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[samclip] Processed 100000 records...
[10:28:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:28:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:28:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 314
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:28:46] Found gzip - /usr/bin/gzip
[samclip] Processed 200000 records...
[10:28:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[M::mem_process_seqs] Processed 111554 reads in 11.779 CPU sec, 1.835 real sec
[10:28:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 109154 sequences (27275304 bp)...
[10:28:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 200000 records...
[10:28:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[10:28:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:47] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:47] Treating reference as 'fasta' format.
[10:28:47] Will use 8 CPU cores.
[10:28:47] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta
[10:28:47] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out
[10:28:47] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out
[10:28:47] Creating reference folder: reference
[10:28:47] Extracting FASTA and GFF from reference.
[10:28:47] Wrote 1 sequences to ref.fa
[10:28:47] Wrote 0 features to ref.gff
[10:28:47] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4070AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[10:28:47] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:47] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:47] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:47] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 400000 records...
[10:28:47] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3982AA_AS.out\tSM:ESC_NA3982AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.882 sec; CPU: 64.224 sec
[samclip] Total SAM records 430639, removed 1333, allowed 98, passed 429306
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[10:28:47] Marked 166 heterozygous sites with 'n'
[10:28:47] Creating extra output files: BED GFF CSV TXT HTML
[10:28:47] Identified 314 variants.
[10:28:47] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out
[10:28:47] Result files:
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.aligned.fa
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.bam
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.bam.bai
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.bed
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.consensus.fa
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.consensus.subs.fa
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.csv
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.filt.vcf
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.gff
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.html
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.log
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.raw.vcf
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.subs.vcf
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.tab
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.txt
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.vcf
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.vcf.gz
[10:28:47] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out/snps.vcf.gz.csi
[10:28:47] Walltime used: 21 seconds
[10:28:47] Wishing you a life free of homopolymer errors.
[10:28:47] Done.
[M::process] read 111338 sequences (27679820 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6413AA_AS.out\tSM:ESC_HA6413AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.948 sec; CPU: 51.243 sec
[samclip] Total SAM records 431741, removed 1782, allowed 118, passed 429959
[samclip] Header contained 3 lines
[samclip] Done.
[Thu Sep 10 10:28:47 2020]
Finished job 88.
68 of 107 steps (64%) done

[Thu Sep 10 10:28:47 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out
    jobid: 94
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3980AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:48] Wrote 432156 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:48] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:48] Using BAM RG (Read Group) ID: ESC_NA3971AA_AS.out
[10:28:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:48] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:48] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3971AA_AS.out\tSM:ESC_NA3971AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320040 sequences (80000178 bp)...
[M::mem_process_seqs] Processed 320024 reads in 44.589 CPU sec, 10.590 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:50] Wrote 430226 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:50] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:50] Using BAM RG (Read Group) ID: ESC_NA4070AA_AS.out
[10:28:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:50] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:50] Running: samtools index snps.bam 2>> snps.log
[10:28:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:51] Running: samtools index snps.bam 2>> snps.log
[10:28:51] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[10:28:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:28:51] This is snippy 4.4.3
[10:28:51] Written by Torsten Seemann
[10:28:51] Obtained from https://github.com/tseemann/snippy
[10:28:51] Detected operating system: linux
[10:28:51] Enabling bundled linux tools.
[10:28:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:51] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4070AA_AS.out\tSM:ESC_NA4070AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:28:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:28:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[M::mem_process_seqs] Processed 108820 reads in 11.533 CPU sec, 2.216 real sec
[10:28:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:28:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:51] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:51] Found gzip - /usr/bin/gzip
[10:28:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:28:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[M::process] read 112116 sequences (28010038 bp)...
[M::process] read 320416 sequences (80000270 bp)...
[10:28:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:28:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:51] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:51] Treating reference as 'fasta' format.
[10:28:51] Will use 8 CPU cores.
[10:28:51] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta
[10:28:51] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out
[10:28:51] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out
[10:28:51] Creating reference folder: reference
[10:28:51] Extracting FASTA and GFF from reference.
[10:28:51] Wrote 1 sequences to ref.fa
[10:28:51] Wrote 0 features to ref.gff
[10:28:51] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3980AA_AS.fasta into pseudo-reads

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 318
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:28:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 109810 sequences (27399172 bp)...
[10:28:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[10:28:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:52] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:52] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:52] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:52] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:52] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:28:52] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:28:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:52] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:52] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:52] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:52] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4071AA_AS.out\tSM:ESC_NA4071AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.484 sec; CPU: 56.964 sec
[samclip] Total SAM records 428986, removed 1484, allowed 133, passed 427502
[samclip] Header contained 3 lines
[samclip] Done.
[10:28:52] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:52] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:53] Marked 166 heterozygous sites with 'n'
[10:28:53] Creating extra output files: BED GFF CSV TXT HTML
[10:28:53] Marked 224 heterozygous sites with 'n'
[10:28:53] Identified 318 variants.
[10:28:53] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out
[10:28:53] Result files:
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.aligned.fa
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.bam
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.bam.bai
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.bed
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.consensus.fa
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.consensus.subs.fa
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.csv
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.filt.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.gff
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.html
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.log
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.raw.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.subs.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.tab
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.txt
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.vcf.gz
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out/snps.vcf.gz.csi
[10:28:53] Walltime used: 22 seconds
[10:28:53] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:28:53] Done.
[10:28:53] Creating extra output files: BED GFF CSV TXT HTML
[10:28:53] Identified 24 variants.
[10:28:53] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out
[10:28:53] Result files:
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.aligned.fa
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.bam
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.bam.bai
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.bed
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.consensus.fa
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.consensus.subs.fa
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.csv
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.filt.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.gff
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.html
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.log
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.raw.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.subs.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.tab
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.txt
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.vcf
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.vcf.gz
[10:28:53] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out/snps.vcf.gz.csi
[10:28:53] Walltime used: 21 seconds
[10:28:53] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:28:53] Done.
[Thu Sep 10 10:28:53 2020]
Finished job 40.
69 of 107 steps (64%) done
[Thu Sep 10 10:28:53 2020]
Finished job 10.
70 of 107 steps (65%) done

[Thu Sep 10 10:28:53 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out
    jobid: 22
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4048AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta

[Thu Sep 10 10:28:53 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out
    jobid: 54
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_GA5350AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta
[M::mem_process_seqs] Processed 320850 reads in 39.082 CPU sec, 10.202 real sec
[M::mem_process_seqs] Processed 320086 reads in 43.907 CPU sec, 10.047 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 109154 reads in 11.059 CPU sec, 2.358 real sec
[samclip] Processed 200000 records...
[10:28:55] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 111338 reads in 12.051 CPU sec, 2.623 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[10:28:56] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[10:28:56] Wrote 426252 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:28:56] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:28:56] Using BAM RG (Read Group) ID: ESC_NA3980AA_AS.out
[samclip] Processed 400000 records...
[10:28:56] This is snippy 4.4.3
[10:28:56] Written by Torsten Seemann
[10:28:56] Obtained from https://github.com/tseemann/snippy
[10:28:56] Detected operating system: linux
[10:28:56] Enabling bundled linux tools.
[10:28:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:28:56] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:28:56] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:56] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:56] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:56] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:56] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:56] Running: bwa index reference/ref.fa 2>> snps.log
[10:28:56] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3973AA_AS.out\tSM:ESC_NA3973AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.718 sec; CPU: 55.707 sec
[samclip] Total SAM records 429380, removed 1576, allowed 110, passed 427804
[samclip] Header contained 3 lines
[samclip] Done.
[10:28:56] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:56] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:56] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:56] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:56] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:56] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:56] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:56] Found gzip - /usr/bin/gzip
[10:28:56] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:28:56] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:56] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:28:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:28:56] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:28:56] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3980AA_AS.out\tSM:ESC_NA3980AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:28:56] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4061AA_AS.out\tSM:ESC_NA4061AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 14.345 sec; CPU: 51.948 sec
[10:28:56] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Total SAM records 432342, removed 1491, allowed 99, passed 430851
[samclip] Header contained 3 lines
[samclip] Done.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:57] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 315
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:28:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:28:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320074 sequences (80000204 bp)...
[10:28:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:57] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:57] Treating reference as 'fasta' format.
[10:28:57] Will use 8 CPU cores.
[10:28:57] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta
[10:28:57] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out
[10:28:57] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out
[10:28:57] Creating reference folder: reference
[10:28:57] Extracting FASTA and GFF from reference.
[10:28:57] This is snippy 4.4.3
[10:28:57] Written by Torsten Seemann
[10:28:57] Obtained from https://github.com/tseemann/snippy
[10:28:57] Detected operating system: linux
[10:28:57] Enabling bundled linux tools.
[10:28:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:28:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:28:57] Wrote 1 sequences to ref.fa
[10:28:57] Wrote 0 features to ref.gff
[10:28:57] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_GA5350AA_AS.fasta into pseudo-reads
[10:28:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:28:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:28:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:28:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:28:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:28:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:28:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:28:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:28:57] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:28:57] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:28:57] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:28:57] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:28:57] Found gzip - /usr/bin/gzip
[10:28:57] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:28:57] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:28:57] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:28:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:28:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:28:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 106178 sequences (26544200 bp)...
[10:28:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:28:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:28:57] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:28:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:28:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:28:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:28:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:28:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:28:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:28:57] Running: rm -f fake_reads\.fq 2>> snps.log
[10:28:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:28:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:28:57] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:28:57] Treating reference as 'fasta' format.
[10:28:57] Will use 8 CPU cores.
[10:28:57] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta
[10:28:57] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out
[10:28:57] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out
[10:28:57] Creating reference folder: reference
[10:28:57] Extracting FASTA and GFF from reference.
[10:28:57] Wrote 1 sequences to ref.fa
[10:28:57] Wrote 0 features to ref.gff
[10:28:57] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4048AA_AS.fasta into pseudo-reads
[10:28:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:28:58] Marked 469 heterozygous sites with 'n'
[10:28:58] Creating extra output files: BED GFF CSV TXT HTML
[10:28:58] Identified 315 variants.
[10:28:58] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out
[10:28:58] Result files:
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.aligned.fa
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.bam
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.bam.bai
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.bed
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.consensus.fa
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.consensus.subs.fa
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.csv
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.filt.vcf
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.gff
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.html
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.log
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.raw.vcf
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.subs.vcf
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.tab
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.txt
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.vcf
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.vcf.gz
[10:28:58] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out/snps.vcf.gz.csi
[10:28:58] Walltime used: 26 seconds
[10:28:58] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:28:58] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Thu Sep 10 10:28:58 2020]
Finished job 44.
71 of 107 steps (66%) done

[Thu Sep 10 10:28:58 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out
    jobid: 26
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4063AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta
[M::mem_process_seqs] Processed 320416 reads in 43.875 CPU sec, 6.845 real sec
[10:28:58] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320040 reads in 48.421 CPU sec, 9.874 real sec
[10:28:59] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:28:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:28:59] Running: samtools index snps.bam 2>> snps.log
[10:29:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:29:00] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 109810 reads in 12.702 CPU sec, 1.903 real sec

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 322
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 112116 reads in 12.385 CPU sec, 2.007 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[10:29:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:01] Wrote 429232 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:01] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:01] Using BAM RG (Read Group) ID: ESC_GA5350AA_AS.out
[10:29:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:29:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:29:01] Running: bwa index reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 296
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] Processed 400000 records...
[10:29:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:01] This is snippy 4.4.3
[10:29:01] Written by Torsten Seemann
[10:29:01] Obtained from https://github.com/tseemann/snippy
[10:29:01] Detected operating system: linux
[10:29:01] Enabling bundled linux tools.
[10:29:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:01] Found gzip - /usr/bin/gzip
[10:29:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:01] Running: bwa mem  -Y -M -R '@RG\tID:ESC_GA5350AA_AS.out\tSM:ESC_GA5350AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:29:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4070AA_AS.out\tSM:ESC_NA4070AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.082 sec; CPU: 57.392 sec
[samclip] Total SAM records 430367, removed 1358, allowed 111, passed 429009
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:01] Wrote 428210 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:01] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:01] Using BAM RG (Read Group) ID: ESC_NA4048AA_AS.out
[10:29:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:01] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:01] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 400000 records...
[10:29:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3971AA_AS.out\tSM:ESC_NA3971AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.986 sec; CPU: 61.508 sec
[samclip] Total SAM records 432386, removed 1877, allowed 153, passed 430509
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:01] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4048AA_AS.out\tSM:ESC_NA4048AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:29:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:01] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:01] Treating reference as 'fasta' format.
[10:29:01] Will use 8 CPU cores.
[10:29:01] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta
[10:29:01] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out
[10:29:01] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out
[10:29:01] Creating reference folder: reference
[10:29:01] Extracting FASTA and GFF from reference.
[10:29:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:01] Wrote 1 sequences to ref.fa
[10:29:01] Wrote 0 features to ref.gff
[10:29:01] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4063AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:01] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:01] Marked 172 heterozygous sites with 'n'
[10:29:01] Creating extra output files: BED GFF CSV TXT HTML
[10:29:01] Identified 322 variants.
[10:29:01] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out
[10:29:01] Result files:
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.aligned.fa
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.bam
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.bam.bai
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.bed
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.consensus.fa
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.consensus.subs.fa
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.csv
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.filt.vcf
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.gff
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.html
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.log
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.raw.vcf
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.subs.vcf
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.tab
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.txt
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.vcf
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.vcf.gz
[10:29:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out/snps.vcf.gz.csi
[10:29:01] Walltime used: 23 seconds
[10:29:01] May the SNPs be with you.
[10:29:01] Done.
[Thu Sep 10 10:29:01 2020]
Finished job 68.
72 of 107 steps (67%) done

[Thu Sep 10 10:29:01 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out
    jobid: 74
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4067AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta
[M::process] read 320048 sequences (80000068 bp)...
[M::process] read 109184 sequences (27288658 bp)...
[10:29:01] Marked 163 heterozygous sites with 'n'
[10:29:01] Creating extra output files: BED GFF CSV TXT HTML
[10:29:02] Identified 296 variants.
[10:29:02] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out
[10:29:02] Result files:
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.aligned.fa
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.bam
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.bam.bai
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.bed
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.consensus.fa
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.consensus.subs.fa
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.csv
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.filt.vcf
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.gff
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.html
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.log
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.raw.vcf
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.subs.vcf
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.tab
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.txt
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.vcf
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.vcf.gz
[10:29:02] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out/snps.vcf.gz.csi
[10:29:02] Walltime used: 25 seconds
[10:29:02] Wishing you a life free of homopolymer errors.
[10:29:02] Done.
[Thu Sep 10 10:29:02 2020]
Finished job 90.
73 of 107 steps (68%) done

[Thu Sep 10 10:29:02 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out
    jobid: 76
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4068AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta
[M::process] read 320026 sequences (80000076 bp)...
[M::process] read 108184 sequences (27028996 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320074 reads in 33.876 CPU sec, 5.651 real sec
[10:29:03] This is snippy 4.4.3
[10:29:03] Written by Torsten Seemann
[10:29:03] Obtained from https://github.com/tseemann/snippy
[10:29:03] Detected operating system: linux
[10:29:03] Enabling bundled linux tools.
[10:29:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:03] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:03] This is snippy 4.4.3
[10:29:03] Written by Torsten Seemann
[10:29:03] Obtained from https://github.com/tseemann/snippy
[10:29:03] Detected operating system: linux
[10:29:03] Enabling bundled linux tools.
[10:29:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:04] Found gzip - /usr/bin/gzip
[10:29:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:04] Running: samtools index snps.bam 2>> snps.log
[10:29:04] Running: samtools index snps.bam 2>> snps.log
[10:29:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:04] Found gzip - /usr/bin/gzip
[10:29:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:04] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:04] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:05] Wrote 424980 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:05] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:05] Using BAM RG (Read Group) ID: ESC_NA4063AA_AS.out
[10:29:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:05] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::mem_process_seqs] Processed 106178 reads in 16.095 CPU sec, 2.538 real sec
[10:29:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] Processed 100000 records...
[10:29:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:05] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:05] Treating reference as 'fasta' format.
[10:29:05] Will use 8 CPU cores.
[10:29:05] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta
[10:29:05] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out
[10:29:06] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out
[10:29:06] Creating reference folder: reference
[10:29:06] Extracting FASTA and GFF from reference.
[10:29:06] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4063AA_AS.out\tSM:ESC_NA4063AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:29:06] Wrote 1 sequences to ref.fa
[10:29:06] Wrote 0 features to ref.gff
[10:29:06] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4067AA_AS.fasta into pseudo-reads
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:29:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:06] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:06] Treating reference as 'fasta' format.
[10:29:06] Will use 8 CPU cores.
[10:29:06] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta
[10:29:06] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out
[10:29:06] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out
[10:29:06] Creating reference folder: reference
[10:29:06] Extracting FASTA and GFF from reference.
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:29:06] Wrote 1 sequences to ref.fa
[10:29:06] Wrote 0 features to ref.gff
[10:29:06] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4068AA_AS.fasta into pseudo-reads

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 318
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[10:29:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 313
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:06] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[10:29:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::process] read 320078 sequences (80000346 bp)...
[10:29:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:06] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 104902 sequences (26214428 bp)...
[10:29:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 400000 records...
[10:29:07] Marked 179 heterozygous sites with 'n'
[10:29:07] Creating extra output files: BED GFF CSV TXT HTML
[10:29:07] Identified 318 variants.
[10:29:07] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out
[10:29:07] Result files:
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.aligned.fa
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.bam
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.bam.bai
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.bed
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.consensus.fa
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.consensus.subs.fa
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.csv
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.filt.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.gff
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.html
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.log
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.raw.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.subs.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.tab
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.txt
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.vcf.gz
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out/snps.vcf.gz.csi
[10:29:07] Walltime used: 22 seconds
[10:29:07] Wishing you a life free of homopolymer errors.
[10:29:07] Done.
[Thu Sep 10 10:29:07 2020]
Finished job 32.
74 of 107 steps (69%) done

[Thu Sep 10 10:29:07 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out
    jobid: 2
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4004AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3980AA_AS.out\tSM:ESC_NA3980AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.141 sec; CPU: 50.751 sec
[samclip] Total SAM records 426392, removed 1364, allowed 133, passed 425028
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:07] Marked 389 heterozygous sites with 'n'
[10:29:07] Creating extra output files: BED GFF CSV TXT HTML
[10:29:07] Identified 313 variants.
[10:29:07] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out
[10:29:07] Result files:
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.aligned.fa
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.bam
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.bam.bai
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.bed
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.consensus.fa
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.consensus.subs.fa
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.csv
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.filt.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.gff
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.html
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.log
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.raw.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.subs.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.tab
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.txt
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.vcf
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.vcf.gz
[10:29:07] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out/snps.vcf.gz.csi
[10:29:07] Walltime used: 24 seconds
[10:29:07] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:29:07] Done.
[Thu Sep 10 10:29:07 2020]
Finished job 38.
75 of 107 steps (70%) done

[Thu Sep 10 10:29:07 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out
    jobid: 72
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4045AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta
[M::mem_process_seqs] Processed 320026 reads in 37.339 CPU sec, 5.332 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:08] This is snippy 4.4.3
[10:29:08] Written by Torsten Seemann
[10:29:08] Obtained from https://github.com/tseemann/snippy
[10:29:08] Detected operating system: linux
[10:29:08] Enabling bundled linux tools.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:08] Found gzip - /usr/bin/gzip
[samclip] Processed 100000 records...
[10:29:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:08] This is snippy 4.4.3
[10:29:08] Written by Torsten Seemann
[10:29:08] Obtained from https://github.com/tseemann/snippy
[10:29:08] Detected operating system: linux
[10:29:08] Enabling bundled linux tools.
[10:29:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::mem_process_seqs] Processed 108184 reads in 11.134 CPU sec, 1.547 real sec
[10:29:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:08] Found gzip - /usr/bin/gzip
[10:29:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[10:29:09] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320048 reads in 36.432 CPU sec, 7.520 real sec
[10:29:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:09] Wrote 423074 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:09] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:09] Using BAM RG (Read Group) ID: ESC_NA4067AA_AS.out
[10:29:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[samclip] Processed 300000 records...
[10:29:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:09] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:09] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:09] Treating reference as 'fasta' format.
[10:29:09] Treating reference as 'fasta' format.
[10:29:09] Will use 8 CPU cores.
[10:29:09] Will use 8 CPU cores.
[10:29:09] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta
[10:29:09] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta
[10:29:09] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out
[10:29:09] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:09] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out
[10:29:09] Creating reference folder: reference
[10:29:09] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out
[10:29:09] Extracting FASTA and GFF from reference.
[10:29:09] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out
[10:29:09] Creating reference folder: reference
[10:29:09] Extracting FASTA and GFF from reference.
[10:29:09] Wrote 1 sequences to ref.fa
[10:29:09] Wrote 0 features to ref.gff
[10:29:09] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4004AA_AS.fasta into pseudo-reads
[10:29:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:09] Wrote 1 sequences to ref.fa
[10:29:09] Wrote 0 features to ref.gff
[10:29:09] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4045AA_AS.fasta into pseudo-reads
[10:29:09] Wrote 422066 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:09] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:09] Using BAM RG (Read Group) ID: ESC_NA4068AA_AS.out
[10:29:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:09] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[samclip] Processed 400000 records...
[10:29:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4048AA_AS.out\tSM:ESC_NA4048AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 8.348 sec; CPU: 49.138 sec
[10:29:09] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4067AA_AS.out\tSM:ESC_NA4067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] Total SAM records 428350, removed 1680, allowed 76, passed 426670
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[10:29:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:10] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4068AA_AS.out\tSM:ESC_NA4068AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 307
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 320052 sequences (80000474 bp)...
[samclip] Processed 200000 records...
[10:29:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320084 sequences (80000346 bp)...
[M::mem_process_seqs] Processed 109184 reads in 14.029 CPU sec, 1.777 real sec
[10:29:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 101982 sequences (25478552 bp)...
[10:29:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[10:29:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:11] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_GA5350AA_AS.out\tSM:ESC_GA5350AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.993 sec; CPU: 51.100 sec
[samclip] Total SAM records 429331, removed 1837, allowed 102, passed 427494
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:12] Marked 160 heterozygous sites with 'n'
[10:29:12] Creating extra output files: BED GFF CSV TXT HTML
[10:29:12] Identified 307 variants.
[10:29:12] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out
[10:29:12] Result files:
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.aligned.fa
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.bam
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.bam.bai
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.bed
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.consensus.fa
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.consensus.subs.fa
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.csv
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.filt.vcf
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.gff
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.html
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.log
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.raw.vcf
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.subs.vcf
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.tab
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.txt
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.vcf
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.vcf.gz
[10:29:12] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out/snps.vcf.gz.csi
[10:29:12] Walltime used: 21 seconds
[10:29:12] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:29:12] Done.
[Thu Sep 10 10:29:12 2020]
Finished job 94.
76 of 107 steps (71%) done

[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Thu Sep 10 10:29:12 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out
    jobid: 24
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4055AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta
[M::process] read 103022 sequences (25738346 bp)...
[10:29:12] Running: samtools index snps.bam 2>> snps.log
[10:29:13] Wrote 423584 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:13] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:13] Using BAM RG (Read Group) ID: ESC_NA4004AA_AS.out
[10:29:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:13] Wrote 424214 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:13] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:13] Using BAM RG (Read Group) ID: ESC_NA4045AA_AS.out
[10:29:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:13] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:13] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:13] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4004AA_AS.out\tSM:ESC_NA4004AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:29:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:13] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4045AA_AS.out\tSM:ESC_NA4045AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::process] read 320096 sequences (80000260 bp)...
[M::process] read 320028 sequences (80000132 bp)...
[10:29:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 103488 sequences (25864382 bp)...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 41
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320078 reads in 44.608 CPU sec, 8.314 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 100000 records...
[10:29:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:16] Running: samtools index snps.bam 2>> snps.log
[10:29:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:16] This is snippy 4.4.3
[10:29:16] Written by Torsten Seemann
[10:29:16] Obtained from https://github.com/tseemann/snippy
[10:29:16] Detected operating system: linux
[10:29:16] Enabling bundled linux tools.
[10:29:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:16] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:17] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:17] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:17] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:17] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:17] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:17] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:17] Found gzip - /usr/bin/gzip
[10:29:17] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:17] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:17] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:17] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:17] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:17] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 104902 reads in 12.528 CPU sec, 2.469 real sec
[samclip] Processed 200000 records...
[10:29:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 104186 sequences (26036904 bp)...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:17] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:17] Marked 177 heterozygous sites with 'n'
[10:29:17] Creating extra output files: BED GFF CSV TXT HTML
[10:29:17] Identified 41 variants.
[10:29:17] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out
[10:29:17] Result files:
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.aligned.fa
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.bam
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.bam.bai
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.bed
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.consensus.fa
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.consensus.subs.fa
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.csv
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.filt.vcf
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.gff
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.html
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.log
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.raw.vcf
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.subs.vcf
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.tab
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.txt
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.vcf
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.vcf.gz
[10:29:17] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out/snps.vcf.gz.csi
[10:29:17] Walltime used: 20 seconds
[10:29:17] Questionable SNP? Try the --report option to see the alignments.
[10:29:17] Done.
[Thu Sep 10 10:29:17 2020]
Finished job 22.
77 of 107 steps (72%) done

[Thu Sep 10 10:29:17 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out
    jobid: 92
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4072AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta
[10:29:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:17] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:17] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:17] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:17] Treating reference as 'fasta' format.
[10:29:17] Will use 8 CPU cores.
[10:29:17] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta
[10:29:17] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out
[10:29:17] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out
[10:29:17] Creating reference folder: reference
[10:29:17] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[10:29:17] Wrote 1 sequences to ref.fa
[10:29:17] Wrote 0 features to ref.gff
[10:29:17] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4055AA_AS.fasta into pseudo-reads
[10:29:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:18] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:18] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[10:29:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:18] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4063AA_AS.out\tSM:ESC_NA4063AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.113 sec; CPU: 57.874 sec
[samclip] Total SAM records 425120, removed 1558, allowed 141, passed 423562
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320052 reads in 36.286 CPU sec, 7.889 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:19] Marked 191 heterozygous sites with 'n'
[10:29:19] Creating extra output files: BED GFF CSV TXT HTML
[10:29:19] Identified 19 variants.
[10:29:19] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out
[10:29:19] Result files:
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.aligned.fa
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.bam
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.bam.bai
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.bed
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.consensus.fa
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.consensus.subs.fa
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.csv
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.filt.vcf
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.gff
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.html
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.log
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.raw.vcf
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.subs.vcf
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.tab
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.txt
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.vcf
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.vcf.gz
[10:29:19] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out/snps.vcf.gz.csi
[10:29:19] Walltime used: 23 seconds
[10:29:19] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:29:19] Done.
[Thu Sep 10 10:29:19 2020]
Finished job 54.
78 of 107 steps (73%) done

[Thu Sep 10 10:29:19 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out
    jobid: 48
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4069AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta
[10:29:19] This is snippy 4.4.3
[10:29:19] Written by Torsten Seemann
[10:29:19] Obtained from https://github.com/tseemann/snippy
[10:29:19] Detected operating system: linux
[10:29:19] Enabling bundled linux tools.
[10:29:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::mem_process_seqs] Processed 320084 reads in 45.544 CPU sec, 8.567 real sec
[10:29:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[samclip] Processed 100000 records...
[10:29:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:19] Found gzip - /usr/bin/gzip
[10:29:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 100000 records...
[10:29:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 103022 reads in 11.781 CPU sec, 1.696 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[10:29:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:20] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:20] Treating reference as 'fasta' format.
[10:29:20] Will use 8 CPU cores.
[10:29:20] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta
[10:29:20] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out
[10:29:20] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out
[10:29:20] Creating reference folder: reference
[10:29:20] Extracting FASTA and GFF from reference.
[10:29:20] Wrote 1 sequences to ref.fa
[10:29:20] Wrote 0 features to ref.gff
[10:29:20] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4072AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 101982 reads in 10.647 CPU sec, 1.686 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4067AA_AS.out\tSM:ESC_NA4067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.108 sec; CPU: 48.832 sec
[samclip] Total SAM records 423214, removed 1366, allowed 106, passed 421848
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:21] Running: samtools index snps.bam 2>> snps.log
[10:29:21] Wrote 423406 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:21] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:21] Using BAM RG (Read Group) ID: ESC_NA4055AA_AS.out
[10:29:21] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:21] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:29:21] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:21] This is snippy 4.4.3
[10:29:21] Written by Torsten Seemann
[10:29:21] Obtained from https://github.com/tseemann/snippy
[10:29:21] Detected operating system: linux
[10:29:21] Enabling bundled linux tools.
[10:29:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:21] Found gzip - /usr/bin/gzip
[10:29:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::mem_process_seqs] Processed 320096 reads in 37.877 CPU sec, 7.853 real sec
[10:29:21] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4055AA_AS.out\tSM:ESC_NA4055AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[10:29:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4068AA_AS.out\tSM:ESC_NA4068AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.388 sec; CPU: 56.865 sec
[samclip] Total SAM records 422206, removed 1361, allowed 102, passed 420845
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:22] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:22] Treating reference as 'fasta' format.
[10:29:22] Will use 8 CPU cores.
[10:29:22] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta
[10:29:22] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out
[10:29:22] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out
[samclip] Processed 100000 records...
[10:29:22] Creating reference folder: reference
[10:29:22] Extracting FASTA and GFF from reference.
[10:29:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:29:22] Wrote 1 sequences to ref.fa
[10:29:22] Wrote 0 features to ref.gff
[10:29:22] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4069AA_AS.fasta into pseudo-reads
[M::process] read 320254 sequences (80000248 bp)...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 323
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 103152 sequences (25771738 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 200000 records...
[10:29:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 103488 reads in 11.944 CPU sec, 1.532 real sec
[10:29:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[10:29:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:23] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:23] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4004AA_AS.out\tSM:ESC_NA4004AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.297 sec; CPU: 50.512 sec
[samclip] Total SAM records 423725, removed 1337, allowed 132, passed 422388
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320028 reads in 38.114 CPU sec, 9.999 real sec
[10:29:23] Marked 148 heterozygous sites with 'n'
[10:29:23] Creating extra output files: BED GFF CSV TXT HTML
[10:29:23] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:24] Identified 323 variants.
[10:29:24] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out
[10:29:24] Result files:
[10:29:24] Wrote 422708 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:24] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:24] Using BAM RG (Read Group) ID: ESC_NA4072AA_AS.out
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.aligned.fa
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.bam
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.bam.bai
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.bed
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.consensus.fa
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.consensus.subs.fa
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.csv
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.filt.vcf
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.gff
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.html
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.log
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.raw.vcf
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.subs.vcf
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.tab
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.txt
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.vcf
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.vcf.gz
[10:29:24] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out/snps.vcf.gz.csi
[10:29:24] Walltime used: 23 seconds
[10:29:24] Questionable SNP? Try the --report option to see the alignments.
[10:29:24] Done.
[10:29:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[Thu Sep 10 10:29:24 2020]
Finished job 26.
79 of 107 steps (74%) done

[Thu Sep 10 10:29:24 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out
    jobid: 28
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3974AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta
[10:29:24] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:24] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:24] Running: samtools index snps.bam 2>> snps.log
[10:29:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:24] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4072AA_AS.out\tSM:ESC_NA4072AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:24] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 200000 records...
[M::process] read 320052 sequences (80000002 bp)...
[M::mem_process_seqs] Processed 104186 reads in 12.766 CPU sec, 1.609 real sec
[10:29:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 315
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 102656 sequences (25661008 bp)...
[10:29:25] Wrote 423802 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:25] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:25] Using BAM RG (Read Group) ID: ESC_NA4069AA_AS.out
[10:29:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:29:25] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:26] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4069AA_AS.out\tSM:ESC_NA4069AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:26] Running: samtools index snps.bam 2>> snps.log
[10:29:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:29:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Found 1 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4045AA_AS.out\tSM:ESC_NA4045AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.851 sec; CPU: 51.532 sec
[samclip] Total SAM records 424356, removed 1379, allowed 159, passed 422977
[samclip] Header contained 3 lines
[samclip] Done.

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 315
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:26] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320084 sequences (80000282 bp)...
[10:29:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:26] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:29:27] Running: bcftools index -f snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 314
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:27] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:27] Marked 151 heterozygous sites with 'n'
[10:29:27] Creating extra output files: BED GFF CSV TXT HTML
[10:29:27] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:27] Identified 315 variants.
[10:29:27] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out
[10:29:27] Result files:
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.aligned.fa
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.bam
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.bam.bai
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.bed
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.consensus.fa
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.consensus.subs.fa
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.csv
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.filt.vcf
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.gff
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.html
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.log
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.raw.vcf
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.subs.vcf
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.tab
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.txt
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.vcf
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.vcf.gz
[10:29:27] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out/snps.vcf.gz.csi
[10:29:27] Walltime used: 24 seconds
[10:29:27] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:29:27] Done.
[Thu Sep 10 10:29:27 2020]
Finished job 74.
80 of 107 steps (75%) done

[Thu Sep 10 10:29:27 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out
    jobid: 50
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_HA6411AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta
[10:29:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:27] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:27] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:27] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:28] Marked 171 heterozygous sites with 'n'
[10:29:28] Creating extra output files: BED GFF CSV TXT HTML
[10:29:28] Identified 315 variants.
[10:29:28] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out
[10:29:28] Result files:
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.aligned.fa
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.bam
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.bam.bai
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.bed
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.consensus.fa
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.consensus.subs.fa
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.csv
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.filt.vcf
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.gff
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.html
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.log
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.raw.vcf
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.subs.vcf
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.tab
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.txt
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.vcf
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.vcf.gz
[10:29:28] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out/snps.vcf.gz.csi
[10:29:28] Walltime used: 25 seconds
[10:29:28] Wishing you a life free of homopolymer errors.
[10:29:28] Done.
[Thu Sep 10 10:29:28 2020]
Finished job 76.
81 of 107 steps (76%) done

[Thu Sep 10 10:29:28 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out
    jobid: 62
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4003AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta
[M::process] read 103718 sequences (25916210 bp)...
[10:29:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:28] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:28] Running: samtools index snps.bam 2>> snps.log
[10:29:29] Marked 164 heterozygous sites with 'n'
[10:29:29] Creating extra output files: BED GFF CSV TXT HTML
[10:29:29] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:29] Identified 314 variants.
[10:29:29] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out
[10:29:29] Result files:
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.aligned.fa
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.bam
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.bam.bai
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.bed
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.consensus.fa
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.consensus.subs.fa
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.csv
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.filt.vcf
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.gff
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.html
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.log
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.raw.vcf
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.subs.vcf
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.tab
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.txt
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.vcf
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.vcf.gz
[10:29:29] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out/snps.vcf.gz.csi
[10:29:29] Walltime used: 21 seconds
[10:29:29] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[10:29:29] Done.
[Thu Sep 10 10:29:29 2020]
Finished job 2.
82 of 107 steps (77%) done

[Thu Sep 10 10:29:29 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out
    jobid: 4
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4000AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta
[10:29:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:29] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 316
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:29] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:30] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:30] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320254 reads in 53.559 CPU sec, 8.382 real sec
[10:29:30] This is snippy 4.4.3
[10:29:30] Written by Torsten Seemann
[10:29:30] Obtained from https://github.com/tseemann/snippy
[10:29:30] Detected operating system: linux
[10:29:30] Enabling bundled linux tools.
[10:29:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:31] Found gzip - /usr/bin/gzip
[10:29:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:31] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:31] This is snippy 4.4.3
[10:29:31] Written by Torsten Seemann
[10:29:31] Obtained from https://github.com/tseemann/snippy
[10:29:31] Detected operating system: linux
[10:29:31] Enabling bundled linux tools.
[10:29:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:31] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:31] This is snippy 4.4.3
[10:29:31] Written by Torsten Seemann
[10:29:31] Obtained from https://github.com/tseemann/snippy
[10:29:31] Detected operating system: linux
[10:29:31] Enabling bundled linux tools.
[10:29:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:31] Found gzip - /usr/bin/gzip
[10:29:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[samclip] Processed 100000 records...
[10:29:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:31] Found gzip - /usr/bin/gzip
[10:29:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:31] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:31] Treating reference as 'fasta' format.
[10:29:31] Will use 8 CPU cores.
[10:29:31] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta
[10:29:31] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out
[10:29:31] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out
[10:29:31] Creating reference folder: reference
[10:29:31] Extracting FASTA and GFF from reference.
[10:29:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:31] Marked 179 heterozygous sites with 'n'
[10:29:31] Wrote 1 sequences to ref.fa
[10:29:31] Wrote 0 features to ref.gff
[10:29:31] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3974AA_AS.fasta into pseudo-reads
[10:29:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:31] Creating extra output files: BED GFF CSV TXT HTML
[10:29:31] Identified 316 variants.
[10:29:31] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out
[10:29:31] Result files:
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.aligned.fa
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.bam
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.bam.bai
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.bed
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.consensus.fa
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.consensus.subs.fa
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.csv
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.filt.vcf
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.gff
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.html
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.log
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.raw.vcf
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.subs.vcf
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.tab
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.txt
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.vcf
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.vcf.gz
[10:29:31] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out/snps.vcf.gz.csi
[10:29:31] Walltime used: 23 seconds
[10:29:31] May the SNPs be with you.
[10:29:31] Done.
[Thu Sep 10 10:29:31 2020]
Finished job 72.
83 of 107 steps (78%) done

[Thu Sep 10 10:29:31 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out
    jobid: 80
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4005AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta
[samclip] Processed 200000 records...
[10:29:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:31] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:31] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:31] Treating reference as 'fasta' format.
[10:29:31] Will use 8 CPU cores.
[10:29:31] Treating reference as 'fasta' format.
[10:29:31] Will use 8 CPU cores.
[10:29:31] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta
[10:29:31] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out
[10:29:31] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta
[10:29:31] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out
[10:29:31] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out
[10:29:31] Creating reference folder: reference
[10:29:31] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out
[10:29:31] Creating reference folder: reference
[10:29:31] Extracting FASTA and GFF from reference.
[10:29:31] Extracting FASTA and GFF from reference.
[10:29:31] Wrote 1 sequences to ref.fa
[10:29:31] Wrote 0 features to ref.gff
[10:29:31] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_HA6411AA_AS.fasta into pseudo-reads
[10:29:31] Wrote 1 sequences to ref.fa
[10:29:31] Wrote 0 features to ref.gff
[10:29:31] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4003AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 103152 reads in 12.835 CPU sec, 1.666 real sec
[samclip] Processed 300000 records...
[10:29:32] This is snippy 4.4.3
[10:29:32] Written by Torsten Seemann
[10:29:32] Obtained from https://github.com/tseemann/snippy
[10:29:32] Detected operating system: linux
[10:29:32] Enabling bundled linux tools.
[10:29:32] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:32] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:32] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:32] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:32] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:32] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:32] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:32] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:32] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:32] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:32] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:32] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:32] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:32] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:32] Found gzip - /usr/bin/gzip
[10:29:32] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:32] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:32] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:32] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:32] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:32] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:32] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 423565, removed 1456, allowed 140, passed 422109
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4055AA_AS.out\tSM:ESC_NA4055AA_AS.out -t[samclip] Header contained 3 lines
 8 reference/ref.fa[samclip] Done.
 fake_reads.fq
[main] Real time: 10.916 sec; CPU: 67.023 sec
[10:29:32] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:32] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:32] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:32] Treating reference as 'fasta' format.
[10:29:32] Will use 8 CPU cores.
[10:29:32] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta
[10:29:32] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out
[10:29:32] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out
[10:29:32] Creating reference folder: reference
[10:29:32] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320052 reads in 46.254 CPU sec, 7.190 real sec
[10:29:32] Wrote 1 sequences to ref.fa
[10:29:32] Wrote 0 features to ref.gff
[10:29:32] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4000AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:33] This is snippy 4.4.3
[10:29:33] Written by Torsten Seemann
[10:29:33] Obtained from https://github.com/tseemann/snippy
[10:29:33] Detected operating system: linux
[10:29:33] Enabling bundled linux tools.
[10:29:33] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:33] Found gzip - /usr/bin/gzip
[10:29:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:33] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:33] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[10:29:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:34] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:34] Treating reference as 'fasta' format.
[10:29:34] Will use 8 CPU cores.
[10:29:34] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta
[10:29:34] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out
[10:29:34] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out
[10:29:34] Creating reference folder: reference
[10:29:34] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 102656 reads in 11.702 CPU sec, 1.497 real sec
[10:29:34] Wrote 1 sequences to ref.fa
[10:29:34] Wrote 0 features to ref.gff
[10:29:34] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4005AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320084 reads in 50.385 CPU sec, 7.999 real sec
[samclip] Processed 400000 records...
[10:29:34] Wrote 422150 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:34] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:34] Using BAM RG (Read Group) ID: ESC_NA3974AA_AS.out
[10:29:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:34] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4072AA_AS.out\tSM:ESC_NA4072AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 9.954 sec; CPU: 58.652 sec
[samclip] Total SAM records 422850, removed 1324, allowed 137, passed 421526
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:34] Running: samtools index snps.bam 2>> snps.log
[10:29:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[10:29:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:35] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:35] Wrote 421888 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:35] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:35] Using BAM RG (Read Group) ID: ESC_HA6411AA_AS.out
[10:29:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:35] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3974AA_AS.out\tSM:ESC_NA3974AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:35] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:35] Wrote 423204 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:35] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:35] Using BAM RG (Read Group) ID: ESC_NA4003AA_AS.out
[10:29:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:35] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[10:29:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:35] Running: bwa mem  -Y -M -R '@RG\tID:ESC_HA6411AA_AS.out\tSM:ESC_HA6411AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:35] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4003AA_AS.out\tSM:ESC_NA4003AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 320034 sequences (80000468 bp)...
[M::process] read 102116 sequences (25522104 bp)...
[M::process] read 320104 sequences (80000456 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 326
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 320040 sequences (80000112 bp)...
[10:29:35] Wrote 424712 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:35] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:35] Using BAM RG (Read Group) ID: ESC_NA4000AA_AS.out
[10:29:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:36] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:36] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4000AA_AS.out\tSM:ESC_NA4000AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 103718 reads in 16.058 CPU sec, 2.030 real sec
[10:29:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[10:29:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:36] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320090 sequences (80000324 bp)...
[samclip] Processed 400000 records...
[10:29:37] Running: samtools index snps.bam 2>> snps.log
[10:29:37] Marked 181 heterozygous sites with 'n'
[10:29:37] Creating extra output files: BED GFF CSV TXT HTML
[10:29:37] Identified 326 variants.
[10:29:37] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out
[10:29:37] Result files:
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.aligned.fa
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.bam
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.bam.bai
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.bed
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.consensus.fa
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.consensus.subs.fa
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.csv
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.filt.vcf
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.gff
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.html
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.log
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.raw.vcf
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.subs.vcf
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.tab
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.txt
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.vcf
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.vcf.gz
[10:29:37] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out/snps.vcf.gz.csi
[10:29:37] Walltime used: 21 seconds
[10:29:37] Wishing you a life free of homopolymer errors.
[10:29:37] Done.
[Thu Sep 10 10:29:37 2020]
Finished job 24.
84 of 107 steps (79%) done

[Thu Sep 10 10:29:37 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out
    jobid: 70
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA3999AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4069AA_AS.out\tSM:ESC_NA4069AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.299 sec; CPU: 67.015 sec
[samclip] Total SAM records 423942, removed 1407, allowed 105, passed 422535
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:37] Wrote 425244 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:37] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:37] Using BAM RG (Read Group) ID: ESC_NA4005AA_AS.out
[10:29:37] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:37] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:37] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:37] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:37] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:37] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:38] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4005AA_AS.out\tSM:ESC_NA4005AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[10:29:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 308
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320002 sequences (80000200 bp)...
[M::process] read 103164 sequences (25788600 bp)...
[10:29:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:39] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:39] Marked 129 heterozygous sites with 'n'
[10:29:39] Creating extra output files: BED GFF CSV TXT HTML
[10:29:40] Identified 308 variants.
[10:29:40] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out
[10:29:40] Result files:
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.aligned.fa
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.bam
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.bam.bai
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.bed
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.consensus.fa
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.consensus.subs.fa
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.csv
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.filt.vcf
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.gff
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.html
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.log
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.raw.vcf
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.subs.vcf
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.tab
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.txt
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.vcf
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.vcf.gz
[10:29:40] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out/snps.vcf.gz.csi
[10:29:40] Walltime used: 21 seconds
[10:29:40] May the SNPs be with you.
[10:29:40] Done.
[Thu Sep 10 10:29:40 2020]
Finished job 92.
85 of 107 steps (79%) done

[Thu Sep 10 10:29:40 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out
    jobid: 34
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4046AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta
[10:29:40] This is snippy 4.4.3
[10:29:40] Written by Torsten Seemann
[10:29:40] Obtained from https://github.com/tseemann/snippy
[10:29:40] Detected operating system: linux
[10:29:40] Enabling bundled linux tools.
[10:29:40] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:40] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:40] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:40] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:40] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:40] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:40] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:40] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:40] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:40] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:40] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:40] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:40] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:40] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:40] Found gzip - /usr/bin/gzip
[10:29:40] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:40] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:40] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:40] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:40] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:40] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[10:29:40] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:40] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:41] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:41] Treating reference as 'fasta' format.
[10:29:41] Will use 8 CPU cores.
[10:29:41] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta
[10:29:41] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out
[10:29:41] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out
[10:29:41] Creating reference folder: reference
[10:29:41] Extracting FASTA and GFF from reference.
[10:29:41] Wrote 1 sequences to ref.fa
[10:29:41] Wrote 0 features to ref.gff
[10:29:41] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA3999AA_AS.fasta into pseudo-reads
[10:29:41] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:41] This is snippy 4.4.3
[10:29:41] Written by Torsten Seemann
[10:29:41] Obtained from https://github.com/tseemann/snippy
[10:29:41] Detected operating system: linux
[10:29:41] Enabling bundled linux tools.
[10:29:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[10:29:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:29:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[10:29:41] Found gzip - /usr/bin/gzip
[10:29:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::process] read 104622 sequences (26140594 bp)...
[10:29:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 302
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[10:29:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:42] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:42] Treating reference as 'fasta' format.
[10:29:42] Will use 8 CPU cores.
[10:29:42] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta
[10:29:42] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out
[10:29:42] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out
[10:29:42] Creating reference folder: reference
[10:29:42] Extracting FASTA and GFF from reference.
[10:29:42] Wrote 1 sequences to ref.fa
[10:29:42] Wrote 0 features to ref.gff
[10:29:42] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4046AA_AS.fasta into pseudo-reads
[10:29:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:42] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320034 reads in 42.324 CPU sec, 7.135 real sec
[10:29:43] Marked 128 heterozygous sites with 'n'
[10:29:43] Creating extra output files: BED GFF CSV TXT HTML
[10:29:43] Identified 302 variants.
[10:29:43] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out
[10:29:43] Result files:
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.aligned.fa
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.bam
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.bam.bai
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.bed
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.consensus.fa
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.consensus.subs.fa
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.csv
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.filt.vcf
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.gff
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.html
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.log
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.raw.vcf
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.subs.vcf
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.tab
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.txt
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.vcf
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.vcf.gz
[10:29:43] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out/snps.vcf.gz.csi
[10:29:43] Walltime used: 22 seconds
[10:29:43] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:29:43] Done.
[Thu Sep 10 10:29:43 2020]
Finished job 48.
86 of 107 steps (80%) done

[Thu Sep 10 10:29:43 2020]
rule snippy_run:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out
    jobid: 42
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF, sample=ESC_NA4035AA_AS
    threads: 5

snippy --outdir /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa --ctgs /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta
[samclip] Processed 100000 records...
[10:29:44] Wrote 428090 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:44] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:44] Using BAM RG (Read Group) ID: ESC_NA3999AA_AS.out
[10:29:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[10:29:44] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[10:29:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::mem_process_seqs] Processed 102116 reads in 12.614 CPU sec, 1.851 real sec
[10:29:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:44] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA3999AA_AS.out\tSM:ESC_NA3999AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::process] read 101784 sequences (25424068 bp)...
[10:29:44] This is snippy 4.4.3
[10:29:44] Written by Torsten Seemann
[10:29:44] Obtained from https://github.com/tseemann/snippy
[10:29:44] Detected operating system: linux
[10:29:44] Enabling bundled linux tools.
[10:29:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[10:29:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[10:29:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[10:29:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[10:29:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[10:29:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[10:29:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[10:29:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[samclip] Processed 300000 records...
[10:29:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[10:29:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[10:29:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[10:29:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[10:29:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[10:29:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[10:29:45] Found gzip - /usr/bin/gzip
[M::process] read 320548 sequences (80000280 bp)...
[M::process] read 105242 sequences (26306596 bp)...
[10:29:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[10:29:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[10:29:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[10:29:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[10:29:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[10:29:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3974AA_AS.out\tSM:ESC_NA3974AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 10.194 sec; CPU: 55.661 sec
[10:29:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320040 reads in 46.645 CPU sec, 9.566 real sec
[samclip] Total SAM records 422290, removed 1307, allowed 108, passed 420983
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:45] Wrote 419186 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:45] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:45] Using BAM RG (Read Group) ID: ESC_NA4046AA_AS.out
[10:29:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[10:29:46] Running: bwa index reference/ref.fa 2>> snps.log
[10:29:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[10:29:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[10:29:46] Using reference: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
[10:29:46] Treating reference as 'fasta' format.
[10:29:46] Will use 8 CPU cores.
[10:29:46] Using read file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta
[10:29:46] Creating folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out
[10:29:46] Changing working directory: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out
[10:29:46] Creating reference folder: reference
[10:29:46] Extracting FASTA and GFF from reference.
[10:29:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] Processed 200000 records...
[10:29:46] Wrote 1 sequences to ref.fa
[10:29:46] Wrote 0 features to ref.gff
[10:29:46] Shredding /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/HC50_1106/ESC_NA4035AA_AS.fasta into pseudo-reads
[10:29:46] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4046AA_AS.out\tSM:ESC_NA4046AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::mem_process_seqs] Processed 320090 reads in 36.497 CPU sec, 10.088 real sec
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 103164 reads in 9.870 CPU sec, 2.011 real sec
[M::process] read 320042 sequences (80000116 bp)...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4003AA_AS.out\tSM:ESC_NA4003AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.932 sec; CPU: 57.077 sec
[samclip] Total SAM records 423341, removed 1298, allowed 96, passed 422043
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 104622 reads in 12.494 CPU sec, 2.027 real sec
[samclip] Processed 200000 records...
[M::process] read 99144 sequences (24770656 bp)...
[M::process] read 107542 sequences (26830384 bp)...
[10:29:49] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 300000 records...
[10:29:50] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[samclip] Processed 400000 records...
[10:29:50] Wrote 417532 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[10:29:50] Freebayes will process 15 chunks of 9830 bp, 8 chunks at a time.
[10:29:50] Using BAM RG (Read Group) ID: ESC_NA4035AA_AS.out
[10:29:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:50] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4000AA_AS.out\tSM:ESC_NA4000AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 13.637 sec; CPU: 49.706 sec
[samclip] Total SAM records 424837, removed 1394, allowed 133, passed 423443
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[10:29:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[10:29:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[10:29:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[10:29:50] Running: bwa mem  -Y -M -R '@RG\tID:ESC_NA4035AA_AS.out\tSM:ESC_NA4035AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 1 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320104 reads in 38.123 CPU sec, 14.768 real sec
[M::mem_process_seqs] Processed 320002 reads in 39.609 CPU sec, 12.144 real sec
[M::process] read 320056 sequences (80000098 bp)...
[samclip] Processed 100000 records...
[10:29:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[10:29:51] Running: samtools index snps.bam 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 100000 records...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 312
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:52] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 101784 reads in 9.527 CPU sec, 2.222 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 105242 reads in 11.934 CPU sec, 2.570 real sec
[10:29:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] Processed 300000 records...
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 300000 records...
[10:29:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 309
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 97476 sequences (24363148 bp)...
[10:29:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:53] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:53] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 400000 records...
[10:29:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_HA6411AA_AS.out\tSM:ESC_HA6411AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 18.756 sec; CPU: 48.368 sec
[samclip] Total SAM records 422032, removed 1204, allowed 162, passed 420828
[samclip] Header contained 3 lines
[samclip] Done.
[samclip] Processed 400000 records...
[10:29:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:54] Running: samtools index snps.bam 2>> snps.log
[10:29:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4005AA_AS.out\tSM:ESC_NA4005AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 16.197 sec; CPU: 52.210 sec
[samclip] Total SAM records 425387, removed 1403, allowed 128, passed 423984
[samclip] Header contained 3 lines
[samclip] Done.
[10:29:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:54] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:54] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:29:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:54] Marked 158 heterozygous sites with 'n'
[10:29:54] Creating extra output files: BED GFF CSV TXT HTML
[10:29:54] Identified 312 variants.
[10:29:54] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out
[10:29:54] Result files:
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.aligned.fa
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.bam
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.bam.bai
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.bed
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.consensus.fa
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.consensus.subs.fa
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.csv
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.filt.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.gff
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.html
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.log
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.raw.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.subs.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.tab
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.txt
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.vcf.gz
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out/snps.vcf.gz.csi
[10:29:54] Walltime used: 24 seconds
[10:29:54] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:29:54] Done.
[Thu Sep 10 10:29:54 2020]
Finished job 28.
87 of 107 steps (81%) done
[10:29:54] Marked 181 heterozygous sites with 'n'
[10:29:54] Creating extra output files: BED GFF CSV TXT HTML
[10:29:54] Identified 309 variants.
[10:29:54] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out
[10:29:54] Result files:
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.aligned.fa
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.bam
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.bam.bai
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.bed
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.consensus.fa
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.consensus.subs.fa
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.csv
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.filt.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.gff
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.html
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.log
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.raw.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.subs.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.tab
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.txt
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.vcf
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.vcf.gz
[10:29:54] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out/snps.vcf.gz.csi
[10:29:54] Walltime used: 23 seconds
[10:29:54] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[10:29:54] Done.
[Thu Sep 10 10:29:54 2020]
Finished job 62.
88 of 107 steps (82%) done
[10:29:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 307
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:29:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320548 reads in 36.234 CPU sec, 9.759 real sec
[10:29:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:55] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:55] Marked 144 heterozygous sites with 'n'
[10:29:55] Creating extra output files: BED GFF CSV TXT HTML
[10:29:55] Identified 307 variants.
[10:29:55] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out
[10:29:55] Result files:
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.aligned.fa
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.bam
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.bam.bai
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.bed
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.consensus.fa
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.consensus.subs.fa
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.csv
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.filt.vcf
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.gff
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.html
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.log
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.raw.vcf
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.subs.vcf
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.tab
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.txt
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.vcf
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.vcf.gz
[10:29:55] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out/snps.vcf.gz.csi
[10:29:55] Walltime used: 23 seconds
[10:29:55] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:29:55] Done.
[Thu Sep 10 10:29:55 2020]
Finished job 4.
89 of 107 steps (83%) done
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320042 reads in 40.854 CPU sec, 8.235 real sec
[M::mem_process_seqs] Processed 107542 reads in 13.363 CPU sec, 1.818 real sec
[10:29:56] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[10:29:57] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:57] Running: samtools index snps.bam 2>> snps.log
[10:29:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[10:29:57] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 99144 reads in 10.745 CPU sec, 1.550 real sec
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[10:29:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA3999AA_AS.out\tSM:ESC_NA3999AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 12.868 sec; CPU: 50.283 sec
[samclip] Total SAM records 428215, removed 1358, allowed 99, passed 426857
[samclip] Header contained 3 lines
[samclip] Done.

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 305
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[10:29:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 320
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:29:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:29:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 400000 records...
[10:29:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4046AA_AS.out\tSM:ESC_NA4046AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 11.015 sec; CPU: 52.258 sec
[samclip] Total SAM records 419226, removed 932, allowed 83, passed 418294
[samclip] Header contained 3 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:29:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:29:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:29:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:29:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:29:58] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320056 reads in 41.600 CPU sec, 7.606 real sec
[10:29:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:29:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:29:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[10:29:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:29:58] Running: rm -f fake_reads\.fq 2>> snps.log
[10:29:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:29:59] Marked 163 heterozygous sites with 'n'
[10:29:59] Creating extra output files: BED GFF CSV TXT HTML
[10:29:59] Identified 305 variants.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:29:59] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out
[10:29:59] Result files:
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.aligned.fa
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.bam
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.bam.bai
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.bed
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.consensus.fa
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.consensus.subs.fa
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.csv
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.filt.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.gff
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.html
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.log
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.raw.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.subs.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.tab
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.txt
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.vcf.gz
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out/snps.vcf.gz.csi
[10:29:59] Walltime used: 28 seconds
[10:29:59] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:29:59] Done.
[Thu Sep 10 10:29:59 2020]
Finished job 50.
90 of 107 steps (84%) done
[samclip] Processed 200000 records...
[10:29:59] Marked 161 heterozygous sites with 'n'
[10:29:59] Creating extra output files: BED GFF CSV TXT HTML
[10:29:59] Identified 320 variants.
[10:29:59] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out
[10:29:59] Result files:
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.aligned.fa
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.bam
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.bam.bai
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.bed
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.consensus.fa
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.consensus.subs.fa
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.csv
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.filt.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.gff
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.html
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.log
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.raw.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.subs.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.tab
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.txt
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.vcf
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.vcf.gz
[10:29:59] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out/snps.vcf.gz.csi
[10:29:59] Walltime used: 26 seconds
[10:29:59] Questionable SNP? Try the --report option to see the alignments.
[10:29:59] Done.
[samclip] Processed 300000 records...
[Thu Sep 10 10:29:59 2020]
Finished job 80.
91 of 107 steps (85%) done
[10:29:59] Running: samtools index snps.bam 2>> snps.log
[10:29:59] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:29:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:30:00] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 97476 reads in 12.870 CPU sec, 1.563 real sec
[10:30:00] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:30:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[10:30:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] Processed 400000 records...
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:ESC_NA4035AA_AS.out\tSM:ESC_NA4035AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 9.942 sec; CPU: 55.020 sec
[samclip] Total SAM records 417709, removed 1610, allowed 119, passed 416099
[samclip] Header contained 3 lines
[samclip] Done.

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 308
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:30:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:30:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:30:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 125
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:30:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:30:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:30:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[10:30:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:30:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:30:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:30:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:30:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:30:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:30:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[10:30:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:30:00] Running: rm -f fake_reads\.fq 2>> snps.log
[10:30:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[10:30:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:30:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:30:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:30:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[10:30:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[10:30:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[10:30:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:30:01] Running: rm -f fake_reads\.fq 2>> snps.log
[10:30:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[10:30:01] Marked 182 heterozygous sites with 'n'
[10:30:01] Creating extra output files: BED GFF CSV TXT HTML
[10:30:01] Identified 308 variants.
[10:30:01] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out
[10:30:01] Result files:
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.aligned.fa
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.bam
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.bam.bai
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.bed
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.consensus.fa
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.consensus.subs.fa
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.csv
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.filt.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.gff
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.html
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.log
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.raw.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.subs.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.tab
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.txt
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.vcf.gz
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out/snps.vcf.gz.csi
[10:30:01] Walltime used: 21 seconds
[10:30:01] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[10:30:01] Done.
[Thu Sep 10 10:30:01 2020]
Finished job 70.
92 of 107 steps (86%) done
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[10:30:01] Marked 1 heterozygous sites with 'n'
[10:30:01] Creating extra output files: BED GFF CSV TXT HTML
[10:30:01] Identified 125 variants.
[10:30:01] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out
[10:30:01] Result files:
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.aligned.fa
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.bam
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.bam.bai
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.bed
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.consensus.fa
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.consensus.subs.fa
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.csv
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.filt.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.gff
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.html
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.log
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.raw.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.subs.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.tab
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.txt
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.vcf
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.vcf.gz
[10:30:01] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out/snps.vcf.gz.csi
[10:30:01] Walltime used: 20 seconds
[10:30:01] Questionable SNP? Try the --report option to see the alignments.
[10:30:01] Done.
[Thu Sep 10 10:30:01 2020]
Finished job 34.
93 of 107 steps (87%) done

[Thu Sep 10 10:30:01 2020]
rule snippy_core:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.full.aln
    jobid: 105
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome
    threads: 32


        snippy-core --prefix /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/*.out
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
This is snippy-core 4.4.3
Obtained from http://github.com/tseemann/snippy
Enabling bundled tools.
Found any2fasta - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/binaries/noarch/any2fasta
Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
Found minimap2 - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/minimap2
Found bedtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bedtools
Found snp-sites - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snp-sites
Saving reference FASTA: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.ref.fa
[10:30:02] Running: samtools index snps.bam 2>> snps.log
This is any2fasta 0.4.2
Opening '/projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa'
Detected FASTA format
[10:30:02] Running: fasta_generate_regions.py reference/ref.fa.fai 9830 > reference/ref.txt 2>> snps.log
[10:30:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Read 65164 lines from '/projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/AVC171_chromosome.fa'
Wrote 1 sequences from FASTA file.
Processed 1 files.
Done.
[10:30:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 316
       total no. reference observed             : 0

Time elapsed: 0.00s

[10:30:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[10:30:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
Loaded 1 sequences totalling 5213028 bp.
Will mask 0 regions totalling 0 bp ~ 0.00%
0	ESC_BA8511AA_AS.out	snp=4041	del=110	ins=43	het=203	unaligned=386559
1	ESC_GA5350AA_AS.out	snp=3737	del=84	ins=29	het=278	unaligned=360208
2	ESC_GB6943AA_AS.out	snp=4008	del=56	ins=51	het=226	unaligned=384137
3	ESC_HA6332AA_AS.out	snp=4080	del=158	ins=41	het=683	unaligned=346961
[10:30:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
4	ESC_HA6342AA_AS.out	snp=3876	del=98	ins=58	het=382	unaligned=334699
[10:30:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
5	ESC_HA6411AA_AS.out	snp=3937	del=110	ins=46	het=202	unaligned=388699
[10:30:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[10:30:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[10:30:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
6	ESC_HA6413AA_AS.out	snp=3879	del=146	ins=58	het=423	unaligned=336654
[10:30:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
7	ESC_HA6418AA_AS.out	snp=3841	del=76	ins=36	het=459	unaligned=334749
8	ESC_HA6420AA_AS.out	snp=3937	del=62	ins=50	het=259	unaligned=393877
[10:30:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
9	ESC_HB8007AA_AS.out	snp=4248	del=116	ins=35	het=316	unaligned=384807
[10:30:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[10:30:03] Running: rm -f fake_reads\.fq 2>> snps.log
10	ESC_IA0811AA_AS.out	snp=3884	del=56	ins=32	het=368	unaligned=340357
[10:30:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
11	ESC_NA3971AA_AS.out	snp=4118	del=66	ins=61	het=182	unaligned=435496
12	ESC_NA3973AA_AS.out	snp=4106	del=98	ins=47	het=229	unaligned=408355
13	ESC_NA3974AA_AS.out	snp=3927	del=54	ins=46	het=212	unaligned=402399
14	ESC_NA3975AA_AS.out	snp=3925	del=57	ins=51	het=204	unaligned=397590
15	ESC_NA3980AA_AS.out	snp=4001	del=60	ins=47	het=215	unaligned=424678
[10:30:03] Marked 151 heterozygous sites with 'n'
[10:30:03] Creating extra output files: BED GFF CSV TXT HTML
[10:30:03] Identified 316 variants.
[10:30:03] Result folder: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out
[10:30:03] Result files:
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.aligned.fa
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.bam
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.bam.bai
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.bed
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.consensus.fa
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.consensus.subs.fa
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.csv
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.filt.vcf
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.gff
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.html
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.log
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.raw.vcf
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.subs.vcf
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.tab
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.txt
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.vcf
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.vcf.gz
[10:30:03] * /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out/snps.vcf.gz.csi
[10:30:03] Walltime used: 19 seconds
[10:30:03] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[10:30:03] Done.
16	ESC_NA3982AA_AS.out	snp=3948	del=108	ins=51	het=171	unaligned=391929
[Thu Sep 10 10:30:03 2020]
Finished job 42.
94 of 107 steps (88%) done
17	ESC_NA3992AA_AS.out	snp=3921	del=57	ins=51	het=221	unaligned=389244
18	ESC_NA3999AA_AS.out	snp=3794	del=94	ins=44	het=180	unaligned=441643
19	ESC_NA4000AA_AS.out	snp=3905	del=103	ins=39	het=207	unaligned=428228
20	ESC_NA4003AA_AS.out	snp=3889	del=53	ins=49	het=213	unaligned=423167
21	ESC_NA4004AA_AS.out	snp=3910	del=102	ins=52	het=198	unaligned=399558
22	ESC_NA4005AA_AS.out	snp=3840	del=103	ins=39	het=200	unaligned=423894
23	ESC_NA4035AA_AS.out	snp=3857	del=50	ins=33	het=183	unaligned=348979
24	ESC_NA4045AA_AS.out	snp=3912	del=97	ins=48	het=182	unaligned=405256
25	ESC_NA4046AA_AS.out	snp=3926	del=56	ins=50	het=132	unaligned=415429
26	ESC_NA4048AA_AS.out	snp=4185	del=125	ins=92	het=260	unaligned=405407
27	ESC_NA4052AA_AS.out	snp=4043	del=56	ins=49	het=349	unaligned=386112
28	ESC_NA4053AA_AS.out	snp=4000	del=57	ins=61	het=365	unaligned=406383
29	ESC_NA4055AA_AS.out	snp=3908	del=93	ins=49	het=213	unaligned=390064
30	ESC_NA4056AA_AS.out	snp=3914	del=98	ins=56	het=211	unaligned=394407
31	ESC_NA4061AA_AS.out	snp=3917	del=64	ins=50	het=182	unaligned=395529
32	ESC_NA4063AA_AS.out	snp=3934	del=105	ins=50	het=203	unaligned=402394
33	ESC_NA4064AA_AS.out	snp=3839	del=166	ins=57	het=105	unaligned=405460
34	ESC_NA4066AA_AS.out	snp=3854	del=54	ins=50	het=132	unaligned=384505
35	ESC_NA4067AA_AS.out	snp=3953	del=53	ins=44	het=221	unaligned=394585
36	ESC_NA4068AA_AS.out	snp=3938	del=103	ins=50	het=188	unaligned=393631
37	ESC_NA4069AA_AS.out	snp=3872	del=62	ins=48	het=194	unaligned=405163
38	ESC_NA4070AA_AS.out	snp=3946	del=55	ins=51	het=254	unaligned=399261
39	ESC_NA4071AA_AS.out	snp=4331	del=76	ins=65	het=427	unaligned=377480
40	ESC_NA4072AA_AS.out	snp=3898	del=53	ins=53	het=209	unaligned=403123
41	ESC_SA8250AA_AS.out	snp=117	del=25	ins=3	het=50	unaligned=200348
42	ESC_SA8273AA_AS.out	snp=117	del=13	ins=5	het=182	unaligned=203363
43	ESC_SA8291AA_AS.out	snp=3950	del=52	ins=63	het=211	unaligned=394619
44	ESC_SA8296AA_AS.out	snp=3918	del=51	ins=60	het=176	unaligned=394545
45	ESC_SA8312AA_AS.out	snp=4123	del=121	ins=35	het=661	unaligned=385153
46	ESC_VA0598AA_AS.out	snp=3978	del=111	ins=37	het=305	unaligned=383004
Opening: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.tab
Opening: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.vcf
Processing contig: AVC171_chromosome
Generating /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.full.aln
Creating TSV file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.txt
Running: snp-sites -c -o /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.aln /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.full.aln
The Snippy manual is at http://github.com/tseemann/snippy/blob/master/README.md
Done.
[Thu Sep 10 10:30:11 2020]
Finished job 105.
95 of 107 steps (89%) done

[Thu Sep 10 10:30:11 2020]
rule snippy_clean:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.full.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.clean.full.aln
    jobid: 103
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome
    threads: 32

snippy-clean_full_aln /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.full.aln > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.clean.full.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Thu Sep 10 10:30:20 2020]
Finished job 103.
96 of 107 steps (90%) done

[Thu Sep 10 10:30:20 2020]
rule gubbins:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.clean.full.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/AVC171_chromosome.filtered_polymorphic_sites.fasta
    jobid: 101
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome
    threads: 32


        run_gubbins.py -v -f 25 -p /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/AVC171_chromosome /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/AVC171_chromosome.clean.full.aln
        rm AVC171_chromosome.clean.full.aln.seq.joint.txt
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/0d285378


Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 1695 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 23.41%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 distinct randomized MP trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 1695
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s AVC171_chromosome.clean.full.aln.phylip -n AVC171_chromosome.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.230 0.265 0.243 0.261 

Inference[0]: Time 13.216779 CAT-based likelihood -40340.724366, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 19.677674 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 41.198353 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 86.660230 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 174.807855 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 371.479597 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 818.822785 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -40341.157415 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.AVC171_chromosome.clean.full.iteration_1


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -40341.157415 .... 

Final GAMMA-based Score of best tree -40341.157415

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.AVC171_chromosome.clean.full.iteration_1
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.AVC171_chromosome.clean.full.iteration_1

Overall execution time: 24.853515 secs or 0.006904 hours or 0.000288 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 1695 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 23.41%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 1695
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpc2z7we21/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 19.629534 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 41.106865 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 86.466574 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 174.383356 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 370.523301 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 816.701631 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpc2z7we21/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpc2z7we21/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpc2z7we21/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 3.972473



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 718 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.39%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 718
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.AVC171_chromosome.clean.full.iteration_1.phylip -n AVC171_chromosome.clean.full.iteration_2 -t RAxML_result.AVC171_chromosome.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.211 0.291 0.299 0.199 

Inference[0]: Time 3.509504 CAT-based likelihood -8778.328920, best rearrangement setting 10


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 11.644151 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 25.686250 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 56.639322 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 125.771576 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 273.210456 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 611.610873 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.881497 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -8778.533930 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.AVC171_chromosome.clean.full.iteration_2


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -8778.533930 .... 

Final GAMMA-based Score of best tree -8778.533930

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.AVC171_chromosome.clean.full.iteration_2
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.AVC171_chromosome.clean.full.iteration_2

Overall execution time: 7.544184 secs or 0.002096 hours or 0.000087 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 1695 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 23.41%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 1695
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp9o12hja6/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 14.112296 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 26.482124 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 44.487155 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 50.198821 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 50.752519 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp9o12hja6/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp9o12hja6/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmp9o12hja6/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 3.351053



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 703 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 7.93%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 703
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.AVC171_chromosome.clean.full.iteration_2.phylip -n AVC171_chromosome.clean.full.iteration_3 -t RAxML_result.AVC171_chromosome.clean.full.iteration_2 


Partition: 0 with name: No Name Provided
Base frequencies: 0.214 0.289 0.301 0.196 

Inference[0]: Time 2.964759 CAT-based likelihood -8408.582535, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.345630 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 28.114739 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 64.264754 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 147.489470 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 330.246023 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 752.096653 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -8408.951364 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.AVC171_chromosome.clean.full.iteration_3


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -8408.951364 .... 

Final GAMMA-based Score of best tree -8408.951364

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.AVC171_chromosome.clean.full.iteration_3
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.AVC171_chromosome.clean.full.iteration_3

Overall execution time: 6.814231 secs or 0.001893 hours or 0.000079 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 1695 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 23.41%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 1695
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpc0_3cis6/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 13.766830 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 25.488468 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 41.023450 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 43.524039 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 43.782933 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpc0_3cis6/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpc0_3cis6/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpc0_3cis6/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 3.746323



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 698 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 7.87%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 698
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.AVC171_chromosome.clean.full.iteration_3.phylip -n AVC171_chromosome.clean.full.iteration_4 -t RAxML_result.AVC171_chromosome.clean.full.iteration_3 


Partition: 0 with name: No Name Provided
Base frequencies: 0.213 0.290 0.302 0.195 

Inference[0]: Time 2.384668 CAT-based likelihood -8379.528427, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.308967 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.995519 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 63.912836 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 146.532105 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 327.844999 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 746.334134 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -8379.889474 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.AVC171_chromosome.clean.full.iteration_4


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -8379.889474 .... 

Final GAMMA-based Score of best tree -8379.889263

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.AVC171_chromosome.clean.full.iteration_4
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.AVC171_chromosome.clean.full.iteration_4

Overall execution time: 6.029744 secs or 0.001675 hours or 0.000070 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 1695 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 23.41%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 1695
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpg3vqzzqb/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 13.560891 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 25.122193 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 40.616355 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 43.117977 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 43.375374 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpg3vqzzqb/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpg3vqzzqb/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpg3vqzzqb/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 3.526699



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 704 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.00%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 704
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.AVC171_chromosome.clean.full.iteration_4.phylip -n AVC171_chromosome.clean.full.iteration_5 -t RAxML_result.AVC171_chromosome.clean.full.iteration_4 


Partition: 0 with name: No Name Provided
Base frequencies: 0.212 0.289 0.301 0.197 

Inference[0]: Time 2.049352 CAT-based likelihood -8420.781774, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.298020 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.955127 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 63.789508 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 146.202505 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 327.030327 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 744.391656 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -8421.141630 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.AVC171_chromosome.clean.full.iteration_5


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -8421.141630 .... 

Final GAMMA-based Score of best tree -8421.141496

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.AVC171_chromosome.clean.full.iteration_5
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.AVC171_chromosome.clean.full.iteration_5

Overall execution time: 5.693790 secs or 0.001582 hours or 0.000066 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 1695 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 23.41%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 1695
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpgxgegsk4/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 13.856708 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 25.797718 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 42.535994 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 45.689025 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpgxgegsk4/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpgxgegsk4/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpgxgegsk4/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 3.209171

Sample ESC_BA8511AA_AS.out has missing data percentage of 8.24969672136808
Sample ESC_GA5350AA_AS.out has missing data percentage of 8.03901302659414
Sample ESC_GB6943AA_AS.out has missing data percentage of 8.221632417857721
Sample ESC_HA6332AA_AS.out has missing data percentage of 7.499940533601585
Sample ESC_HA6342AA_AS.out has missing data percentage of 7.239938093560978
Sample ESC_HA6411AA_AS.out has missing data percentage of 8.206305433233814
Sample ESC_HA6413AA_AS.out has missing data percentage of 7.27496572049872
Sample ESC_HA6418AA_AS.out has missing data percentage of 7.2244768299729065
Sample ESC_HA6420AA_AS.out has missing data percentage of 8.342924687916504
Sample ESC_HB8007AA_AS.out has missing data percentage of 8.42136278569768
Sample ESC_IA0811AA_AS.out has missing data percentage of 7.350603142741608
Sample ESC_NA3971AA_AS.out has missing data percentage of 9.706124732113466
Sample ESC_NA3973AA_AS.out has missing data percentage of 8.934807179244002
Sample ESC_NA3974AA_AS.out has missing data percentage of 8.635883022304887
Sample ESC_NA3975AA_AS.out has missing data percentage of 8.597709431063866
Sample ESC_NA3980AA_AS.out has missing data percentage of 9.119172197041719
Sample ESC_NA3982AA_AS.out has missing data percentage of 8.329093954607572
Sample ESC_NA3992AA_AS.out has missing data percentage of 8.274960349340153
Sample ESC_NA3999AA_AS.out has missing data percentage of 9.87278410935065
Sample ESC_NA4000AA_AS.out has missing data percentage of 9.462619421955916
Sample ESC_NA4003AA_AS.out has missing data percentage of 9.227746330923217
Sample ESC_NA4004AA_AS.out has missing data percentage of 8.588636009628186
Sample ESC_NA4005AA_AS.out has missing data percentage of 9.442650221713752
Sample ESC_NA4035AA_AS.out has missing data percentage of 7.478973832482772
Sample ESC_NA4045AA_AS.out has missing data percentage of 8.691052493867288
Sample ESC_NA4046AA_AS.out has missing data percentage of 8.75251389403625
Sample ESC_NA4048AA_AS.out has missing data percentage of 8.909697012945259
Sample ESC_NA4052AA_AS.out has missing data percentage of 8.581250666599143
Sample ESC_NA4053AA_AS.out has missing data percentage of 9.109753486841045
Sample ESC_NA4055AA_AS.out has missing data percentage of 8.292800268864852
Sample ESC_NA4056AA_AS.out has missing data percentage of 8.37143019373769
Sample ESC_NA4061AA_AS.out has missing data percentage of 8.407781427607908
Sample ESC_NA4063AA_AS.out has missing data percentage of 8.631490181905795
Sample ESC_NA4064AA_AS.out has missing data percentage of 8.874074722023362
Sample ESC_NA4066AA_AS.out has missing data percentage of 8.22531549801766
Sample ESC_NA4067AA_AS.out has missing data percentage of 8.397058293183923
Sample ESC_NA4068AA_AS.out has missing data percentage of 8.33713150974827
Sample ESC_NA4069AA_AS.out has missing data percentage of 8.795540710696356
Sample ESC_NA4070AA_AS.out has missing data percentage of 8.624450127641747
Sample ESC_NA4071AA_AS.out has missing data percentage of 8.269147988462752
Sample ESC_NA4072AA_AS.out has missing data percentage of 8.657655397208686
Sample ESC_SA8250AA_AS.out has missing data percentage of 4.587871003186631
Sample ESC_SA8273AA_AS.out has missing data percentage of 4.639299846461596
Sample ESC_SA8291AA_AS.out has missing data percentage of 8.530167112089174
Sample ESC_SA8296AA_AS.out has missing data percentage of 8.561262283647814
Sample ESC_SA8312AA_AS.out has missing data percentage of 8.187026810521639
Sample ESC_VA0598AA_AS.out has missing data percentage of 8.148910767408116
Sample Reference has missing data percentage of 0.0
gubbins /data/malcummi/pipelord/snplord/tmplpcg8_3h/AVC171_chromosome.clean.full.aln
1599697848
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s AVC171_chromosome.clean.full.aln.phylip -n AVC171_chromosome.clean.full.iteration_1 
1599697882
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpc2z7we21/rooted_tree.newick -n internal 
1599697886
1599697897
gubbins -r -v AVC171_chromosome.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmplpcg8_3h/AVC171_chromosome.clean.full.aln -t RAxML_result.AVC171_chromosome.clean.full.iteration_1 -m 3 AVC171_chromosome.clean.full.aln.gaps.snp_sites.aln
1599697906
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.AVC171_chromosome.clean.full.iteration_1.phylip -n AVC171_chromosome.clean.full.iteration_2 -t RAxML_result.AVC171_chromosome.clean.full.iteration_1
1599697914
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp9o12hja6/rooted_tree.newick -n internal 
1599697917
1599697928
gubbins -r -v AVC171_chromosome.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmplpcg8_3h/AVC171_chromosome.clean.full.aln -t RAxML_result.AVC171_chromosome.clean.full.iteration_2 -m 3 AVC171_chromosome.clean.full.aln.gaps.snp_sites.aln
1599697938
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.AVC171_chromosome.clean.full.iteration_2.phylip -n AVC171_chromosome.clean.full.iteration_3 -t RAxML_result.AVC171_chromosome.clean.full.iteration_2
1599697945
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpc0_3cis6/rooted_tree.newick -n internal 
1599697948
1599697959
gubbins -r -v AVC171_chromosome.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmplpcg8_3h/AVC171_chromosome.clean.full.aln -t RAxML_result.AVC171_chromosome.clean.full.iteration_3 -m 3 AVC171_chromosome.clean.full.aln.gaps.snp_sites.aln
1599697969
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.AVC171_chromosome.clean.full.iteration_3.phylip -n AVC171_chromosome.clean.full.iteration_4 -t RAxML_result.AVC171_chromosome.clean.full.iteration_3
1599697975
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpg3vqzzqb/rooted_tree.newick -n internal 
1599697978
1599697989
gubbins -r -v AVC171_chromosome.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmplpcg8_3h/AVC171_chromosome.clean.full.aln -t RAxML_result.AVC171_chromosome.clean.full.iteration_4 -m 3 AVC171_chromosome.clean.full.aln.gaps.snp_sites.aln
1599697999
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.AVC171_chromosome.clean.full.iteration_4.phylip -n AVC171_chromosome.clean.full.iteration_5 -t RAxML_result.AVC171_chromosome.clean.full.iteration_4
1599698005
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/AVC171_chromosome.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpgxgegsk4/rooted_tree.newick -n internal 
1599698008
1599698019
gubbins -r -v AVC171_chromosome.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmplpcg8_3h/AVC171_chromosome.clean.full.aln -t RAxML_result.AVC171_chromosome.clean.full.iteration_5 -m 3 AVC171_chromosome.clean.full.aln.gaps.snp_sites.aln
1599698028
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1.branch_snps.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2\.
Deleting file: ./RAxML_parsimonyTree.AVC171_chromosome.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4.phylip regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1.snp_sites.aln regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3.snp_sites.aln regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3\.
Deleting file: ./RAxML_log.AVC171_chromosome.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2.vcf regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2\.
Deleting file: ./RAxML_info.AVC171_chromosome.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2.branch_snps.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3.phylip regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2 regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2$
Deleting file: ./RAxML_info.AVC171_chromosome.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1.phylip regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1\.
Deleting file: ./RAxML_log.AVC171_chromosome.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2.gff regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2\.
Deleting file: ./RAxML_log.AVC171_chromosome.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4.gff regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4\.
Deleting file: ./RAxML_info.AVC171_chromosome.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4 regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4$
Deleting file: ./RAxML_log.AVC171_chromosome.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_info.AVC171_chromosome.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3.vcf regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1.gff regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2.snp_sites.aln regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1.stats regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1\.
Deleting file: ./RAxML_info.AVC171_chromosome.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3 regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3$
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1 regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1$
Deleting file: ./RAxML_bestTree.AVC171_chromosome.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4.snp_sites.aln regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2.stats regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_1.vcf regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_1\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4.stats regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4\.
Deleting file: ./RAxML_bestTree.AVC171_chromosome.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_bestTree.AVC171_chromosome.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3.stats regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3\.
Deleting file: ./RAxML_log.AVC171_chromosome.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3.branch_snps.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4.branch_snps.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3.tab regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_3.gff regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_3\.
Deleting file: ./RAxML_bestTree.AVC171_chromosome.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_bestTree.AVC171_chromosome.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).AVC171_chromosome.clean.full.iteration_
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_2.phylip regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_2\.
Deleting file: ./RAxML_result.AVC171_chromosome.clean.full.iteration_4.vcf regex:^RAxML_result.AVC171_chromosome.clean.full.iteration_4\.
Deleting file: ./AVC171_chromosome.clean.full.aln.phylip regex:^AVC171_chromosome.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./AVC171_chromosome.clean.full.aln.gaps.snp_sites.aln regex:^AVC171_chromosome.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./AVC171_chromosome.clean.full.aln.gaps.vcf regex:^AVC171_chromosome.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./AVC171_chromosome.clean.full.aln.gaps.phylip regex:^AVC171_chromosome.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./AVC171_chromosome.clean.full.aln.vcf regex:^AVC171_chromosome.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./AVC171_chromosome.clean.full.aln.start regex:^AVC171_chromosome.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./AVC171_chromosome.clean.full.aln.snp_sites.aln regex:^AVC171_chromosome.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
[Thu Sep 10 10:33:54 2020]
Finished job 101.
97 of 107 steps (91%) done

[Thu Sep 10 10:33:54 2020]
rule snippy_core:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.full.aln
    jobid: 106
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF
    threads: 32


        snippy-core --prefix /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF --ref /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/*.out
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
This is snippy-core 4.4.3
Obtained from http://github.com/tseemann/snippy
Enabling bundled tools.
Found any2fasta - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/binaries/noarch/any2fasta
Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
Found minimap2 - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/minimap2
Found bedtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bedtools
Found snp-sites - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snp-sites
Saving reference FASTA: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.ref.fa
This is any2fasta 0.4.2
Opening '/projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa'
Detected FASTA format
Read 1814 lines from '/projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/assemblies/AVC171/refs/pAVC171-IncF.fa'
Wrote 1 sequences from FASTA file.
Processed 1 files.
Done.
Loaded 1 sequences totalling 144998 bp.
Will mask 0 regions totalling 0 bp ~ 0.00%
0	ESC_BA8511AA_AS.out	snp=373	del=7	ins=3	het=197	unaligned=9575
1	ESC_GA5350AA_AS.out	snp=22	del=1	ins=2	het=191	unaligned=3663
2	ESC_GB6943AA_AS.out	snp=369	del=7	ins=4	het=190	unaligned=21803
3	ESC_HA6332AA_AS.out	snp=1337	del=27	ins=13	het=135	unaligned=40565
4	ESC_HA6342AA_AS.out	snp=23	del=1	ins=2	het=467	unaligned=3587
5	ESC_HA6411AA_AS.out	snp=367	del=7	ins=5	het=163	unaligned=21416
6	ESC_HA6413AA_AS.out	snp=29	del=1	ins=2	het=224	unaligned=3595
7	ESC_HA6418AA_AS.out	snp=26	del=1	ins=12	het=504	unaligned=4399
8	ESC_HA6420AA_AS.out	snp=385	del=7	ins=4	het=407	unaligned=21874
9	ESC_HB8007AA_AS.out	snp=151	del=2	ins=1	het=1228	unaligned=7394
10	ESC_IA0811AA_AS.out	snp=29	del=1	ins=2	het=219	unaligned=3586
11	ESC_NA3971AA_AS.out	snp=376	del=5	ins=4	het=389	unaligned=27882
12	ESC_NA3973AA_AS.out	snp=389	del=7	ins=4	het=172	unaligned=22541
13	ESC_NA3974AA_AS.out	snp=375	del=7	ins=4	het=158	unaligned=22060
14	ESC_NA3975AA_AS.out	snp=383	del=7	ins=4	het=178	unaligned=22028
15	ESC_NA3980AA_AS.out	snp=368	del=8	ins=4	het=160	unaligned=22077
16	ESC_NA3982AA_AS.out	snp=383	del=7	ins=4	het=166	unaligned=21530
17	ESC_NA3992AA_AS.out	snp=377	del=7	ins=4	het=170	unaligned=21842
18	ESC_NA3999AA_AS.out	snp=371	del=7	ins=4	het=182	unaligned=23660
19	ESC_NA4000AA_AS.out	snp=369	del=7	ins=4	het=144	unaligned=22352
20	ESC_NA4003AA_AS.out	snp=372	del=5	ins=4	het=181	unaligned=22774
21	ESC_NA4004AA_AS.out	snp=376	del=7	ins=4	het=164	unaligned=21521
22	ESC_NA4005AA_AS.out	snp=385	del=5	ins=4	het=161	unaligned=23705
23	ESC_NA4035AA_AS.out	snp=380	del=7	ins=5	het=151	unaligned=21637
24	ESC_NA4045AA_AS.out	snp=379	del=7	ins=4	het=179	unaligned=23249
25	ESC_NA4046AA_AS.out	snp=154	del=1	ins=10	het=1	unaligned=135626
26	ESC_NA4048AA_AS.out	snp=46	del=1	ins=1	het=177	unaligned=15932
27	ESC_NA4052AA_AS.out	snp=390	del=7	ins=4	het=216	unaligned=24727
28	ESC_NA4053AA_AS.out	snp=387	del=7	ins=4	het=227	unaligned=27481
29	ESC_NA4055AA_AS.out	snp=390	del=7	ins=4	het=181	unaligned=21632
30	ESC_NA4056AA_AS.out	snp=377	del=7	ins=4	het=166	unaligned=21494
31	ESC_NA4061AA_AS.out	snp=353	del=7	ins=4	het=163	unaligned=22925
32	ESC_NA4063AA_AS.out	snp=387	del=7	ins=4	het=148	unaligned=21412
33	ESC_NA4064AA_AS.out	snp=1358	del=40	ins=46	het=396	unaligned=76639
34	ESC_NA4066AA_AS.out	snp=399	del=7	ins=15	het=533	unaligned=18921
35	ESC_NA4067AA_AS.out	snp=380	del=5	ins=4	het=151	unaligned=21562
36	ESC_NA4068AA_AS.out	snp=380	del=7	ins=4	het=171	unaligned=21512
37	ESC_NA4069AA_AS.out	snp=360	del=7	ins=4	het=128	unaligned=22248
38	ESC_NA4070AA_AS.out	snp=380	del=7	ins=4	het=179	unaligned=21907
39	ESC_NA4071AA_AS.out	snp=382	del=7	ins=4	het=469	unaligned=22155
40	ESC_NA4072AA_AS.out	snp=372	del=5	ins=4	het=129	unaligned=22178
41	ESC_SA8250AA_AS.out	snp=34	del=15	ins=2	het=333	unaligned=1393
42	ESC_SA8273AA_AS.out	snp=30	del=1	ins=2	het=580	unaligned=1705
43	ESC_SA8291AA_AS.out	snp=375	del=7	ins=4	het=138	unaligned=21760
44	ESC_SA8296AA_AS.out	snp=371	del=7	ins=4	het=93	unaligned=21902
45	ESC_SA8312AA_AS.out	snp=1296	del=27	ins=13	het=138	unaligned=40421
46	ESC_VA0598AA_AS.out	snp=383	del=7	ins=3	het=466	unaligned=20627
Opening: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.tab
Opening: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.vcf
Processing contig: pAVC171-IncF_origin.dna
Generating /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.full.aln
Creating TSV file: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.txt
Running: snp-sites -c -o /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.aln /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.full.aln
The Snippy manual is at http://github.com/tseemann/snippy/blob/master/README.md
Done.
[Thu Sep 10 10:33:56 2020]
Finished job 106.
98 of 107 steps (92%) done

[Thu Sep 10 10:33:56 2020]
rule snippy_clean:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.full.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.clean.full.aln
    jobid: 104
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF
    threads: 32

snippy-clean_full_aln /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.full.aln > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.clean.full.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Thu Sep 10 10:33:57 2020]
Finished job 104.
99 of 107 steps (93%) done

[Thu Sep 10 10:33:57 2020]
rule gubbins:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.clean.full.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/pAVC171-IncF.filtered_polymorphic_sites.fasta
    jobid: 102
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF
    threads: 32


        run_gubbins.py -v -f 25 -p /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/pAVC171-IncF /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/core/pAVC171-IncF.clean.full.aln
        rm pAVC171-IncF.clean.full.aln.seq.joint.txt
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/0d285378


Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 260 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.07%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 distinct randomized MP trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 260
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s pAVC171-IncF.clean.full.aln.phylip -n pAVC171-IncF.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.266 0.240 0.248 0.247 

Inference[0]: Time 1.225580 CAT-based likelihood -4355.895655, best rearrangement setting 10


Conducting final model optimizations on all 1 trees under GAMMA-based models ....

Inference[0] final GAMMA-based Likelihood: -4354.170426 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.pAVC171-IncF.clean.full.iteration_1


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -4354.170426 .... 

Final GAMMA-based Score of best tree -4354.170096

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.pAVC171-IncF.clean.full.iteration_1
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.pAVC171-IncF.clean.full.iteration_1

Overall execution time: 2.749763 secs or 0.000764 hours or 0.000032 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 260 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.07%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 260
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp59uou6bk/rooted_tree.newick -n internal 


Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp59uou6bk/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp59uou6bk/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmp59uou6bk/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 0.546560



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 90 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 29.73%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 90
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.pAVC171-IncF.clean.full.iteration_1.phylip -n pAVC171-IncF.clean.full.iteration_2 -t RAxML_result.pAVC171-IncF.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.185 0.253 0.251 0.312 

Inference[0]: Time 0.612929 CAT-based likelihood -575.923581, best rearrangement setting 10


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 11.334121 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 25.881146 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 59.446365 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 136.877038 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 306.486821 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 698.044592 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -575.994400 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.pAVC171-IncF.clean.full.iteration_2


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -575.994400 .... 

Final GAMMA-based Score of best tree -575.970197

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.pAVC171-IncF.clean.full.iteration_2
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.pAVC171-IncF.clean.full.iteration_2

Overall execution time: 1.165530 secs or 0.000324 hours or 0.000013 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 260 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.07%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 260
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmppehxvgis/rooted_tree.newick -n internal 


Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmppehxvgis/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmppehxvgis/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmppehxvgis/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 0.257242



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 68 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 27.83%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 68
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.pAVC171-IncF.clean.full.iteration_2.phylip -n pAVC171-IncF.clean.full.iteration_3 -t RAxML_result.pAVC171-IncF.clean.full.iteration_2 


Partition: 0 with name: No Name Provided
Base frequencies: 0.222 0.245 0.263 0.270 

Inference[0]: Time 0.455723 CAT-based likelihood -427.003408, best rearrangement setting 15


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.149674 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.869260 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 64.143638 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 147.879765 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 331.996563 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -427.103192 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.pAVC171-IncF.clean.full.iteration_3


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -427.103192 .... 

Final GAMMA-based Score of best tree -427.076663

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.pAVC171-IncF.clean.full.iteration_3
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.pAVC171-IncF.clean.full.iteration_3

Overall execution time: 0.825599 secs or 0.000229 hours or 0.000010 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 260 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.07%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 260
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpdtvtq5ki/rooted_tree.newick -n internal 


Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpdtvtq5ki/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpdtvtq5ki/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpdtvtq5ki/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 0.229060



IMPORTANT WARNING: Sequences ESC_HA6342AA_AS.out and ESC_HA6413AA_AS.out are exactly identical

IMPORTANT WARNING
Found 1 sequence that is exactly identical to other sequences in the alignment.
Normally they should be excluded from the analysis.

Just in case you might need it, an alignment file with 
sequence duplicates removed is printed to file RAxML_result.pAVC171-IncF.clean.full.iteration_3.phylip.reduced


Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 67 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 29.49%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 67
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.pAVC171-IncF.clean.full.iteration_3.phylip -n pAVC171-IncF.clean.full.iteration_4 -t RAxML_result.pAVC171-IncF.clean.full.iteration_3 


Partition: 0 with name: No Name Provided
Base frequencies: 0.211 0.231 0.266 0.293 

Inference[0]: Time 0.341682 CAT-based likelihood -417.172154, best rearrangement setting 10


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 11.942078 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.358864 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 62.931845 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 145.059642 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 325.452721 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -417.247070 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.pAVC171-IncF.clean.full.iteration_4


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -417.247070 .... 

Final GAMMA-based Score of best tree -417.247015

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.pAVC171-IncF.clean.full.iteration_4
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.pAVC171-IncF.clean.full.iteration_4

Overall execution time: 0.712489 secs or 0.000198 hours or 0.000008 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 260 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.07%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 260
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpytmosz3s/rooted_tree.newick -n internal 


Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpytmosz3s/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpytmosz3s/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpytmosz3s/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 0.242040



IMPORTANT WARNING: Sequences ESC_NA4063AA_AS.out and ESC_NA4068AA_AS.out are exactly identical

IMPORTANT WARNING
Found 1 sequence that is exactly identical to other sequences in the alignment.
Normally they should be excluded from the analysis.

Just in case you might need it, an alignment file with 
sequence duplicates removed is printed to file RAxML_result.pAVC171-IncF.clean.full.iteration_4.phylip.reduced


Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 80 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 39.09%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 80
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.pAVC171-IncF.clean.full.iteration_4.phylip -n pAVC171-IncF.clean.full.iteration_5 -t RAxML_result.pAVC171-IncF.clean.full.iteration_4 


Partition: 0 with name: No Name Provided
Base frequencies: 0.225 0.246 0.263 0.266 

Inference[0]: Time 0.517671 CAT-based likelihood -468.624534, best rearrangement setting 10


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 11.136499 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 25.405242 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 58.326264 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 134.320658 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 300.563483 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 684.350508 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -468.664125 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.pAVC171-IncF.clean.full.iteration_5


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -468.664125 .... 

Final GAMMA-based Score of best tree -468.663653

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.pAVC171-IncF.clean.full.iteration_5
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.pAVC171-IncF.clean.full.iteration_5

Overall execution time: 0.945486 secs or 0.000263 hours or 0.000011 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 260 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 8.07%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 260
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp33_rch8j/rooted_tree.newick -n internal 


Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp33_rch8j/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp33_rch8j/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmp33_rch8j/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 0.263606

Sample ESC_BA8511AA_AS.out has missing data percentage of 9.775307245617181
Sample ESC_GA5350AA_AS.out has missing data percentage of 4.480751458640809
Sample ESC_GB6943AA_AS.out has missing data percentage of 17.0960978772121
Sample ESC_HA6332AA_AS.out has missing data percentage of 33.152871074083784
Sample ESC_HA6342AA_AS.out has missing data percentage of 4.160057380101795
Sample ESC_HA6411AA_AS.out has missing data percentage of 16.820232003200044
Sample ESC_HA6413AA_AS.out has missing data percentage of 4.0993668878191425
Sample ESC_HA6418AA_AS.out has missing data percentage of 4.744203368322322
Sample ESC_HA6420AA_AS.out has missing data percentage of 17.65127794866136
Sample ESC_HB8007AA_AS.out has missing data percentage of 8.394598546186844
Sample ESC_IA0811AA_AS.out has missing data percentage of 3.784190126760369
Sample ESC_NA3971AA_AS.out has missing data percentage of 22.899626201740713
Sample ESC_NA3973AA_AS.out has missing data percentage of 18.4850825528628
Sample ESC_NA3974AA_AS.out has missing data percentage of 17.624381025945187
Sample ESC_NA3975AA_AS.out has missing data percentage of 17.44989586063256
Sample ESC_NA3980AA_AS.out has missing data percentage of 17.54713858122181
Sample ESC_NA3982AA_AS.out has missing data percentage of 16.878163836742576
Sample ESC_NA3992AA_AS.out has missing data percentage of 17.689899171023047
Sample ESC_NA3999AA_AS.out has missing data percentage of 19.086470158209078
Sample ESC_NA4000AA_AS.out has missing data percentage of 18.230596284086676
Sample ESC_NA4003AA_AS.out has missing data percentage of 18.104387646726163
Sample ESC_NA4004AA_AS.out has missing data percentage of 17.166443675085173
Sample ESC_NA4005AA_AS.out has missing data percentage of 19.254058676671402
Sample ESC_NA4035AA_AS.out has missing data percentage of 16.816094015089863
Sample ESC_NA4045AA_AS.out has missing data percentage of 18.326459675305866
Sample ESC_NA4046AA_AS.out has missing data percentage of 94.64889170885115
Sample ESC_NA4048AA_AS.out has missing data percentage of 13.251217258169078
Sample ESC_NA4052AA_AS.out has missing data percentage of 20.258210458075283
Sample ESC_NA4053AA_AS.out has missing data percentage of 21.905129725927253
Sample ESC_NA4055AA_AS.out has missing data percentage of 16.96368225768631
Sample ESC_NA4056AA_AS.out has missing data percentage of 16.85333590808149
Sample ESC_NA4061AA_AS.out has missing data percentage of 18.167836797748933
Sample ESC_NA4063AA_AS.out has missing data percentage of 16.869198195837185
Sample ESC_NA4064AA_AS.out has missing data percentage of 60.359453233837705
Sample ESC_NA4066AA_AS.out has missing data percentage of 15.633319080263176
Sample ESC_NA4067AA_AS.out has missing data percentage of 17.069890619180953
Sample ESC_NA4068AA_AS.out has missing data percentage of 16.918854053159354
Sample ESC_NA4069AA_AS.out has missing data percentage of 17.717485758424253
Sample ESC_NA4070AA_AS.out has missing data percentage of 17.4850687595691
Sample ESC_NA4071AA_AS.out has missing data percentage of 17.577483827363135
Sample ESC_NA4072AA_AS.out has missing data percentage of 17.789210885667387
Sample ESC_SA8250AA_AS.out has missing data percentage of 2.2503758672533416
Sample ESC_SA8273AA_AS.out has missing data percentage of 3.0979737651553814
Sample ESC_SA8291AA_AS.out has missing data percentage of 17.50713802949006
Sample ESC_SA8296AA_AS.out has missing data percentage of 17.39403302114512
Sample ESC_SA8312AA_AS.out has missing data percentage of 32.939075021724435
Sample ESC_VA0598AA_AS.out has missing data percentage of 16.54367646450296
Sample Reference has missing data percentage of 0.0
Excluded sequence ESC_NA4046AA_AS.out because it had 94.64889170885115 percentage missing data while a maximum of 25 is allowed
Excluded sequence ESC_HA6332AA_AS.out because it had 33.152871074083784 percentage missing data while a maximum of 25 is allowed
Excluded sequence ESC_NA4064AA_AS.out because it had 60.359453233837705 percentage missing data while a maximum of 25 is allowed
Excluded sequence ESC_SA8312AA_AS.out because it had 32.939075021724435 percentage missing data while a maximum of 25 is allowed
gubbins /data/malcummi/pipelord/snplord/tmpmgxicpjq/pAVC171-IncF.clean.full.aln
1599698039
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s pAVC171-IncF.clean.full.aln.phylip -n pAVC171-IncF.clean.full.iteration_1 
1599698045
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp59uou6bk/rooted_tree.newick -n internal 
1599698045
1599698046
gubbins -r -v pAVC171-IncF.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpmgxicpjq/pAVC171-IncF.clean.full.aln -t RAxML_result.pAVC171-IncF.clean.full.iteration_1 -m 3 pAVC171-IncF.clean.full.aln.gaps.snp_sites.aln
1599698046
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.pAVC171-IncF.clean.full.iteration_1.phylip -n pAVC171-IncF.clean.full.iteration_2 -t RAxML_result.pAVC171-IncF.clean.full.iteration_1
1599698048
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmppehxvgis/rooted_tree.newick -n internal 
1599698048
1599698049
gubbins -r -v pAVC171-IncF.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpmgxicpjq/pAVC171-IncF.clean.full.aln -t RAxML_result.pAVC171-IncF.clean.full.iteration_2 -m 3 pAVC171-IncF.clean.full.aln.gaps.snp_sites.aln
1599698049
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.pAVC171-IncF.clean.full.iteration_2.phylip -n pAVC171-IncF.clean.full.iteration_3 -t RAxML_result.pAVC171-IncF.clean.full.iteration_2
1599698050
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpdtvtq5ki/rooted_tree.newick -n internal 
1599698050
1599698051
gubbins -r -v pAVC171-IncF.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpmgxicpjq/pAVC171-IncF.clean.full.aln -t RAxML_result.pAVC171-IncF.clean.full.iteration_3 -m 3 pAVC171-IncF.clean.full.aln.gaps.snp_sites.aln
1599698051
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.pAVC171-IncF.clean.full.iteration_3.phylip -n pAVC171-IncF.clean.full.iteration_4 -t RAxML_result.pAVC171-IncF.clean.full.iteration_3
1599698052
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpytmosz3s/rooted_tree.newick -n internal 
1599698052
1599698053
gubbins -r -v pAVC171-IncF.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpmgxicpjq/pAVC171-IncF.clean.full.aln -t RAxML_result.pAVC171-IncF.clean.full.iteration_4 -m 3 pAVC171-IncF.clean.full.aln.gaps.snp_sites.aln
1599698053
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.pAVC171-IncF.clean.full.iteration_4.phylip -n pAVC171-IncF.clean.full.iteration_5 -t RAxML_result.pAVC171-IncF.clean.full.iteration_4
1599698054
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/pAVC171-IncF.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp33_rch8j/rooted_tree.newick -n internal 
1599698055
1599698055
gubbins -r -v pAVC171-IncF.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpmgxicpjq/pAVC171-IncF.clean.full.aln -t RAxML_result.pAVC171-IncF.clean.full.iteration_5 -m 3 pAVC171-IncF.clean.full.aln.gaps.snp_sites.aln
1599698056
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.snp_sites.aln regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3 regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3$
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2.phylip regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.vcf regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./RAxML_bestTree.pAVC171-IncF.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2.branch_snps.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2\.
Deleting file: ./RAxML_log.pAVC171-IncF.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1.snp_sites.aln regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.gff regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./RAxML_info.pAVC171-IncF.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_log.pAVC171-IncF.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1 regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1$
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.phylip.reduced regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.phylip regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1.gff regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4 regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4$
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1.vcf regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.vcf regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.phylip regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./RAxML_info.pAVC171-IncF.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.stats regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.branch_snps.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2.stats regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2\.
Deleting file: ./RAxML_bestTree.pAVC171-IncF.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.stats regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1.branch_snps.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1\.
Deleting file: ./RAxML_log.pAVC171-IncF.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1.stats regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.snp_sites.aln regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./RAxML_bestTree.pAVC171-IncF.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_parsimonyTree.pAVC171-IncF.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_bestTree.pAVC171-IncF.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_info.pAVC171-IncF.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_log.pAVC171-IncF.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2.snp_sites.aln regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2\.
Deleting file: ./RAxML_log.pAVC171-IncF.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2.gff regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2 regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2$
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_1.phylip regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_1\.
Deleting file: ./RAxML_bestTree.pAVC171-IncF.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.branch_snps.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_3.gff regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_3\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2.tab regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2\.
Deleting file: ./RAxML_info.pAVC171-IncF.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_info.pAVC171-IncF.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).pAVC171-IncF.clean.full.iteration_
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_2.vcf regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_2\.
Deleting file: ./RAxML_result.pAVC171-IncF.clean.full.iteration_4.phylip.reduced regex:^RAxML_result.pAVC171-IncF.clean.full.iteration_4\.
Deleting file: ./pAVC171-IncF.clean.full.aln.gaps.phylip regex:^pAVC171-IncF.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./pAVC171-IncF.clean.full.aln.start regex:^pAVC171-IncF.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./pAVC171-IncF.clean.full.aln.gaps.vcf regex:^pAVC171-IncF.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./pAVC171-IncF.clean.full.aln.vcf regex:^pAVC171-IncF.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./pAVC171-IncF.clean.full.aln.gaps.snp_sites.aln regex:^pAVC171-IncF.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./pAVC171-IncF.clean.full.aln.phylip regex:^pAVC171-IncF.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./pAVC171-IncF.clean.full.aln.snp_sites.aln regex:^pAVC171-IncF.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
[Thu Sep 10 10:34:19 2020]
Finished job 102.
100 of 107 steps (93%) done

[Thu Sep 10 10:34:19 2020]
rule snp_sites:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/AVC171_chromosome.filtered_polymorphic_sites.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/AVC171_chromosome.clean.fullcore.aln
    jobid: 99
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome
    threads: 32

snp-sites -c /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/AVC171_chromosome.filtered_polymorphic_sites.fasta > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/AVC171_chromosome.clean.fullcore.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Thu Sep 10 10:34:20 2020]
Finished job 99.
101 of 107 steps (94%) done

[Thu Sep 10 10:34:20 2020]
rule fasttree:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/AVC171_chromosome.clean.fullcore.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/fasttree/AVC171_chromosome.clean.fullcore.tree
    jobid: 95
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome
    threads: 32

fasttree -gtr -nt /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/AVC171_chromosome.clean.fullcore.aln > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/fasttree/AVC171_chromosome.clean.fullcore.tree
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/89835887
FastTree Version 2.1.10 Double precision (No SSE3)
Alignment: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/AVC171_chromosome.clean.fullcore.aln
Nucleotide distances: Jukes-Cantor Joins: balanced Support: SH-like 1000
Search: Normal +NNI +SPR (2 rounds range 10) +ML-NNI opt-each=1
TopHits: 1.00*sqrtN close=default refresh=0.80
ML Model: Generalized Time-Reversible, CAT approximation with 20 rate categories
Initial topology in 0.01 seconds
Refining topology: 22 rounds ME-NNIs, 2 rounds ME-SPRs, 11 rounds ML-NNIs
      0.16 seconds: ME NNI round 15 of 22, 1 of 46 splits
Total branch-length 1.088 after 0.17 sec
ML-NNI round 1: LogLk = -5738.885 NNIs 3 max delta 0.00 Time 0.25
      0.26 seconds: Optimizing GTR model, step 2 of 12
      0.37 seconds: Optimizing GTR model, step 8 of 12
GTR Frequencies: 0.1713 0.3193 0.3410 0.1684
GTR rates(ac ag at cg ct gt) 1.1029 2.6824 1.4672 0.1682 3.0085 1.0000
      0.47 seconds: Site likelihoods with rate category 6 of 20
Switched to using 20 rate categories (CAT approximation)
Rate categories were divided by 0.788 so that average rate = 1.0
CAT-based log-likelihoods may not be comparable across runs
Use -gamma for approximate but comparable Gamma(20) log-likelihoods
ML-NNI round 2: LogLk = -5499.668 NNIs 6 max delta 0.27 Time 0.57
ML-NNI round 3: LogLk = -5499.611 NNIs 2 max delta 0.00 Time 0.63
Turning off heuristics for final round of ML NNIs (converged)
      0.62 seconds: ML NNI round 4 of 11, 1 of 46 splits
ML-NNI round 4: LogLk = -5499.471 NNIs 1 max delta 0.00 Time 0.73 (final)
      0.72 seconds: ML Lengths 1 of 46 splits
Optimize all lengths: LogLk = -5499.471 Time 0.76
Total time: 0.90 seconds Unique: 48/48 Bad splits: 0/45
[Thu Sep 10 10:34:21 2020]
Finished job 95.
102 of 107 steps (95%) done

[Thu Sep 10 10:34:21 2020]
rule snp_dists:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/AVC171_chromosome.clean.fullcore.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_dists/AVC171_chromosome.pairwise_snps.csv
    jobid: 97
    wildcards: output_prefix=AVC171_HC50, reference=AVC171_chromosome
    threads: 32

snp-dists -c /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/AVC171_chromosome.clean.fullcore.aln > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_dists/AVC171_chromosome.pairwise_snps.csv
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/4ead7ed0
This is snp-dists 0.6.3
Read 48 sequences of length 771
[Thu Sep 10 10:34:22 2020]
Finished job 97.
103 of 107 steps (96%) done

[Thu Sep 10 10:34:22 2020]
rule snp_sites:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/pAVC171-IncF.filtered_polymorphic_sites.fasta
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/pAVC171-IncF.clean.fullcore.aln
    jobid: 100
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF
    threads: 32

snp-sites -c /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/gubbins/pAVC171-IncF.filtered_polymorphic_sites.fasta > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/pAVC171-IncF.clean.fullcore.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Thu Sep 10 10:34:23 2020]
Finished job 100.
104 of 107 steps (97%) done

[Thu Sep 10 10:34:23 2020]
rule snp_dists:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/pAVC171-IncF.clean.fullcore.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_dists/pAVC171-IncF.pairwise_snps.csv
    jobid: 98
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF
    threads: 32

snp-dists -c /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/pAVC171-IncF.clean.fullcore.aln > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_dists/pAVC171-IncF.pairwise_snps.csv
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/4ead7ed0
This is snp-dists 0.6.3
Read 44 sequences of length 20
[Thu Sep 10 10:34:24 2020]
Finished job 98.
105 of 107 steps (98%) done

[Thu Sep 10 10:34:24 2020]
rule fasttree:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/pAVC171-IncF.clean.fullcore.aln
    output: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/fasttree/pAVC171-IncF.clean.fullcore.tree
    jobid: 96
    wildcards: output_prefix=AVC171_HC50, reference=pAVC171-IncF
    threads: 32

fasttree -gtr -nt /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/pAVC171-IncF.clean.fullcore.aln > /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/fasttree/pAVC171-IncF.clean.fullcore.tree
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/89835887
FastTree Version 2.1.10 Double precision (No SSE3)
Alignment: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_sites/pAVC171-IncF.clean.fullcore.aln
Nucleotide distances: Jukes-Cantor Joins: balanced Support: SH-like 1000
Search: Normal +NNI +SPR (2 rounds range 10) +ML-NNI opt-each=1
TopHits: 1.00*sqrtN close=default refresh=0.80
ML Model: Generalized Time-Reversible, CAT approximation with 20 rate categories
Initial topology in 0.00 seconds
Refining topology: 13 rounds ME-NNIs, 2 rounds ME-SPRs, 6 rounds ML-NNIs
Total branch-length 2.202 after 0.00 sec
ML-NNI round 1: LogLk = -104.388 NNIs 2 max delta 0.00 Time 0.00
GTR Frequencies: 0.2717 0.1902 0.3641 0.1739
GTR rates(ac ag at cg ct gt) 2.0225 7.9679 0.6923 0.6433 14.7440 1.0000
Switched to using 20 rate categories (CAT approximation)
Rate categories were divided by 0.716 so that average rate = 1.0
CAT-based log-likelihoods may not be comparable across runs
Use -gamma for approximate but comparable Gamma(20) log-likelihoods
ML-NNI round 2: LogLk = -92.632 NNIs 2 max delta 0.00 Time 0.01
Turning off heuristics for final round of ML NNIs (converged)
ML-NNI round 3: LogLk = -92.632 NNIs 0 max delta 0.00 Time 0.01 (final)
Optimize all lengths: LogLk = -92.632 Time 0.01
Total time: 0.01 seconds Unique: 9/44 Bad splits: 0/6
[Thu Sep 10 10:34:24 2020]
Finished job 96.
106 of 107 steps (99%) done

[Thu Sep 10 10:34:24 2020]
localrule all:
    input: /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4004AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4004AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4000AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4000AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6418AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6418AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8250AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8250AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6413AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6413AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_BA8511AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_BA8511AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_VA0598AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_VA0598AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3992AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3992AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8312AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8312AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8291AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8291AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4048AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4048AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4055AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4055AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4063AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4063AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3974AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3974AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_IA0811AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_IA0811AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4070AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4070AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4046AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4046AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4064AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4064AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3971AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3971AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3982AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3982AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4035AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4035AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4071AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4071AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6420AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6420AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4069AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4069AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6411AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6411AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6342AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6342AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GA5350AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GA5350AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HB8007AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HB8007AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4052AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4052AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4066AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4066AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4003AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4003AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8296AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8296AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3975AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3975AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3973AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3973AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3999AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3999AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4045AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4045AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4067AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4067AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4068AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4068AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4053AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4053AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4005AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4005AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_GB6943AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_GB6943AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_SA8273AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_SA8273AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_HA6332AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_HA6332AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4056AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4056AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4061AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4061AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA4072AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA4072AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/AVC171_chromosome/ESC_NA3980AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snippyout/pAVC171-IncF/ESC_NA3980AA_AS.out, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/fasttree/AVC171_chromosome.clean.fullcore.tree, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/fasttree/pAVC171-IncF.clean.fullcore.tree, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_dists/AVC171_chromosome.pairwise_snps.csv, /projects/AusGEM/Users/Max/Manuscripts/AVC171/AVC171/analysis/snippy/AVC171_HC50/snp_dists/pAVC171-IncF.pairwise_snps.csv
    jobid: 0

[Thu Sep 10 10:34:24 2020]
Finished job 0.
107 of 107 steps (100%) done
Complete log: /data/malcummi/pipelord/snplord/.snakemake/log/2020-09-10T102402.899966.snakemake.log
['ESC_NA4004AA_AS', 'ESC_NA4000AA_AS', 'ESC_HA6418AA_AS', 'ESC_SA8250AA_AS', 'ESC_HA6413AA_AS', 'ESC_BA8511AA_AS', 'ESC_VA0598AA_AS', 'ESC_NA3992AA_AS', 'ESC_SA8312AA_AS', 'ESC_SA8291AA_AS', 'ESC_NA4048AA_AS', 'ESC_NA4055AA_AS', 'ESC_NA4063AA_AS', 'ESC_NA3974AA_AS', 'ESC_IA0811AA_AS', 'ESC_NA4070AA_AS', 'ESC_NA4046AA_AS', 'ESC_NA4064AA_AS', 'ESC_NA3971AA_AS', 'ESC_NA3982AA_AS', 'ESC_NA4035AA_AS', 'ESC_NA4071AA_AS', 'ESC_HA6420AA_AS', 'ESC_NA4069AA_AS', 'ESC_HA6411AA_AS', 'ESC_HA6342AA_AS', 'ESC_GA5350AA_AS', 'ESC_HB8007AA_AS', 'ESC_NA4052AA_AS', 'ESC_NA4066AA_AS', 'ESC_NA4003AA_AS', 'ESC_SA8296AA_AS', 'ESC_NA3975AA_AS', 'ESC_NA3973AA_AS', 'ESC_NA3999AA_AS', 'ESC_NA4045AA_AS', 'ESC_NA4067AA_AS', 'ESC_NA4068AA_AS', 'ESC_NA4053AA_AS', 'ESC_NA4005AA_AS', 'ESC_GB6943AA_AS', 'ESC_SA8273AA_AS', 'ESC_HA6332AA_AS', 'ESC_NA4056AA_AS', 'ESC_NA4061AA_AS', 'ESC_NA4072AA_AS', 'ESC_NA3980AA_AS']
['AVC171_chromosome', 'pAVC171-IncF']
